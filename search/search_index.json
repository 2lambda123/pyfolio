{
    "docs": [
        {
            "location": "/",
            "text": "pyfolio\n\n\n\n\n\n\npyfolio is a Python library for performance and risk analysis of\nfinancial portfolios developed by\n\nQuantopian Inc\n. It works well with the\n\nZipline\n open source backtesting library.\n\n\nAt the core of pyfolio is a so-called tear sheet that consists of\nvarious individual plots that provide a comprehensive image of the\nperformance of a trading algorithm. Here's an example of a simple tear\nsheet analyzing a strategy:\n\n\n\n\n\n\nAlso see \nslides of a talk about\npyfolio\n.\n\n\nInstallation\n\n\nTo install pyfolio, run:\n\n\npip install pyfolio\n\n\n\n\nDevelopment\n\n\nFor development, you may want to use a \nvirtual environment\n to avoid dependency conflicts between pyfolio and other Python projects you have. To get set up with a virtual env, run:\n\n\nmkvirtualenv pyfolio\n\n\n\n\nNext, clone this git repository and run \npython setup.py develop\n\nand edit the library files directly.\n\n\nBayesian tear sheet\n\n\nGenerating a \nBayesian tearsheet\n requires PyMC3 and Theano. You can install these packages with the following commands:\n\n\npip install theano\n\n\n\n\npip install pymc3\n\n\n\n\nMatplotlib on OSX\n\n\nIf you are on OSX and using a non-framework build of Python, you may need to set your backend:\n\n\necho \"backend: TkAgg\" > ~/.matplotlib/matplotlibrc\n\n\n\n\nUsage\n\n\nA good way to get started is to run the pyfolio examples in\na \nJupyter notebook\n. To do this, you first want to\nstart a Jupyter notebook server:\n\n\njupyter notebook\n\n\n\n\nFrom the notebook list page, navigate to the pyfolio examples directory\nand open a notebook. Execute the code in a notebook cell by clicking on it\nand hitting Shift+Enter.\n\n\nQuestions?\n\n\nIf you find a bug, feel free to \nopen an issue\n in this repository.\n\n\nYou can also join our \nmailing list\n or\nour \nGitter channel\n.\n\n\nContributing\n\n\nIf you'd like to contribute, a great place to look is the \nissues marked with help-wanted\n.\n\n\nFor a list of core developers and outside collaborators, see \nthe GitHub contributors list\n.",
            "title": "Overview"
        },
        {
            "location": "/#pyfolio",
            "text": "pyfolio is a Python library for performance and risk analysis of\nfinancial portfolios developed by Quantopian Inc . It works well with the Zipline  open source backtesting library.  At the core of pyfolio is a so-called tear sheet that consists of\nvarious individual plots that provide a comprehensive image of the\nperformance of a trading algorithm. Here's an example of a simple tear\nsheet analyzing a strategy:    Also see  slides of a talk about\npyfolio .",
            "title": "pyfolio"
        },
        {
            "location": "/#installation",
            "text": "To install pyfolio, run:  pip install pyfolio",
            "title": "Installation"
        },
        {
            "location": "/#development",
            "text": "For development, you may want to use a  virtual environment  to avoid dependency conflicts between pyfolio and other Python projects you have. To get set up with a virtual env, run:  mkvirtualenv pyfolio  Next, clone this git repository and run  python setup.py develop \nand edit the library files directly.",
            "title": "Development"
        },
        {
            "location": "/#bayesian-tear-sheet",
            "text": "Generating a  Bayesian tearsheet  requires PyMC3 and Theano. You can install these packages with the following commands:  pip install theano  pip install pymc3",
            "title": "Bayesian tear sheet"
        },
        {
            "location": "/#matplotlib-on-osx",
            "text": "If you are on OSX and using a non-framework build of Python, you may need to set your backend:  echo \"backend: TkAgg\" > ~/.matplotlib/matplotlibrc",
            "title": "Matplotlib on OSX"
        },
        {
            "location": "/#usage",
            "text": "A good way to get started is to run the pyfolio examples in\na  Jupyter notebook . To do this, you first want to\nstart a Jupyter notebook server:  jupyter notebook  From the notebook list page, navigate to the pyfolio examples directory\nand open a notebook. Execute the code in a notebook cell by clicking on it\nand hitting Shift+Enter.",
            "title": "Usage"
        },
        {
            "location": "/#questions",
            "text": "If you find a bug, feel free to  open an issue  in this repository.  You can also join our  mailing list  or\nour  Gitter channel .",
            "title": "Questions?"
        },
        {
            "location": "/#contributing",
            "text": "If you'd like to contribute, a great place to look is the  issues marked with help-wanted .  For a list of core developers and outside collaborators, see  the GitHub contributors list .",
            "title": "Contributing"
        },
        {
            "location": "/whatsnew/",
            "text": "What's New\n\n\nThese are new features and improvements of note in each release.\n\n\nv0.8.0 (Aug 23rd, 2017)\n\n\nThis is a major release from \n0.7.0\n, and all users are recommended to upgrade.\n\n\nNew features\n\n\n\n\nRisk tear sheet: added a new tear sheet to analyze risk exposures to common factors (e.g. mean reversion and momentum), sector (e.g. Morningstar sectors), market cap and illiquid stocks. By \nGeorge Ho\n.\n\n\nSimple tear sheet: added a new tear sheet that presents only the most important plots in the full tear sheet, for a quick general overview of a portfolio's performance. By \nGeorge Ho\n.\n\n\nPerformance attribution: added new table to do performance attribution\n   analysis, such as the amount of returns attributable to common factors, and\n   summary statistics such as the multi-factor alpha and multi-factor Sharpe ratio. By \nVikram Narayan\n.\n\n\nVolatility plot: added a rolling annual volatility plot to the returns tear sheet. By \nhkopp\n.\n\n\n\n\nBugfixes\n\n\n\n\nYahoo and pandas data-reader: fixed bug regarding Yahoo backend for market data and pandas data-reader. By \nThomas Wiecki\n and \nGus Gordon\n.\n\n\nempyrical\n compatibility: removed \ninformation_ratio\n to remain compatible with \nempyrical\n. By \nThomas Wiecki\n.\n\n\nFama-French rolling multivariate regression: fixed bug where the rolling Fama-French plot performed separate linear regressions instead of a multivariate regression. By \nGeorge Ho\n.\n\n\nOther minor bugfixes. By \nScott Sanderson\n,\n   \nJonathan Ng\n,\n   \nSylvainDe\n and\n   \nmckelvin\n.\n\n\n\n\nMaintenance\n\n\n\n\nDocumentation: updated and improved \npyfolio\n documentation and example\n   Jupyter notebooks. By \nGeorge Ho\n.\n\n\nData loader migration: all data loaders have been migrated from \npyfolio\n to\n   \nempyrical\n. By \nJames Christopher\n.\n\n\nImproved plotting style: fixed issues with formatting and presentation of\n   plots. By \nGeorge Ho\n.\n\n\n\n\nv0.7.0 (Jan 28th, 2017)\n\n\nThis is a major release from \n0.6.0\n, and all users are recommended to upgrade.\n\n\nNew features\n\n\n\n\nAdds a transaction timing plot, which gives insight into the strategies' trade times.\n\n\nAdds a plot showing the number of longs and shorts held over time.\n\n\nNew round trips plot selects a sample of held positions (16 by default) and shows their round trips. This replaces the old round trip plot, which became unreadable for strategies that traded many positions.\n\n\nAdds basic capability for analyzing intraday strategies. If a strategy makes a large amount of transactions relative to its end-of-day positions, then pyfolio will attempt to reconstruct the intraday positions, take the point of peak exposure to the market during each day, and plot that data with the positions tear sheet. By default pyfolio will automatically detect this, but the behavior can be changed by passing either \nestimate_intraday=True\n or \nestimate_intraday=False\n to the tear sheet functions (\nsee here\n).\n\n\nNow formats \nzipline\n assets, displaying their ticker symbol.\n\n\nGross leverage is no longer required to be passed, and will now be calculated from the passed positions DataFrame.\n\n\n\n\nBugfixes\n\n\n\n\nCone plotting location is now correct.\n\n\nAdjust scaling of beta and Fama-French plots.\n\n\nRemoved multiple dependencies, some of which were previously unused.\n\n\nVarious text fixes.\n\n\n\n\nv0.6.0 (Oct 17, 2016)\n\n\nThis is a major new release from \n0.5.1\n. All users are recommended to upgrade.\n\n\nNew features\n\n\n\n\nComputation of performance and risk measures has been split off into \nempyrical\n. This allows \nZipline\n and \npyfolio\n to use the same code to calculate its risk statistics. By \nAna Ruelas\n and \nAbhi Kalyan\n.\n\n\nNew multistrike cone which redraws the cone when it crossed its initial bounds \nPR310\n. By \nAna Ruelas\n and \nAbhi Kalyan\n.\n\n\n\n\nBugfixes\n\n\n\n\nCan use most recent PyMC3 now.\n\n\nDepends on seaborn 0.7.0 or later now \nPR331\n.\n\n\nDisable buggy computation of round trips per day and per month \nPR339\n.\n\n\n\n\nv0.5.1 (June 10, 2016)\n\n\nThis is a bugfix release from \n0.5.0\n with limited new functionality. All users are recommended to upgrade.\n\n\nNew features\n\n\n\n\nOOS data is now overlaid on top of box plot \nPR306\n by \nAna Ruelas\n\n\nNew logo \nPR298\n by \nTaso Petridis\n and \nRichard Frank\n\n\nRaw returns plot and cumulative log returns plot \nPR294\n by \nThomas Wiecki\n\n\nNet exposure line to the long/short exposure plot \nPR301\n by \nAna Ruelas\n\n\n\n\nBugfixes\n\n\n\n\nFix drawdown behavior and pandas exception in tear-sheet creation \nPR297\n by \nFlavio Duarte\n\n\n\n\nv0.5.0 (April 21, 2016) -- Olympia\n\n\nThis is a major release from \n0.4.0\n that includes many new analyses and features. We recommend that all users upgrade to this new version. Also update your dependencies, specifically, \npandas>=0.18.0\n, \nseaborn>=0.6.0\n and \nzipline>=0.8.4\n.\n\n\nNew features\n\n\n\n\nNew capacity tear-sheet to assess how much capital can be traded on a strategy \nPR284\n. \nAndrew Campbell\n.\n\n\nBootstrap analysis to assess uncertainty in performance metrics \nPR261\n. \nThomas Wiecki\n\n\nRefactored round-trip analysis to be more general and have better output. Now does full portfolio reconstruction to match trades \nPR293\n. \nThomas Wiecki\n, \nAndrew Campbell\n. See the \ntutorial\n for more information.\n\n\nPrettier printing of tables in notebooks \nPR289\n. \nThomas Wiecki\n\n\nFaster max-drawdown calculation \nPR281\n. \nDevin Stevenson\n\n\nNew metrics tail-ratio and common sense ratio \nPR276\n. \nThomas Wiecki\n\n\nLog-scaled cumulative returns plot and raw returns plot \nPR294\n. \nThomas Wiecki\n\n\n\n\nBug fixes\n\n\n\n\nMany depracation fixes for Pandas 0.18.0, seaborn 0.6.0, and zipline 0.8.4\n\n\n\n\nv0.4.0 (Dec 10, 2015)\n\n\nThis is a major release from 0.3.1 that includes new features and quite a few bug fixes. We recommend that all users upgrade to this new version.\n\n\nNew features\n\n\n\n\nRound-trip analysis \nPR210\n Andrew, Thomas\n\n\nImproved cone to forecast returns that uses a bootstrap instead of linear forecasting \nPR233\n Andrew, Thomas\n\n\nPlot max and median long/short exposures \nPR237\n Andrew\n\n\n\n\nBug fixes\n\n\n\n\nSharpe ratio was calculated incorrectly \nPR219\n Thomas, Justin\n\n\nannual_return() now only computes CAGR in the correct way \nPR234\n Justin\n\n\nCache SPY and Fama-French returns in home-directory instead of install-directory \nPR241\n Joe\n\n\nRemove data files from package \nPR241\n Joe\n\n\nCast factor.name to str \nPR223\n Scotty\n\n\nTest all \ncreate_*_tear_sheet\n functions in all configurations \nPR247\n Thomas\n\n\n\n\nv0.3.1 (Nov 12, 2015)\n\n\nThis is a minor release from 0.3 that includes mostly bugfixes but also some new features. We recommend that all users upgrade to this new version.\n\n\nNew features\n\n\n\n\nAdd Information Ratio \nPR194\n by @MridulS\n\n\nBayesian tear-sheet now accepts 'Fama-French' option to do Bayesian multivariate regression against Fama-French risk factors \nPR200\n by Shane Bussman\n\n\nPlotting of monthly returns \nPR195\n\n\n\n\nBug fixes\n\n\n\n\npos.get_percent_alloc\n was not handling short allocations correctly \nPR201\n\n\nUTC bug with cached Fama-French factors \ncommit\n\n\nSector map was not being passed from \ncreate_returns_tearsheet\n \ncommit\n\n\nNew sector mapping feature was not Python 3 compatible \nPR201\n\n\n\n\nMaintenance\n\n\n\n\nWe now depend on pandas-datareader as the yahoo finance loaders from pandas will be deprecated \nPR181\n by @tswrightsandpointe\n\n\n\n\nContributors\n\n\nBesiders the core developers, we have seen an increase in outside contributions which we greatly appreciate. Specifically, these people contributed to this release:\n\n\n\n\nShane Bussman\n\n\n@MridulS\n\n\n@YihaoLu\n\n\n@jkrauss82\n\n\n@tswrightsandpointe\n\n\n@cgdeboer\n\n\n\n\nv0.3 (Oct 23, 2015)\n\n\nThis is a major release from 0.2 that includes many exciting new features. We recommend that all users upgrade to this new version.\n\n\nNew features\n\n\n\n\nSector exposures: sum positions by sector given a dictionary or series of symbol to sector mappings \nPR166\n\n\nAbility to make cones with multiple shades stdev regions \nPR168\n\n\nSlippage sweep: See how an algorithm performs with various levels of slippage \nPR170\n\n\nStochastic volatility model in Bayesian tear sheet \nPR174\n\n\nAbility to suppress display of position information \nPR177\n\n\n\n\nBug fixes\n\n\n\n\nVarious fixes to make pyfolio pandas 0.17 compatible\n\n\n\n\nv0.2 (Oct 16, 2015)\n\n\nThis is a major release from 0.1 that includes mainly bugfixes and refactorings but also some new features. We recommend that all users upgrade to this new version.\n\n\nNew features\n\n\n\n\nVolatility matched cumulative returns plot \nPR126\n.\n\n\nAllow for different periodicity (annualization factors) in the annual_() methods \nPR164\n.\n\n\nUsers can supply their own interesting periods \nPR163\n.\n\n\nAbility to weight a portfolio of holdings by a metric valued \nPR161\n.\n\n\n\n\nBug fixes\n\n\n\n\nFix drawdown overlaps \nPR150\n.\n\n\nMonthly returns distribution should not stack by year \nPR162\n.\n\n\nFix gross leverage \nPR147",
            "title": "Releases"
        },
        {
            "location": "/whatsnew/#whats-new",
            "text": "These are new features and improvements of note in each release.",
            "title": "What's New"
        },
        {
            "location": "/whatsnew/#v080-aug-23rd-2017",
            "text": "This is a major release from  0.7.0 , and all users are recommended to upgrade.",
            "title": "v0.8.0 (Aug 23rd, 2017)"
        },
        {
            "location": "/whatsnew/#new-features",
            "text": "Risk tear sheet: added a new tear sheet to analyze risk exposures to common factors (e.g. mean reversion and momentum), sector (e.g. Morningstar sectors), market cap and illiquid stocks. By  George Ho .  Simple tear sheet: added a new tear sheet that presents only the most important plots in the full tear sheet, for a quick general overview of a portfolio's performance. By  George Ho .  Performance attribution: added new table to do performance attribution\n   analysis, such as the amount of returns attributable to common factors, and\n   summary statistics such as the multi-factor alpha and multi-factor Sharpe ratio. By  Vikram Narayan .  Volatility plot: added a rolling annual volatility plot to the returns tear sheet. By  hkopp .",
            "title": "New features"
        },
        {
            "location": "/whatsnew/#bugfixes",
            "text": "Yahoo and pandas data-reader: fixed bug regarding Yahoo backend for market data and pandas data-reader. By  Thomas Wiecki  and  Gus Gordon .  empyrical  compatibility: removed  information_ratio  to remain compatible with  empyrical . By  Thomas Wiecki .  Fama-French rolling multivariate regression: fixed bug where the rolling Fama-French plot performed separate linear regressions instead of a multivariate regression. By  George Ho .  Other minor bugfixes. By  Scott Sanderson ,\n    Jonathan Ng ,\n    SylvainDe  and\n    mckelvin .",
            "title": "Bugfixes"
        },
        {
            "location": "/whatsnew/#maintenance",
            "text": "Documentation: updated and improved  pyfolio  documentation and example\n   Jupyter notebooks. By  George Ho .  Data loader migration: all data loaders have been migrated from  pyfolio  to\n    empyrical . By  James Christopher .  Improved plotting style: fixed issues with formatting and presentation of\n   plots. By  George Ho .",
            "title": "Maintenance"
        },
        {
            "location": "/whatsnew/#v070-jan-28th-2017",
            "text": "This is a major release from  0.6.0 , and all users are recommended to upgrade.",
            "title": "v0.7.0 (Jan 28th, 2017)"
        },
        {
            "location": "/whatsnew/#new-features_1",
            "text": "Adds a transaction timing plot, which gives insight into the strategies' trade times.  Adds a plot showing the number of longs and shorts held over time.  New round trips plot selects a sample of held positions (16 by default) and shows their round trips. This replaces the old round trip plot, which became unreadable for strategies that traded many positions.  Adds basic capability for analyzing intraday strategies. If a strategy makes a large amount of transactions relative to its end-of-day positions, then pyfolio will attempt to reconstruct the intraday positions, take the point of peak exposure to the market during each day, and plot that data with the positions tear sheet. By default pyfolio will automatically detect this, but the behavior can be changed by passing either  estimate_intraday=True  or  estimate_intraday=False  to the tear sheet functions ( see here ).  Now formats  zipline  assets, displaying their ticker symbol.  Gross leverage is no longer required to be passed, and will now be calculated from the passed positions DataFrame.",
            "title": "New features"
        },
        {
            "location": "/whatsnew/#bugfixes_1",
            "text": "Cone plotting location is now correct.  Adjust scaling of beta and Fama-French plots.  Removed multiple dependencies, some of which were previously unused.  Various text fixes.",
            "title": "Bugfixes"
        },
        {
            "location": "/whatsnew/#v060-oct-17-2016",
            "text": "This is a major new release from  0.5.1 . All users are recommended to upgrade.",
            "title": "v0.6.0 (Oct 17, 2016)"
        },
        {
            "location": "/whatsnew/#new-features_2",
            "text": "Computation of performance and risk measures has been split off into  empyrical . This allows  Zipline  and  pyfolio  to use the same code to calculate its risk statistics. By  Ana Ruelas  and  Abhi Kalyan .  New multistrike cone which redraws the cone when it crossed its initial bounds  PR310 . By  Ana Ruelas  and  Abhi Kalyan .",
            "title": "New features"
        },
        {
            "location": "/whatsnew/#bugfixes_2",
            "text": "Can use most recent PyMC3 now.  Depends on seaborn 0.7.0 or later now  PR331 .  Disable buggy computation of round trips per day and per month  PR339 .",
            "title": "Bugfixes"
        },
        {
            "location": "/whatsnew/#v051-june-10-2016",
            "text": "This is a bugfix release from  0.5.0  with limited new functionality. All users are recommended to upgrade.",
            "title": "v0.5.1 (June 10, 2016)"
        },
        {
            "location": "/whatsnew/#new-features_3",
            "text": "OOS data is now overlaid on top of box plot  PR306  by  Ana Ruelas  New logo  PR298  by  Taso Petridis  and  Richard Frank  Raw returns plot and cumulative log returns plot  PR294  by  Thomas Wiecki  Net exposure line to the long/short exposure plot  PR301  by  Ana Ruelas",
            "title": "New features"
        },
        {
            "location": "/whatsnew/#bugfixes_3",
            "text": "Fix drawdown behavior and pandas exception in tear-sheet creation  PR297  by  Flavio Duarte",
            "title": "Bugfixes"
        },
        {
            "location": "/whatsnew/#v050-april-21-2016-olympia",
            "text": "This is a major release from  0.4.0  that includes many new analyses and features. We recommend that all users upgrade to this new version. Also update your dependencies, specifically,  pandas>=0.18.0 ,  seaborn>=0.6.0  and  zipline>=0.8.4 .",
            "title": "v0.5.0 (April 21, 2016) -- Olympia"
        },
        {
            "location": "/whatsnew/#new-features_4",
            "text": "New capacity tear-sheet to assess how much capital can be traded on a strategy  PR284 .  Andrew Campbell .  Bootstrap analysis to assess uncertainty in performance metrics  PR261 .  Thomas Wiecki  Refactored round-trip analysis to be more general and have better output. Now does full portfolio reconstruction to match trades  PR293 .  Thomas Wiecki ,  Andrew Campbell . See the  tutorial  for more information.  Prettier printing of tables in notebooks  PR289 .  Thomas Wiecki  Faster max-drawdown calculation  PR281 .  Devin Stevenson  New metrics tail-ratio and common sense ratio  PR276 .  Thomas Wiecki  Log-scaled cumulative returns plot and raw returns plot  PR294 .  Thomas Wiecki",
            "title": "New features"
        },
        {
            "location": "/whatsnew/#bug-fixes",
            "text": "Many depracation fixes for Pandas 0.18.0, seaborn 0.6.0, and zipline 0.8.4",
            "title": "Bug fixes"
        },
        {
            "location": "/whatsnew/#v040-dec-10-2015",
            "text": "This is a major release from 0.3.1 that includes new features and quite a few bug fixes. We recommend that all users upgrade to this new version.",
            "title": "v0.4.0 (Dec 10, 2015)"
        },
        {
            "location": "/whatsnew/#new-features_5",
            "text": "Round-trip analysis  PR210  Andrew, Thomas  Improved cone to forecast returns that uses a bootstrap instead of linear forecasting  PR233  Andrew, Thomas  Plot max and median long/short exposures  PR237  Andrew",
            "title": "New features"
        },
        {
            "location": "/whatsnew/#bug-fixes_1",
            "text": "Sharpe ratio was calculated incorrectly  PR219  Thomas, Justin  annual_return() now only computes CAGR in the correct way  PR234  Justin  Cache SPY and Fama-French returns in home-directory instead of install-directory  PR241  Joe  Remove data files from package  PR241  Joe  Cast factor.name to str  PR223  Scotty  Test all  create_*_tear_sheet  functions in all configurations  PR247  Thomas",
            "title": "Bug fixes"
        },
        {
            "location": "/whatsnew/#v031-nov-12-2015",
            "text": "This is a minor release from 0.3 that includes mostly bugfixes but also some new features. We recommend that all users upgrade to this new version.",
            "title": "v0.3.1 (Nov 12, 2015)"
        },
        {
            "location": "/whatsnew/#new-features_6",
            "text": "Add Information Ratio  PR194  by @MridulS  Bayesian tear-sheet now accepts 'Fama-French' option to do Bayesian multivariate regression against Fama-French risk factors  PR200  by Shane Bussman  Plotting of monthly returns  PR195",
            "title": "New features"
        },
        {
            "location": "/whatsnew/#bug-fixes_2",
            "text": "pos.get_percent_alloc  was not handling short allocations correctly  PR201  UTC bug with cached Fama-French factors  commit  Sector map was not being passed from  create_returns_tearsheet   commit  New sector mapping feature was not Python 3 compatible  PR201",
            "title": "Bug fixes"
        },
        {
            "location": "/whatsnew/#maintenance_1",
            "text": "We now depend on pandas-datareader as the yahoo finance loaders from pandas will be deprecated  PR181  by @tswrightsandpointe",
            "title": "Maintenance"
        },
        {
            "location": "/whatsnew/#contributors",
            "text": "Besiders the core developers, we have seen an increase in outside contributions which we greatly appreciate. Specifically, these people contributed to this release:   Shane Bussman  @MridulS  @YihaoLu  @jkrauss82  @tswrightsandpointe  @cgdeboer",
            "title": "Contributors"
        },
        {
            "location": "/whatsnew/#v03-oct-23-2015",
            "text": "This is a major release from 0.2 that includes many exciting new features. We recommend that all users upgrade to this new version.",
            "title": "v0.3 (Oct 23, 2015)"
        },
        {
            "location": "/whatsnew/#new-features_7",
            "text": "Sector exposures: sum positions by sector given a dictionary or series of symbol to sector mappings  PR166  Ability to make cones with multiple shades stdev regions  PR168  Slippage sweep: See how an algorithm performs with various levels of slippage  PR170  Stochastic volatility model in Bayesian tear sheet  PR174  Ability to suppress display of position information  PR177",
            "title": "New features"
        },
        {
            "location": "/whatsnew/#bug-fixes_3",
            "text": "Various fixes to make pyfolio pandas 0.17 compatible",
            "title": "Bug fixes"
        },
        {
            "location": "/whatsnew/#v02-oct-16-2015",
            "text": "This is a major release from 0.1 that includes mainly bugfixes and refactorings but also some new features. We recommend that all users upgrade to this new version.",
            "title": "v0.2 (Oct 16, 2015)"
        },
        {
            "location": "/whatsnew/#new-features_8",
            "text": "Volatility matched cumulative returns plot  PR126 .  Allow for different periodicity (annualization factors) in the annual_() methods  PR164 .  Users can supply their own interesting periods  PR163 .  Ability to weight a portfolio of holdings by a metric valued  PR161 .",
            "title": "New features"
        },
        {
            "location": "/whatsnew/#bug-fixes_4",
            "text": "Fix drawdown overlaps  PR150 .  Monthly returns distribution should not stack by year  PR162 .  Fix gross leverage  PR147",
            "title": "Bug fixes"
        },
        {
            "location": "/notebooks/single_stock_example/",
            "text": "Single stock analysis example in pyfolio\n\n\nHere's a simple example where we produce a set of plots, called a tear sheet, for a single stock.\n\n\nImport pyfolio and matplotlib\n\n\nimport pyfolio as pf\n%matplotlib inline\n\n# silence warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\n\n\n\nFetch the daily returns for a stock\n\n\nstock_rets = pf.utils.get_symbol_rets('FB')\n\n\n\n\nCreate a returns tear sheet for the single stock\n\n\nThis will show charts and analysis about returns of the single stock.\n\n\npf.create_returns_tear_sheet(stock_rets, live_start_date='2015-12-1')\n\n\n\n\nEntire data start date: 2012-05-21\nEntire data end date: 2017-08-22\nIn-sample months: 42\nOut-of-sample months: 20\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \n\n      \nAll\n\n      \nIn-sample\n\n      \nOut-of-sample\n\n    \n\n  \n\n  \n\n    \n\n      \nAnnual return\n\n      \n32.8%\n\n      \n32.9%\n\n      \n32.6%\n\n    \n\n    \n\n      \nCumulative returns\n\n      \n343.7%\n\n      \n172.7%\n\n      \n62.7%\n\n    \n\n    \n\n      \nAnnual volatility\n\n      \n38.0%\n\n      \n43.2%\n\n      \n24.3%\n\n    \n\n    \n\n      \nSharpe ratio\n\n      \n0.93\n\n      \n0.87\n\n      \n1.28\n\n    \n\n    \n\n      \nCalmar ratio\n\n      \n0.61\n\n      \n0.61\n\n      \n2.38\n\n    \n\n    \n\n      \nStability\n\n      \n0.92\n\n      \n0.89\n\n      \n0.88\n\n    \n\n    \n\n      \nMax drawdown\n\n      \n-53.6%\n\n      \n-53.6%\n\n      \n-13.7%\n\n    \n\n    \n\n      \nOmega ratio\n\n      \n1.20\n\n      \n1.18\n\n      \n1.29\n\n    \n\n    \n\n      \nSortino ratio\n\n      \n1.50\n\n      \n1.39\n\n      \n2.09\n\n    \n\n    \n\n      \nSkew\n\n      \n1.89\n\n      \n1.73\n\n      \n2.12\n\n    \n\n    \n\n      \nKurtosis\n\n      \n23.62\n\n      \n19.44\n\n      \n24.74\n\n    \n\n    \n\n      \nTail ratio\n\n      \n1.11\n\n      \n1.04\n\n      \n1.02\n\n    \n\n    \n\n      \nDaily value at risk\n\n      \n-4.7%\n\n      \n-5.3%\n\n      \n-2.9%\n\n    \n\n    \n\n      \nAlpha\n\n      \n0.20\n\n      \n0.21\n\n      \n0.18\n\n    \n\n    \n\n      \nBeta\n\n      \n1.04\n\n      \n1.01\n\n      \n1.11\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nWorst drawdown periods\n\n      \nNet drawdown in %\n\n      \nPeak date\n\n      \nValley date\n\n      \nRecovery date\n\n      \nDuration\n\n    \n\n  \n\n  \n\n    \n\n      \n0\n\n      \n47.90\n\n      \n2012-05-21\n\n      \n2012-09-04\n\n      \n2013-07-25\n\n      \n309\n\n    \n\n    \n\n      \n1\n\n      \n22.06\n\n      \n2014-03-10\n\n      \n2014-04-28\n\n      \n2014-07-24\n\n      \n99\n\n    \n\n    \n\n      \n2\n\n      \n17.34\n\n      \n2013-10-18\n\n      \n2013-11-25\n\n      \n2013-12-17\n\n      \n43\n\n    \n\n    \n\n      \n3\n\n      \n16.57\n\n      \n2015-07-21\n\n      \n2015-08-24\n\n      \n2015-10-19\n\n      \n65\n\n    \n\n    \n\n      \n4\n\n      \n13.68\n\n      \n2016-10-24\n\n      \n2016-12-30\n\n      \n2017-02-08\n\n      \n78",
            "title": "Single stock"
        },
        {
            "location": "/notebooks/single_stock_example/#single-stock-analysis-example-in-pyfolio",
            "text": "Here's a simple example where we produce a set of plots, called a tear sheet, for a single stock.",
            "title": "Single stock analysis example in pyfolio"
        },
        {
            "location": "/notebooks/single_stock_example/#import-pyfolio-and-matplotlib",
            "text": "import pyfolio as pf\n%matplotlib inline\n\n# silence warnings\nimport warnings\nwarnings.filterwarnings('ignore')",
            "title": "Import pyfolio and matplotlib"
        },
        {
            "location": "/notebooks/single_stock_example/#fetch-the-daily-returns-for-a-stock",
            "text": "stock_rets = pf.utils.get_symbol_rets('FB')",
            "title": "Fetch the daily returns for a stock"
        },
        {
            "location": "/notebooks/single_stock_example/#create-a-returns-tear-sheet-for-the-single-stock",
            "text": "This will show charts and analysis about returns of the single stock.  pf.create_returns_tear_sheet(stock_rets, live_start_date='2015-12-1')  Entire data start date: 2012-05-21\nEntire data end date: 2017-08-22\nIn-sample months: 42\nOut-of-sample months: 20   \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       \n       All \n       In-sample \n       Out-of-sample \n     \n   \n   \n     \n       Annual return \n       32.8% \n       32.9% \n       32.6% \n     \n     \n       Cumulative returns \n       343.7% \n       172.7% \n       62.7% \n     \n     \n       Annual volatility \n       38.0% \n       43.2% \n       24.3% \n     \n     \n       Sharpe ratio \n       0.93 \n       0.87 \n       1.28 \n     \n     \n       Calmar ratio \n       0.61 \n       0.61 \n       2.38 \n     \n     \n       Stability \n       0.92 \n       0.89 \n       0.88 \n     \n     \n       Max drawdown \n       -53.6% \n       -53.6% \n       -13.7% \n     \n     \n       Omega ratio \n       1.20 \n       1.18 \n       1.29 \n     \n     \n       Sortino ratio \n       1.50 \n       1.39 \n       2.09 \n     \n     \n       Skew \n       1.89 \n       1.73 \n       2.12 \n     \n     \n       Kurtosis \n       23.62 \n       19.44 \n       24.74 \n     \n     \n       Tail ratio \n       1.11 \n       1.04 \n       1.02 \n     \n     \n       Daily value at risk \n       -4.7% \n       -5.3% \n       -2.9% \n     \n     \n       Alpha \n       0.20 \n       0.21 \n       0.18 \n     \n     \n       Beta \n       1.04 \n       1.01 \n       1.11 \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Worst drawdown periods \n       Net drawdown in % \n       Peak date \n       Valley date \n       Recovery date \n       Duration \n     \n   \n   \n     \n       0 \n       47.90 \n       2012-05-21 \n       2012-09-04 \n       2013-07-25 \n       309 \n     \n     \n       1 \n       22.06 \n       2014-03-10 \n       2014-04-28 \n       2014-07-24 \n       99 \n     \n     \n       2 \n       17.34 \n       2013-10-18 \n       2013-11-25 \n       2013-12-17 \n       43 \n     \n     \n       3 \n       16.57 \n       2015-07-21 \n       2015-08-24 \n       2015-10-19 \n       65 \n     \n     \n       4 \n       13.68 \n       2016-10-24 \n       2016-12-30 \n       2017-02-08 \n       78",
            "title": "Create a returns tear sheet for the single stock"
        },
        {
            "location": "/notebooks/zipline_algo_example/",
            "text": "Zipline algorithm analysis example in pyfolio\n\n\nHere's an example where we run an algorithm with zipline, then produce tear sheets for that algorithm.\n\n\nImports\n\n\nImport pyfolio and zipline, and ingest the pricing data for backtesting.\n\n\nimport sys\nsys.path.append('/Users/george/Desktop/pyfolio/')\n\n\n\n\nimport pyfolio as pf\n%matplotlib inline\n\n# silence warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport zipline\n%load_ext zipline\n!zipline ingest\n\n\n\n\n\u001b[?25lDownloading Bundle: quantopian-quandl  [------------------------------------]    0%\n\n\n\nRun our zipline algorithm\n\n\nThis algorithm can also be adjusted to execute a modified, or completely different, trading strategy.\n\n\n%%zipline --start 2004-1-1 --end 2010-1-1 -o results.pickle\n\n# Zipline trading algorithm\n# Taken from zipline.examples.olmar\n\nimport numpy as np\n\nfrom zipline.finance import commission, slippage\n\nSTOCKS = ['AMD', 'CERN', 'COST', 'DELL', 'GPS', 'INTC', 'MMM']\n\n\n# On-Line Portfolio Moving Average Reversion\n\n# More info can be found in the corresponding paper:\n# http://icml.cc/2012/papers/168.pdf\ndef initialize(algo, eps=1, window_length=5):\n    algo.stocks = STOCKS\n    algo.sids = [algo.symbol(symbol) for symbol in algo.stocks]\n    algo.m = len(algo.stocks)\n    algo.price = {}\n    algo.b_t = np.ones(algo.m) / algo.m\n    algo.eps = eps\n    algo.window_length = window_length\n\n    algo.set_commission(commission.PerShare(cost=0))\n    algo.set_slippage(slippage.FixedSlippage(spread=0))\n\n\ndef handle_data(algo, data):\n    m = algo.m\n\n    x_tilde = np.zeros(m)\n    b = np.zeros(m)\n\n    # find relative moving average price for each asset\n    mavgs = data.history(algo.sids, 'price', algo.window_length, '1d').mean()\n    for i, sid in enumerate(algo.sids):\n        price = data.current(sid, \"price\")\n        # Relative mean deviation\n        x_tilde[i] = mavgs[sid] / price\n\n    ###########################\n    # Inside of OLMAR (algo 2)\n    x_bar = x_tilde.mean()\n\n    # market relative deviation\n    mark_rel_dev = x_tilde - x_bar\n\n    # Expected return with current portfolio\n    exp_return = np.dot(algo.b_t, x_tilde)\n    weight = algo.eps - exp_return\n    variability = (np.linalg.norm(mark_rel_dev)) ** 2\n\n    # test for divide-by-zero case\n    if variability == 0.0:\n        step_size = 0\n    else:\n        step_size = max(0, weight / variability)\n\n    b = algo.b_t + step_size * mark_rel_dev\n    b_norm = simplex_projection(b)\n    np.testing.assert_almost_equal(b_norm.sum(), 1)\n\n    rebalance_portfolio(algo, data, b_norm)\n\n    # update portfolio\n    algo.b_t = b_norm\n\n\ndef rebalance_portfolio(algo, data, desired_port):\n    # rebalance portfolio\n    for i, sid in enumerate(algo.sids):\n        algo.order_target_percent(sid, desired_port[i])\n\n\ndef simplex_projection(v, b=1):\n    \"\"\"Projection vectors to the simplex domain\n    Implemented according to the paper: Efficient projections onto the\n    l1-ball for learning in high dimensions, John Duchi, et al. ICML 2008.\n    Implementation Time: 2011 June 17 by Bin@libin AT pmail.ntu.edu.sg\n    Optimization Problem: min_{w}\\| w - v \\|_{2}^{2}\n    s.t. sum_{i=1}^{m}=z, w_{i}\\geq 0\n    Input: A vector v \\in R^{m}, and a scalar z > 0 (default=1)\n    Output: Projection vector w\n    :Example:\n    >>> proj = simplex_projection([.4 ,.3, -.4, .5])\n    >>> print(proj)\n    array([ 0.33333333, 0.23333333, 0. , 0.43333333])\n    >>> print(proj.sum())\n    1.0\n    Original matlab implementation: John Duchi (jduchi@cs.berkeley.edu)\n    Python-port: Copyright 2013 by Thomas Wiecki (thomas.wiecki@gmail.com).\n    \"\"\"\n\n    v = np.asarray(v)\n    p = len(v)\n\n    # Sort v into u in descending order\n    v = (v > 0) * v\n    u = np.sort(v)[::-1]\n    sv = np.cumsum(u)\n\n    rho = np.where(u > (sv - b) / np.arange(1, p + 1))[0][-1]\n    theta = np.max([0, (sv[rho] - b) / (rho + 1)])\n    w = (v - theta)\n    w[w < 0] = 0\n    return w\n\n\n\n\n\n\n\n  \n\n    \n\n      \n\n      \nalgo_volatility\n\n      \nalgorithm_period_return\n\n      \nalpha\n\n      \nbenchmark_period_return\n\n      \nbenchmark_volatility\n\n      \nbeta\n\n      \ncapital_used\n\n      \nending_cash\n\n      \nending_exposure\n\n      \nending_value\n\n      \n...\n\n      \nshort_exposure\n\n      \nshort_value\n\n      \nshorts_count\n\n      \nsortino\n\n      \nstarting_cash\n\n      \nstarting_exposure\n\n      \nstarting_value\n\n      \ntrading_days\n\n      \ntransactions\n\n      \ntreasury_period_return\n\n    \n\n  \n\n  \n\n    \n\n      \n2004-01-02 21:00:00+00:00\n\n      \nNaN\n\n      \n0.000000e+00\n\n      \nNaN\n\n      \n-0.000449\n\n      \nNaN\n\n      \nNaN\n\n      \n0.000000e+00\n\n      \n1.000000e+07\n\n      \n0.00\n\n      \n0.00\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \nNaN\n\n      \n1.000000e+07\n\n      \n0.00\n\n      \n0.00\n\n      \n1\n\n      \n[]\n\n      \n0.0438\n\n    \n\n    \n\n      \n2004-01-05 21:00:00+00:00\n\n      \n0.000008\n\n      \n-7.000000e-07\n\n      \n-0.000007\n\n      \n0.010424\n\n      \n0.127153\n\n      \n-0.000062\n\n      \n-1.012625e+07\n\n      \n-1.262475e+05\n\n      \n10126240.51\n\n      \n10126240.51\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-11.224972\n\n      \n1.000000e+07\n\n      \n0.00\n\n      \n0.00\n\n      \n2\n\n      \n[{u'commission': None, u'amount': 39332, u'sid...\n\n      \n0.0441\n\n    \n\n    \n\n      \n2004-01-06 21:00:00+00:00\n\n      \n0.072177\n\n      \n7.874142e-03\n\n      \n0.941443\n\n      \n0.011413\n\n      \n0.097935\n\n      \n-0.292225\n\n      \n1.098407e+05\n\n      \n-1.640676e+04\n\n      \n10095148.18\n\n      \n10095148.18\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n103096.791454\n\n      \n-1.262475e+05\n\n      \n10126240.51\n\n      \n10126240.51\n\n      \n3\n\n      \n[{u'commission': None, u'amount': 22673, u'sid...\n\n      \n0.0429\n\n    \n\n    \n\n      \n2004-01-07 21:00:00+00:00\n\n      \n0.064694\n\n      \n1.390826e-02\n\n      \n1.158059\n\n      \n0.014827\n\n      \n0.080035\n\n      \n-0.305795\n\n      \n3.809134e+04\n\n      \n2.168458e+04\n\n      \n10117398.03\n\n      \n10117398.03\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n157170.375195\n\n      \n-1.640676e+04\n\n      \n10095148.18\n\n      \n10095148.18\n\n      \n4\n\n      \n[{u'commission': None, u'amount': 4882, u'sid'...\n\n      \n0.0427\n\n    \n\n    \n\n      \n2004-01-08 21:00:00+00:00\n\n      \n0.202046\n\n      \n-1.030250e-02\n\n      \n-0.137563\n\n      \n0.018871\n\n      \n0.069343\n\n      \n-0.388318\n\n      \n1.594916e+04\n\n      \n3.763374e+04\n\n      \n9859341.24\n\n      \n9859341.24\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-2.978283\n\n      \n2.168458e+04\n\n      \n10117398.03\n\n      \n10117398.03\n\n      \n5\n\n      \n[{u'commission': None, u'amount': 7020, u'sid'...\n\n      \n0.0427\n\n    \n\n    \n\n      \n2004-01-09 21:00:00+00:00\n\n      \n0.181404\n\n      \n-9.874269e-03\n\n      \n-0.290170\n\n      \n0.009975\n\n      \n0.101951\n\n      \n-0.266625\n\n      \n-3.549779e+04\n\n      \n2.135950e+03\n\n      \n9899121.36\n\n      \n9899121.36\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-2.601355\n\n      \n3.763374e+04\n\n      \n9859341.24\n\n      \n9859341.24\n\n      \n6\n\n      \n[{u'commission': None, u'amount': 12007, u'sid...\n\n      \n0.0411\n\n    \n\n    \n\n      \n2004-01-12 21:00:00+00:00\n\n      \n0.169355\n\n      \n-5.602480e-03\n\n      \n-0.118894\n\n      \n0.017344\n\n      \n0.098995\n\n      \n-0.113533\n\n      \n-3.387390e+03\n\n      \n-1.251440e+03\n\n      \n9945226.64\n\n      \n9945226.64\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-1.324308\n\n      \n2.135950e+03\n\n      \n9899121.36\n\n      \n9899121.36\n\n      \n7\n\n      \n[{u'commission': None, u'amount': 879, u'sid':...\n\n      \n0.0411\n\n    \n\n    \n\n      \n2004-01-13 21:00:00+00:00\n\n      \n0.162138\n\n      \n-1.366743e-02\n\n      \n-0.454475\n\n      \n0.011503\n\n      \n0.102602\n\n      \n0.090323\n\n      \n-5.892000e+02\n\n      \n-1.840640e+03\n\n      \n9865166.35\n\n      \n9865166.35\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-2.977973\n\n      \n-1.251440e+03\n\n      \n9945226.64\n\n      \n9945226.64\n\n      \n8\n\n      \n[{u'commission': None, u'amount': 478, u'sid':...\n\n      \n0.0405\n\n    \n\n    \n\n      \n2004-01-14 21:00:00+00:00\n\n      \n0.156543\n\n      \n-8.090471e-03\n\n      \n-0.338686\n\n      \n0.020219\n\n      \n0.103200\n\n      \n0.216209\n\n      \n2.099000e+02\n\n      \n-1.630740e+03\n\n      \n9920726.03\n\n      \n9920726.03\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-1.621248\n\n      \n-1.840640e+03\n\n      \n9865166.35\n\n      \n9865166.35\n\n      \n9\n\n      \n[{u'commission': None, u'amount': -958, u'sid'...\n\n      \n0.0401\n\n    \n\n    \n\n      \n2004-01-15 21:00:00+00:00\n\n      \n0.147732\n\n      \n-1.021672e-02\n\n      \n-0.370917\n\n      \n0.022466\n\n      \n0.097298\n\n      \n0.216356\n\n      \n-2.985980e+03\n\n      \n-4.616720e+03\n\n      \n9902449.48\n\n      \n9902449.48\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-1.957694\n\n      \n-1.630740e+03\n\n      \n9920726.03\n\n      \n9920726.03\n\n      \n10\n\n      \n[{u'commission': None, u'amount': -12547, u'si...\n\n      \n0.0399\n\n    \n\n    \n\n      \n2004-01-16 21:00:00+00:00\n\n      \n0.150072\n\n      \n-9.720000e-05\n\n      \n-0.152516\n\n      \n0.026510\n\n      \n0.092669\n\n      \n0.265920\n\n      \n4.211040e+03\n\n      \n-4.056800e+02\n\n      \n9999433.68\n\n      \n9999433.68\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.066906\n\n      \n-4.616720e+03\n\n      \n9902449.48\n\n      \n9902449.48\n\n      \n11\n\n      \n[{u'commission': None, u'amount': 29, u'sid': ...\n\n      \n0.0404\n\n    \n\n    \n\n      \n2004-01-20 21:00:00+00:00\n\n      \n0.174603\n\n      \n-2.189795e-02\n\n      \n-0.677508\n\n      \n0.026240\n\n      \n0.089193\n\n      \n0.414247\n\n      \n-6.349190e+03\n\n      \n-6.754870e+03\n\n      \n9787775.37\n\n      \n9787775.37\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-2.942390\n\n      \n-4.056800e+02\n\n      \n9999433.68\n\n      \n9999433.68\n\n      \n12\n\n      \n[{u'commission': None, u'amount': -8204, u'sid...\n\n      \n0.0408\n\n    \n\n    \n\n      \n2004-01-21 21:00:00+00:00\n\n      \n0.167345\n\n      \n-2.194580e-02\n\n      \n-0.682346\n\n      \n0.033879\n\n      \n0.088489\n\n      \n0.408461\n\n      \n3.967860e+03\n\n      \n-2.787010e+03\n\n      \n9783328.99\n\n      \n9783328.99\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-2.833401\n\n      \n-6.754870e+03\n\n      \n9787775.37\n\n      \n9787775.37\n\n      \n13\n\n      \n[{u'commission': None, u'amount': 18, u'sid': ...\n\n      \n0.0405\n\n    \n\n    \n\n      \n2004-01-22 21:00:00+00:00\n\n      \n0.160815\n\n      \n-2.278829e-02\n\n      \n-0.620203\n\n      \n0.031991\n\n      \n0.087048\n\n      \n0.381335\n\n      \n3.202510e+03\n\n      \n4.155000e+02\n\n      \n9771701.58\n\n      \n9771701.58\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-2.838791\n\n      \n-2.787010e+03\n\n      \n9783328.99\n\n      \n9783328.99\n\n      \n14\n\n      \n[{u'commission': None, u'amount': 1177, u'sid'...\n\n      \n0.0399\n\n    \n\n    \n\n      \n2004-01-23 21:00:00+00:00\n\n      \n0.156057\n\n      \n-1.995549e-02\n\n      \n-0.466320\n\n      \n0.028307\n\n      \n0.087226\n\n      \n0.294719\n\n      \n-5.584200e+02\n\n      \n-1.429200e+02\n\n      \n9800588.06\n\n      \n9800588.06\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-2.386967\n\n      \n4.155000e+02\n\n      \n9771701.58\n\n      \n9771701.58\n\n      \n15\n\n      \n[{u'commission': None, u'amount': -1437, u'sid...\n\n      \n0.0409\n\n    \n\n    \n\n      \n2004-01-26 21:00:00+00:00\n\n      \n0.151899\n\n      \n-1.665361e-02\n\n      \n-0.460877\n\n      \n0.041247\n\n      \n0.094376\n\n      \n0.323325\n\n      \n-5.684500e+02\n\n      \n-7.113700e+02\n\n      \n9834175.24\n\n      \n9834175.24\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-1.911049\n\n      \n-1.429200e+02\n\n      \n9800588.06\n\n      \n9800588.06\n\n      \n16\n\n      \n[{u'commission': None, u'amount': 1760, u'sid'...\n\n      \n0.0416\n\n    \n\n    \n\n      \n2004-01-27 21:00:00+00:00\n\n      \n0.149383\n\n      \n-2.432286e-02\n\n      \n-0.521233\n\n      \n0.030554\n\n      \n0.103850\n\n      \n0.369999\n\n      \n4.884130e+03\n\n      \n4.172760e+03\n\n      \n9752598.61\n\n      \n9752598.61\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-2.680537\n\n      \n-7.113700e+02\n\n      \n9834175.24\n\n      \n9834175.24\n\n      \n17\n\n      \n[{u'commission': None, u'amount': 27757, u'sid...\n\n      \n0.0411\n\n    \n\n    \n\n      \n2004-01-28 21:00:00+00:00\n\n      \n0.159088\n\n      \n-4.280630e-02\n\n      \n-0.745407\n\n      \n0.018422\n\n      \n0.112811\n\n      \n0.556821\n\n      \n-3.171400e+03\n\n      \n1.001360e+03\n\n      \n9570935.67\n\n      \n9570935.67\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-4.088941\n\n      \n4.172760e+03\n\n      \n9752598.61\n\n      \n9752598.61\n\n      \n18\n\n      \n[{u'commission': None, u'amount': 3192, u'sid'...\n\n      \n0.0422\n\n    \n\n    \n\n      \n2004-01-29 21:00:00+00:00\n\n      \n0.154753\n\n      \n-4.330959e-02\n\n      \n-0.723066\n\n      \n0.019770\n\n      \n0.109637\n\n      \n0.557354\n\n      \n-1.023840e+03\n\n      \n-2.248000e+01\n\n      \n9566926.58\n\n      \n9566926.58\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-4.028374\n\n      \n1.001360e+03\n\n      \n9570935.67\n\n      \n9570935.67\n\n      \n19\n\n      \n[{u'commission': None, u'amount': 740, u'sid':...\n\n      \n0.0422\n\n    \n\n    \n\n      \n2004-01-30 21:00:00+00:00\n\n      \n0.151981\n\n      \n-4.003614e-02\n\n      \n-0.641952\n\n      \n0.019770\n\n      \n0.106778\n\n      \n0.550030\n\n      \n-3.302200e+02\n\n      \n-3.527000e+02\n\n      \n9599991.28\n\n      \n9599991.28\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-3.616538\n\n      \n-2.248000e+01\n\n      \n9566926.58\n\n      \n9566926.58\n\n      \n20\n\n      \n[{u'commission': None, u'amount': 202, u'sid':...\n\n      \n0.0416\n\n    \n\n    \n\n      \n2004-02-02 21:00:00+00:00\n\n      \n0.148849\n\n      \n-3.791101e-02\n\n      \n-0.611549\n\n      \n0.023544\n\n      \n0.104494\n\n      \n0.558118\n\n      \n7.507400e+02\n\n      \n3.980400e+02\n\n      \n9620491.88\n\n      \n9620491.88\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-3.333751\n\n      \n-3.527000e+02\n\n      \n9599991.28\n\n      \n9599991.28\n\n      \n21\n\n      \n[{u'commission': None, u'amount': -774, u'sid'...\n\n      \n0.0418\n\n    \n\n    \n\n      \n2004-02-03 21:00:00+00:00\n\n      \n0.149505\n\n      \n-2.958549e-02\n\n      \n-0.470647\n\n      \n0.022466\n\n      \n0.102243\n\n      \n0.530207\n\n      \n-3.759100e+02\n\n      \n2.213000e+01\n\n      \n9704122.98\n\n      \n9704122.98\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-2.509972\n\n      \n3.980400e+02\n\n      \n9620491.88\n\n      \n9620491.88\n\n      \n22\n\n      \n[{u'commission': None, u'amount': -1805, u'sid...\n\n      \n0.0413\n\n    \n\n    \n\n      \n2004-02-04 21:00:00+00:00\n\n      \n0.148908\n\n      \n-3.935433e-02\n\n      \n-0.518102\n\n      \n0.014019\n\n      \n0.104520\n\n      \n0.565794\n\n      \n2.243250e+04\n\n      \n2.245463e+04\n\n      \n9584002.02\n\n      \n9584002.02\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-3.200968\n\n      \n2.213000e+01\n\n      \n9704122.98\n\n      \n9704122.98\n\n      \n23\n\n      \n[{u'commission': None, u'amount': -115293, u's...\n\n      \n0.0415\n\n    \n\n    \n\n      \n2004-02-05 21:00:00+00:00\n\n      \n0.157685\n\n      \n-2.306599e-02\n\n      \n-0.343928\n\n      \n0.017074\n\n      \n0.102515\n\n      \n0.607067\n\n      \n-2.537802e+04\n\n      \n-2.923390e+03\n\n      \n9772263.47\n\n      \n9772263.47\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-1.776034\n\n      \n2.245463e+04\n\n      \n9584002.02\n\n      \n9584002.02\n\n      \n24\n\n      \n[{u'commission': None, u'amount': 28, u'sid': ...\n\n      \n0.0420\n\n    \n\n    \n\n      \n2004-02-06 21:00:00+00:00\n\n      \n0.169544\n\n      \n-2.392913e-03\n\n      \n-0.228447\n\n      \n0.028487\n\n      \n0.105744\n\n      \n0.755742\n\n      \n-7.073620e+03\n\n      \n-9.997010e+03\n\n      \n9986067.88\n\n      \n9986067.88\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-0.080130\n\n      \n-2.923390e+03\n\n      \n9772263.47\n\n      \n9772263.47\n\n      \n25\n\n      \n[{u'commission': None, u'amount': -5231, u'sid...\n\n      \n0.0412\n\n    \n\n    \n\n      \n2004-02-09 21:00:00+00:00\n\n      \n0.166124\n\n      \n-2.006309e-03\n\n      \n-0.220937\n\n      \n0.029206\n\n      \n0.103617\n\n      \n0.755433\n\n      \n4.991920e+03\n\n      \n-5.005090e+03\n\n      \n9984942.00\n\n      \n9984942.00\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n-0.048764\n\n      \n-9.997010e+03\n\n      \n9986067.88\n\n      \n9986067.88\n\n      \n26\n\n      \n[{u'commission': None, u'amount': 3350, u'sid'...\n\n      \n0.0409\n\n    \n\n    \n\n      \n2004-02-10 21:00:00+00:00\n\n      \n0.179042\n\n      \n2.224008e-02\n\n      \n-0.016088\n\n      \n0.032081\n\n      \n0.101732\n\n      \n0.790076\n\n      \n3.909423e+04\n\n      \n3.408914e+04\n\n      \n10188311.63\n\n      \n10188311.63\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n1.786071\n\n      \n-5.005090e+03\n\n      \n9984942.00\n\n      \n9984942.00\n\n      \n27\n\n      \n[{u'commission': None, u'amount': 20374, u'sid...\n\n      \n0.0413\n\n    \n\n    \n\n      \n2004-02-11 21:00:00+00:00\n\n      \n0.175854\n\n      \n2.568422e-02\n\n      \n-0.045677\n\n      \n0.043045\n\n      \n0.103763\n\n      \n0.750971\n\n      \n-9.027760e+04\n\n      \n-5.618846e+04\n\n      \n10313030.69\n\n      \n10313030.69\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n2.003630\n\n      \n3.408914e+04\n\n      \n10188311.63\n\n      \n10188311.63\n\n      \n28\n\n      \n[{u'commission': None, u'amount': 86138, u'sid...\n\n      \n0.0405\n\n    \n\n    \n\n      \n2004-02-12 21:00:00+00:00\n\n      \n0.174331\n\n      \n1.835900e-02\n\n      \n-0.088628\n\n      \n0.039270\n\n      \n0.103016\n\n      \n0.768848\n\n      \n6.841798e+04\n\n      \n1.222952e+04\n\n      \n10171360.46\n\n      \n10171360.46\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n1.426563\n\n      \n-5.618846e+04\n\n      \n10313030.69\n\n      \n10313030.69\n\n      \n29\n\n      \n[{u'commission': None, u'amount': 60959, u'sid...\n\n      \n0.0410\n\n    \n\n    \n\n      \n2004-02-13 21:00:00+00:00\n\n      \n0.174263\n\n      \n7.811894e-03\n\n      \n-0.152515\n\n      \n0.034597\n\n      \n0.102633\n\n      \n0.799374\n\n      \n-8.834620e+03\n\n      \n3.394900e+03\n\n      \n10074724.04\n\n      \n10074724.04\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.651812\n\n      \n1.222952e+04\n\n      \n10171360.46\n\n      \n10171360.46\n\n      \n30\n\n      \n[{u'commission': None, u'amount': -2990, u'sid...\n\n      \n0.0405\n\n    \n\n    \n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n      \n...\n\n    \n\n    \n\n      \n2009-11-18 21:00:00+00:00\n\n      \n0.257581\n\n      \n6.008698e-01\n\n      \n0.099259\n\n      \n-0.000090\n\n      \n0.683428\n\n      \n0.080995\n\n      \n-2.965000e+02\n\n      \n-1.613460e+02\n\n      \n16008859.05\n\n      \n16008859.05\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.642225\n\n      \n1.351540e+02\n\n      \n16099119.48\n\n      \n16099119.48\n\n      \n1482\n\n      \n[{u'commission': None, u'amount': 126, u'sid':...\n\n      \n0.0336\n\n    \n\n    \n\n      \n2009-11-19 21:00:00+00:00\n\n      \n0.257584\n\n      \n5.751349e-01\n\n      \n0.096627\n\n      \n-0.013120\n\n      \n0.683220\n\n      \n0.081072\n\n      \n6.384500e+02\n\n      \n4.771040e+02\n\n      \n15750871.82\n\n      \n15750871.82\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.626050\n\n      \n-1.613460e+02\n\n      \n16008859.05\n\n      \n16008859.05\n\n      \n1483\n\n      \n[{u'commission': None, u'amount': -2169, u'sid...\n\n      \n0.0335\n\n    \n\n    \n\n      \n2009-11-20 21:00:00+00:00\n\n      \n0.257497\n\n      \n5.760543e-01\n\n      \n0.096710\n\n      \n-0.016625\n\n      \n0.682992\n\n      \n0.081071\n\n      \n-9.618800e+02\n\n      \n-4.847760e+02\n\n      \n15761027.55\n\n      \n15761027.55\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.626402\n\n      \n4.771040e+02\n\n      \n15750871.82\n\n      \n15750871.82\n\n      \n1484\n\n      \n[{u'commission': None, u'amount': 1554, u'sid'...\n\n      \n0.0336\n\n    \n\n    \n\n      \n2009-11-23 21:00:00+00:00\n\n      \n0.257412\n\n      \n5.801855e-01\n\n      \n0.096914\n\n      \n-0.004134\n\n      \n0.682780\n\n      \n0.081077\n\n      \n2.498000e+01\n\n      \n-4.597960e+02\n\n      \n15802314.57\n\n      \n15802314.57\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.628718\n\n      \n-4.847760e+02\n\n      \n15761027.55\n\n      \n15761027.55\n\n      \n1485\n\n      \n[{u'commission': None, u'amount': -1472, u'sid...\n\n      \n0.0337\n\n    \n\n    \n\n      \n2009-11-24 21:00:00+00:00\n\n      \n0.257339\n\n      \n5.910314e-01\n\n      \n0.097991\n\n      \n-0.002606\n\n      \n0.682550\n\n      \n0.081079\n\n      \n-7.668800e+02\n\n      \n-1.226676e+03\n\n      \n15911540.99\n\n      \n15911540.99\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.635119\n\n      \n-4.597960e+02\n\n      \n15802314.57\n\n      \n15802314.57\n\n      \n1486\n\n      \n[{u'commission': None, u'amount': 3775, u'sid'...\n\n      \n0.0332\n\n    \n\n    \n\n      \n2009-11-25 21:00:00+00:00\n\n      \n0.257277\n\n      \n6.056737e-01\n\n      \n0.099435\n\n      \n0.000899\n\n      \n0.682322\n\n      \n0.081087\n\n      \n7.561600e+02\n\n      \n-4.705160e+02\n\n      \n16057207.89\n\n      \n16057207.89\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.643769\n\n      \n-1.226676e+03\n\n      \n15911540.99\n\n      \n15911540.99\n\n      \n1487\n\n      \n[{u'commission': None, u'amount': -18139, u'si...\n\n      \n0.0328\n\n    \n\n    \n\n      \n2009-11-27 18:00:00+00:00\n\n      \n0.257296\n\n      \n5.777323e-01\n\n      \n0.096627\n\n      \n-0.015367\n\n      \n0.682128\n\n      \n0.081189\n\n      \n-9.221030e+03\n\n      \n-9.691546e+03\n\n      \n15787014.39\n\n      \n15787014.39\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.626279\n\n      \n-4.705160e+02\n\n      \n16057207.89\n\n      \n16057207.89\n\n      \n1488\n\n      \n[{u'commission': None, u'amount': -108386, u's...\n\n      \n0.0321\n\n    \n\n    \n\n      \n2009-11-30 21:00:00+00:00\n\n      \n0.257262\n\n      \n5.583863e-01\n\n      \n0.094443\n\n      \n-0.012042\n\n      \n0.681899\n\n      \n0.081176\n\n      \n9.661970e+03\n\n      \n-2.957600e+01\n\n      \n15583892.62\n\n      \n15583892.62\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.614025\n\n      \n-9.691546e+03\n\n      \n15787014.39\n\n      \n15787014.39\n\n      \n1489\n\n      \n[{u'commission': None, u'amount': -2, u'sid': ...\n\n      \n0.0321\n\n    \n\n    \n\n      \n2009-12-01 21:00:00+00:00\n\n      \n0.257202\n\n      \n5.728593e-01\n\n      \n0.095775\n\n      \n0.000180\n\n      \n0.681687\n\n      \n0.081210\n\n      \n-2.880110e+03\n\n      \n-2.909686e+03\n\n      \n15731503.04\n\n      \n15731503.04\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.622743\n\n      \n-2.957600e+01\n\n      \n15583892.62\n\n      \n15583892.62\n\n      \n1490\n\n      \n[{u'commission': None, u'amount': 4666, u'sid'...\n\n      \n0.0328\n\n    \n\n    \n\n      \n2009-12-02 21:00:00+00:00\n\n      \n0.257128\n\n      \n5.637940e-01\n\n      \n0.094742\n\n      \n-0.000270\n\n      \n0.681459\n\n      \n0.081212\n\n      \n3.608900e+03\n\n      \n6.992140e+02\n\n      \n15637240.49\n\n      \n15637240.49\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.616942\n\n      \n-2.909686e+03\n\n      \n15731503.04\n\n      \n15731503.04\n\n      \n1491\n\n      \n[{u'commission': None, u'amount': -4907, u'sid...\n\n      \n0.0332\n\n    \n\n    \n\n      \n2009-12-03 21:00:00+00:00\n\n      \n0.257153\n\n      \n5.356815e-01\n\n      \n0.091740\n\n      \n-0.008088\n\n      \n0.681239\n\n      \n0.081267\n\n      \n-1.671090e+03\n\n      \n-9.718760e+02\n\n      \n15357787.00\n\n      \n15357787.00\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.598945\n\n      \n6.992140e+02\n\n      \n15637240.49\n\n      \n15637240.49\n\n      \n1492\n\n      \n[{u'commission': None, u'amount': 1667, u'sid'...\n\n      \n0.0339\n\n    \n\n    \n\n      \n2009-12-04 21:00:00+00:00\n\n      \n0.257089\n\n      \n5.489262e-01\n\n      \n0.093054\n\n      \n-0.002426\n\n      \n0.681014\n\n      \n0.081282\n\n      \n1.217390e+03\n\n      \n2.455140e+02\n\n      \n15489016.40\n\n      \n15489016.40\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.607016\n\n      \n-9.718760e+02\n\n      \n15357787.00\n\n      \n15357787.00\n\n      \n1493\n\n      \n[{u'commission': None, u'amount': -1387, u'sid...\n\n      \n0.0348\n\n    \n\n    \n\n      \n2009-12-07 21:00:00+00:00\n\n      \n0.257030\n\n      \n5.354856e-01\n\n      \n0.091548\n\n      \n-0.003954\n\n      \n0.680786\n\n      \n0.081289\n\n      \n-2.795400e+02\n\n      \n-3.402600e+01\n\n      \n15354889.76\n\n      \n15354889.76\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.598371\n\n      \n2.455140e+02\n\n      \n15489016.40\n\n      \n15489016.40\n\n      \n1494\n\n      \n[{u'commission': None, u'amount': -1961, u'sid...\n\n      \n0.0344\n\n    \n\n    \n\n      \n2009-12-08 21:00:00+00:00\n\n      \n0.257055\n\n      \n5.078036e-01\n\n      \n0.088587\n\n      \n-0.015007\n\n      \n0.680576\n\n      \n0.081364\n\n      \n1.316500e+02\n\n      \n9.762400e+01\n\n      \n15077938.34\n\n      \n15077938.34\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.580382\n\n      \n-3.402600e+01\n\n      \n15354889.76\n\n      \n15354889.76\n\n      \n1495\n\n      \n[{u'commission': None, u'amount': -795, u'sid'...\n\n      \n0.0340\n\n    \n\n    \n\n      \n2009-12-09 21:00:00+00:00\n\n      \n0.256971\n\n      \n5.048394e-01\n\n      \n0.088146\n\n      \n-0.011323\n\n      \n0.680349\n\n      \n0.081361\n\n      \n-2.696890e+03\n\n      \n-2.599266e+03\n\n      \n15050993.27\n\n      \n15050993.27\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.578300\n\n      \n9.762400e+01\n\n      \n15077938.34\n\n      \n15077938.34\n\n      \n1496\n\n      \n[{u'commission': None, u'amount': -1367, u'sid...\n\n      \n0.0345\n\n    \n\n    \n\n      \n2009-12-10 21:00:00+00:00\n\n      \n0.256909\n\n      \n5.181698e-01\n\n      \n0.089499\n\n      \n-0.005751\n\n      \n0.680125\n\n      \n0.081375\n\n      \n2.364150e+03\n\n      \n-2.351160e+02\n\n      \n15181933.08\n\n      \n15181933.08\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.586582\n\n      \n-2.599266e+03\n\n      \n15050993.27\n\n      \n15050993.27\n\n      \n1497\n\n      \n[{u'commission': None, u'amount': 5379, u'sid'...\n\n      \n0.0349\n\n    \n\n    \n\n      \n2009-12-11 21:00:00+00:00\n\n      \n0.256836\n\n      \n5.283234e-01\n\n      \n0.090504\n\n      \n-0.001528\n\n      \n0.679899\n\n      \n0.081383\n\n      \n2.523800e+02\n\n      \n1.726400e+01\n\n      \n15283216.38\n\n      \n15283216.38\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.592783\n\n      \n-2.351160e+02\n\n      \n15181933.08\n\n      \n15181933.08\n\n      \n1498\n\n      \n[{u'commission': None, u'amount': -483, u'sid'...\n\n      \n0.0355\n\n    \n\n    \n\n      \n2009-12-14 21:00:00+00:00\n\n      \n0.256789\n\n      \n5.454956e-01\n\n      \n0.092235\n\n      \n0.005302\n\n      \n0.679677\n\n      \n0.081406\n\n      \n6.313700e+03\n\n      \n6.330964e+03\n\n      \n15448625.06\n\n      \n15448625.06\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.603328\n\n      \n1.726400e+01\n\n      \n15283216.38\n\n      \n15283216.38\n\n      \n1499\n\n      \n[{u'commission': None, u'amount': -21110, u'si...\n\n      \n0.0356\n\n    \n\n    \n\n      \n2009-12-15 21:00:00+00:00\n\n      \n0.256712\n\n      \n5.540960e-01\n\n      \n0.093174\n\n      \n0.000629\n\n      \n0.679454\n\n      \n0.081395\n\n      \n-2.764129e+04\n\n      \n-2.131033e+04\n\n      \n15562270.30\n\n      \n15562270.30\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.608445\n\n      \n6.330964e+03\n\n      \n15448625.06\n\n      \n15448625.06\n\n      \n1500\n\n      \n[{u'commission': None, u'amount': -273861, u's...\n\n      \n0.0360\n\n    \n\n    \n\n      \n2009-12-16 21:00:00+00:00\n\n      \n0.256629\n\n      \n5.591566e-01\n\n      \n0.093638\n\n      \n0.002157\n\n      \n0.679227\n\n      \n0.081396\n\n      \n1.440453e+05\n\n      \n1.227349e+05\n\n      \n15468831.23\n\n      \n15468831.23\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.611354\n\n      \n-2.131033e+04\n\n      \n15562270.30\n\n      \n15562270.30\n\n      \n1501\n\n      \n[{u'commission': None, u'amount': 108105, u'si...\n\n      \n0.0361\n\n    \n\n    \n\n      \n2009-12-17 21:00:00+00:00\n\n      \n0.256583\n\n      \n5.426112e-01\n\n      \n0.091951\n\n      \n-0.009885\n\n      \n0.679021\n\n      \n0.081442\n\n      \n-1.195010e+05\n\n      \n3.233914e+03\n\n      \n15422877.79\n\n      \n15422877.79\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.600831\n\n      \n1.227349e+05\n\n      \n15468831.23\n\n      \n15468831.23\n\n      \n1502\n\n      \n[{u'commission': None, u'amount': 9112, u'sid'...\n\n      \n0.0350\n\n    \n\n    \n\n      \n2009-12-18 21:00:00+00:00\n\n      \n0.256572\n\n      \n5.665010e-01\n\n      \n0.094483\n\n      \n-0.009615\n\n      \n0.678795\n\n      \n0.081440\n\n      \n-4.617290e+03\n\n      \n-1.383376e+03\n\n      \n15666393.17\n\n      \n15666393.17\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.615413\n\n      \n3.233914e+03\n\n      \n15422877.79\n\n      \n15422877.79\n\n      \n1503\n\n      \n[{u'commission': None, u'amount': 2044, u'sid'...\n\n      \n0.0355\n\n    \n\n    \n\n      \n2009-12-21 21:00:00+00:00\n\n      \n0.256673\n\n      \n6.045817e-01\n\n      \n0.098342\n\n      \n0.000449\n\n      \n0.678580\n\n      \n0.081520\n\n      \n4.766944e+04\n\n      \n4.628606e+04\n\n      \n15999531.04\n\n      \n15999531.04\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.638404\n\n      \n-1.383376e+03\n\n      \n15666393.17\n\n      \n15666393.17\n\n      \n1504\n\n      \n[{u'commission': None, u'amount': 64288, u'sid...\n\n      \n0.0369\n\n    \n\n    \n\n      \n2009-12-22 21:00:00+00:00\n\n      \n0.256588\n\n      \n6.030770e-01\n\n      \n0.098071\n\n      \n0.004044\n\n      \n0.678355\n\n      \n0.081518\n\n      \n-4.947564e+04\n\n      \n-3.189576e+03\n\n      \n16033959.57\n\n      \n16033959.57\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.637296\n\n      \n4.628606e+04\n\n      \n15999531.04\n\n      \n15999531.04\n\n      \n1505\n\n      \n[{u'commission': None, u'amount': 162944, u'si...\n\n      \n0.0376\n\n    \n\n    \n\n      \n2009-12-23 21:00:00+00:00\n\n      \n0.256510\n\n      \n6.113661e-01\n\n      \n0.098843\n\n      \n0.006021\n\n      \n0.678130\n\n      \n0.081521\n\n      \n1.820101e+04\n\n      \n1.501143e+04\n\n      \n16098649.18\n\n      \n16098649.18\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.642015\n\n      \n-3.189576e+03\n\n      \n16033959.57\n\n      \n16033959.57\n\n      \n1506\n\n      \n[{u'commission': None, u'amount': 100740, u'si...\n\n      \n0.0377\n\n    \n\n    \n\n      \n2009-12-24 18:00:00+00:00\n\n      \n0.256425\n\n      \n6.129331e-01\n\n      \n0.098876\n\n      \n0.010784\n\n      \n0.677907\n\n      \n0.081521\n\n      \n1.411030e+04\n\n      \n2.912173e+04\n\n      \n16100208.93\n\n      \n16100208.93\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.642729\n\n      \n1.501143e+04\n\n      \n16098649.18\n\n      \n16098649.18\n\n      \n1507\n\n      \n[{u'commission': None, u'amount': 61067, u'sid...\n\n      \n0.0382\n\n    \n\n    \n\n      \n2009-12-28 21:00:00+00:00\n\n      \n0.256359\n\n      \n6.261147e-01\n\n      \n0.100146\n\n      \n0.012940\n\n      \n0.677682\n\n      \n0.081525\n\n      \n-3.452828e+04\n\n      \n-5.406546e+03\n\n      \n16266553.28\n\n      \n16266553.28\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.650304\n\n      \n2.912173e+04\n\n      \n16100208.93\n\n      \n16100208.93\n\n      \n1508\n\n      \n[{u'commission': None, u'amount': 20274, u'sid...\n\n      \n0.0385\n\n    \n\n    \n\n      \n2009-12-29 21:00:00+00:00\n\n      \n0.256290\n\n      \n6.382284e-01\n\n      \n0.101344\n\n      \n0.011503\n\n      \n0.677458\n\n      \n0.081519\n\n      \n-6.974254e+03\n\n      \n-1.238080e+04\n\n      \n16394664.33\n\n      \n16394664.33\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.657185\n\n      \n-5.406546e+03\n\n      \n16266553.28\n\n      \n16266553.28\n\n      \n1509\n\n      \n[{u'commission': None, u'amount': 69484, u'sid...\n\n      \n0.0382\n\n    \n\n    \n\n      \n2009-12-30 21:00:00+00:00\n\n      \n0.256206\n\n      \n6.422355e-01\n\n      \n0.101690\n\n      \n0.011143\n\n      \n0.677234\n\n      \n0.081519\n\n      \n-1.493927e+05\n\n      \n-1.617735e+05\n\n      \n16584128.61\n\n      \n16584128.61\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.659296\n\n      \n-1.238080e+04\n\n      \n16394664.33\n\n      \n16394664.33\n\n      \n1510\n\n      \n[{u'commission': None, u'amount': -244304, u's...\n\n      \n0.0380\n\n    \n\n    \n\n      \n2009-12-31 21:00:00+00:00\n\n      \n0.256245\n\n      \n6.110285e-01\n\n      \n0.098572\n\n      \n0.001438\n\n      \n0.677023\n\n      \n0.081588\n\n      \n6.987978e+04\n\n      \n-9.189371e+04\n\n      \n16202178.41\n\n      \n16202178.41\n\n      \n...\n\n      \n0\n\n      \n0\n\n      \n0\n\n      \n0.640360\n\n      \n-1.617735e+05\n\n      \n16584128.61\n\n      \n16584128.61\n\n      \n1511\n\n      \n[{u'commission': None, u'amount': -116692, u's...\n\n      \n0.0385\n\n    \n\n  \n\n\n\n\n1511 rows \u00d7 37 columns\n\n\n\n\n\nExtract metrics\n\n\nGet the returns, positions, and transactions from the zipline backtest object.\n\n\nimport pandas as pd\n\nresults = pd.read_pickle('results.pickle')\nreturns, positions, transactions = pf.utils.extract_rets_pos_txn_from_zipline(results)\n\n\n\n\nSingle plot example\n\n\nMake one plot of the top 5 drawdown periods.\n\n\npf.plot_drawdown_periods(returns, top=5).set_xlabel('Date')\n\n\n\n\n<matplotlib.text.Text at 0x1207c8050>\n\n\n\n\n\nFull tear sheet example\n\n\nCreate a full tear sheet for our algorithm. As an example, set the live start date to something arbitrary.\n\n\npf.create_full_tear_sheet(returns, positions=positions, transactions=transactions,\n                          live_start_date='2009-10-22', round_trips=True)\n\n\n\n\n/Users/georgeho/pyfolio/pyfolio/utils.py:251: UserWarning: Yahoo Finance read failed: HTTPConnectionPool(host='ichart.finance.yahoo.com', port=80): Max retries exceeded with url: /table.csv?a=0&ignore=.csv&s=SPY&b=1&e=13&d=7&g=d&f=2017&c=1970 (Caused by NewConnectionError('<requests.packages.urllib3.connection.HTTPConnection object at 0x12372a750>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known',)), falling back to Google\n  UserWarning)\n\n\nEntire data start date: 2004-01-02\nEntire data end date: 2009-12-31\nIn-sample months: 69\nOut-of-sample months: 2\n\n\n\n\n\n\n  \n\n    \n\n      \n\n      \nAll\n\n      \nIn-sample\n\n      \nOut-of-sample\n\n    \n\n  \n\n  \n\n    \n\n      \nAnnual return\n\n      \n8.3%\n\n      \n8.1%\n\n      \n14.9%\n\n    \n\n    \n\n      \nCumulative returns\n\n      \n61.1%\n\n      \n56.8%\n\n      \n2.7%\n\n    \n\n    \n\n      \nAnnual volatility\n\n      \n25.6%\n\n      \n25.7%\n\n      \n22.0%\n\n    \n\n    \n\n      \nSharpe ratio\n\n      \n0.44\n\n      \n0.43\n\n      \n0.74\n\n    \n\n    \n\n      \nCalmar ratio\n\n      \n0.14\n\n      \n0.13\n\n      \n2.03\n\n    \n\n    \n\n      \nStability\n\n      \n0.00\n\n      \n0.01\n\n      \n0.04\n\n    \n\n    \n\n      \nMax drawdown\n\n      \n-60.3%\n\n      \n-60.3%\n\n      \n-7.3%\n\n    \n\n    \n\n      \nOmega ratio\n\n      \n1.08\n\n      \n1.08\n\n      \n1.13\n\n    \n\n    \n\n      \nSortino ratio\n\n      \n0.64\n\n      \n0.63\n\n      \n1.04\n\n    \n\n    \n\n      \nSkew\n\n      \n0.21\n\n      \n0.22\n\n      \n-0.29\n\n    \n\n    \n\n      \nKurtosis\n\n      \n4.19\n\n      \n4.24\n\n      \n0.36\n\n    \n\n    \n\n      \nTail ratio\n\n      \n0.97\n\n      \n0.99\n\n      \n1.23\n\n    \n\n    \n\n      \nDaily value at risk\n\n      \n-3.2%\n\n      \n-3.2%\n\n      \n-2.7%\n\n    \n\n    \n\n      \nGross leverage\n\n      \n1.00\n\n      \n1.00\n\n      \n1.00\n\n    \n\n    \n\n      \nDaily turnover\n\n      \n7.6%\n\n      \n7.5%\n\n      \n9.6%\n\n    \n\n    \n\n      \nAlpha\n\n      \n0.09\n\n      \n0.10\n\n      \n-0.03\n\n    \n\n    \n\n      \nBeta\n\n      \n0.83\n\n      \n0.82\n\n      \n1.19\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n  \n\n    \n\n      \nWorst drawdown periods\n\n      \nNet drawdown in %\n\n      \nPeak date\n\n      \nValley date\n\n      \nRecovery date\n\n      \nDuration\n\n    \n\n  \n\n  \n\n    \n\n      \n0\n\n      \n60.30\n\n      \n2007-11-06\n\n      \n2008-11-20\n\n      \nNaT\n\n      \nNaN\n\n    \n\n    \n\n      \n1\n\n      \n23.25\n\n      \n2006-04-06\n\n      \n2006-09-07\n\n      \n2007-05-22\n\n      \n294\n\n    \n\n    \n\n      \n2\n\n      \n12.52\n\n      \n2004-11-15\n\n      \n2005-10-12\n\n      \n2006-01-11\n\n      \n303\n\n    \n\n    \n\n      \n3\n\n      \n10.90\n\n      \n2004-06-25\n\n      \n2004-08-12\n\n      \n2004-11-04\n\n      \n95\n\n    \n\n    \n\n      \n4\n\n      \n9.47\n\n      \n2007-07-16\n\n      \n2007-08-06\n\n      \n2007-09-04\n\n      \n37\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n/Users/georgeho/anaconda/lib/python2.7/site-packages/numpy/lib/function_base.py:4269: RuntimeWarning: Invalid value encountered in percentile\n  interpolation=interpolation)\n\n\n\n\n\n\n  \n\n    \n\n      \nStress Events\n\n      \nmean\n\n      \nmin\n\n      \nmax\n\n    \n\n  \n\n  \n\n    \n\n      \nLehmann\n\n      \n-0.28%\n\n      \n-7.41%\n\n      \n4.40%\n\n    \n\n    \n\n      \nAug07\n\n      \n0.35%\n\n      \n-2.96%\n\n      \n3.03%\n\n    \n\n    \n\n      \nMar08\n\n      \n-0.43%\n\n      \n-3.10%\n\n      \n3.34%\n\n    \n\n    \n\n      \nSept08\n\n      \n-0.68%\n\n      \n-7.41%\n\n      \n3.99%\n\n    \n\n    \n\n      \n2009Q1\n\n      \n-0.35%\n\n      \n-4.98%\n\n      \n3.36%\n\n    \n\n    \n\n      \n2009Q2\n\n      \n0.71%\n\n      \n-3.78%\n\n      \n6.17%\n\n    \n\n    \n\n      \nLow Volatility Bull Market\n\n      \n0.01%\n\n      \n-6.11%\n\n      \n6.45%\n\n    \n\n    \n\n      \nGFC Crash\n\n      \n-0.08%\n\n      \n-7.58%\n\n      \n9.71%\n\n    \n\n    \n\n      \nRecovery\n\n      \n0.32%\n\n      \n-3.78%\n\n      \n6.17%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n\n\n  \n\n    \n\n      \nTop 10 long positions of all time\n\n      \nmax\n\n    \n\n  \n\n  \n\n    \n\n      \nCOST\n\n      \n100.74%\n\n    \n\n    \n\n      \nMMM\n\n      \n92.35%\n\n    \n\n    \n\n      \nCERN\n\n      \n84.47%\n\n    \n\n    \n\n      \nDELL\n\n      \n72.76%\n\n    \n\n    \n\n      \nAMD\n\n      \n71.05%\n\n    \n\n    \n\n      \nINTC\n\n      \n69.19%\n\n    \n\n    \n\n      \nGPS\n\n      \n62.11%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n  \n\n    \n\n      \nTop 10 short positions of all time\n\n      \nmax\n\n    \n\n  \n\n  \n\n  \n\n\n\n\n\n\n\n\n\n\n  \n\n    \n\n      \nTop 10 positions of all time\n\n      \nmax\n\n    \n\n  \n\n  \n\n    \n\n      \nCOST\n\n      \n100.74%\n\n    \n\n    \n\n      \nMMM\n\n      \n92.35%\n\n    \n\n    \n\n      \nCERN\n\n      \n84.47%\n\n    \n\n    \n\n      \nDELL\n\n      \n72.76%\n\n    \n\n    \n\n      \nAMD\n\n      \n71.05%\n\n    \n\n    \n\n      \nINTC\n\n      \n69.19%\n\n    \n\n    \n\n      \nGPS\n\n      \n62.11%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n  \n\n    \n\n      \nAll positions ever held\n\n      \nmax\n\n    \n\n  \n\n  \n\n    \n\n      \nCOST\n\n      \n100.74%\n\n    \n\n    \n\n      \nMMM\n\n      \n92.35%\n\n    \n\n    \n\n      \nCERN\n\n      \n84.47%\n\n    \n\n    \n\n      \nDELL\n\n      \n72.76%\n\n    \n\n    \n\n      \nAMD\n\n      \n71.05%\n\n    \n\n    \n\n      \nINTC\n\n      \n69.19%\n\n    \n\n    \n\n      \nGPS\n\n      \n62.11%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n\n    \n\n      \nSummary stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nTotal number of round_trips\n\n      \n3986.00\n\n      \n3.00\n\n      \n3983.00\n\n    \n\n    \n\n      \nPercent profitable\n\n      \n0.49\n\n      \n0.33\n\n      \n0.49\n\n    \n\n    \n\n      \nWinning round_trips\n\n      \n1938.00\n\n      \n1.00\n\n      \n1937.00\n\n    \n\n    \n\n      \nLosing round_trips\n\n      \n2039.00\n\n      \n0.00\n\n      \n2039.00\n\n    \n\n    \n\n      \nEven round_trips\n\n      \n9.00\n\n      \n2.00\n\n      \n7.00\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n  \n\n    \n\n      \nPnL stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nTotal profit\n\n      \n$6118150.70\n\n      \n$0.00\n\n      \n$6118150.70\n\n    \n\n    \n\n      \nGross profit\n\n      \n$37872903.48\n\n      \n$0.00\n\n      \n$37872903.48\n\n    \n\n    \n\n      \nGross loss\n\n      \n$-31754752.78\n\n      \n$0.00\n\n      \n$-31754752.78\n\n    \n\n    \n\n      \nProfit factor\n\n      \n$1.19\n\n      \n$nan\n\n      \n$1.19\n\n    \n\n    \n\n      \nAvg. trade net profit\n\n      \n$1534.91\n\n      \n$0.00\n\n      \n$1536.07\n\n    \n\n    \n\n      \nAvg. winning trade\n\n      \n$19542.26\n\n      \n$0.00\n\n      \n$19552.35\n\n    \n\n    \n\n      \nAvg. losing trade\n\n      \n$-15573.69\n\n      \n$nan\n\n      \n$-15573.69\n\n    \n\n    \n\n      \nRatio Avg. Win:Avg. Loss\n\n      \n$1.25\n\n      \n$nan\n\n      \n$1.26\n\n    \n\n    \n\n      \nLargest winning trade\n\n      \n$1553000.44\n\n      \n$0.00\n\n      \n$1553000.44\n\n    \n\n    \n\n      \nLargest losing trade\n\n      \n$-1251993.38\n\n      \n$0.00\n\n      \n$-1251993.38\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n  \n\n    \n\n      \nDuration stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nAvg duration\n\n      \n21 days 18:52:41.966884\n\n      \n20:59:59\n\n      \n21 days 19:15:22.822746\n\n    \n\n    \n\n      \nMedian duration\n\n      \n17 days 23:00:00\n\n      \n20:59:59\n\n      \n18 days 00:00:00\n\n    \n\n    \n\n      \nLongest duration\n\n      \n109 days 01:00:00\n\n      \n20:59:59\n\n      \n109 days 01:00:00\n\n    \n\n    \n\n      \nShortest duration\n\n      \n0 days 03:00:01\n\n      \n20:59:59\n\n      \n0 days 03:00:01\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n  \n\n    \n\n      \nReturn stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nAvg returns all round_trips\n\n      \n0.01%\n\n      \n0.00%\n\n      \n0.01%\n\n    \n\n    \n\n      \nAvg returns winning\n\n      \n0.16%\n\n      \n0.00%\n\n      \n0.16%\n\n    \n\n    \n\n      \nAvg returns losing\n\n      \n-0.13%\n\n      \nnan%\n\n      \n-0.13%\n\n    \n\n    \n\n      \nMedian returns all round_trips\n\n      \n-0.00%\n\n      \n0.00%\n\n      \n-0.00%\n\n    \n\n    \n\n      \nMedian returns winning\n\n      \n0.02%\n\n      \n0.00%\n\n      \n0.02%\n\n    \n\n    \n\n      \nMedian returns losing\n\n      \n-0.01%\n\n      \nnan%\n\n      \n-0.01%\n\n    \n\n    \n\n      \nLargest winning trade\n\n      \n12.13%\n\n      \n0.00%\n\n      \n12.13%\n\n    \n\n    \n\n      \nLargest losing trade\n\n      \n-9.14%\n\n      \n0.00%\n\n      \n-9.14%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n  \n\n    \n\n      \nSymbol stats\n\n      \nCERN\n\n      \nCOST\n\n      \nGPS\n\n      \nINTC\n\n      \nMMM\n\n      \nAMD\n\n      \nDELL\n\n    \n\n  \n\n  \n\n    \n\n      \nAvg returns all round_trips\n\n      \n0.03%\n\n      \n0.03%\n\n      \n-0.01%\n\n      \n0.04%\n\n      \n0.01%\n\n      \n-0.00%\n\n      \n-0.03%\n\n    \n\n    \n\n      \nAvg returns winning\n\n      \n0.19%\n\n      \n0.12%\n\n      \n0.13%\n\n      \n0.15%\n\n      \n0.10%\n\n      \n0.36%\n\n      \n0.13%\n\n    \n\n    \n\n      \nAvg returns losing\n\n      \n-0.16%\n\n      \n-0.06%\n\n      \n-0.11%\n\n      \n-0.06%\n\n      \n-0.08%\n\n      \n-0.34%\n\n      \n-0.19%\n\n    \n\n    \n\n      \nMedian returns all round_trips\n\n      \n0.00%\n\n      \n0.00%\n\n      \n-0.00%\n\n      \n-0.00%\n\n      \n-0.00%\n\n      \n-0.00%\n\n      \n-0.00%\n\n    \n\n    \n\n      \nMedian returns winning\n\n      \n0.02%\n\n      \n0.01%\n\n      \n0.02%\n\n      \n0.03%\n\n      \n0.01%\n\n      \n0.07%\n\n      \n0.01%\n\n    \n\n    \n\n      \nMedian returns losing\n\n      \n-0.01%\n\n      \n-0.01%\n\n      \n-0.01%\n\n      \n-0.00%\n\n      \n-0.01%\n\n      \n-0.02%\n\n      \n-0.01%\n\n    \n\n    \n\n      \nLargest winning trade\n\n      \n5.94%\n\n      \n2.95%\n\n      \n3.54%\n\n      \n2.33%\n\n      \n2.22%\n\n      \n12.13%\n\n      \n3.36%\n\n    \n\n    \n\n      \nLargest losing trade\n\n      \n-4.67%\n\n      \n-3.47%\n\n      \n-8.30%\n\n      \n-4.60%\n\n      \n-4.02%\n\n      \n-9.14%\n\n      \n-6.60%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n  \n\n    \n\n      \nProfitability (PnL / PnL total) per name\n\n      \n\n    \n\n  \n\n  \n\n    \n\n      \nINTC\n\n      \n45.09%\n\n    \n\n    \n\n      \nCOST\n\n      \n42.42%\n\n    \n\n    \n\n      \nCERN\n\n      \n35.52%\n\n    \n\n    \n\n      \nMMM\n\n      \n13.51%\n\n    \n\n    \n\n      \nGPS\n\n      \n-2.49%\n\n    \n\n    \n\n      \nAMD\n\n      \n-7.15%\n\n    \n\n    \n\n      \nDELL\n\n      \n-26.91%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\nSuppressing symbol output\n\n\nWhen sharing tear sheets it might be undesirable to display which symbols where used by a strategy. To suppress these in the tear sheet you can pass \nhide_positions=True\n.\n\n\npf.create_full_tear_sheet(returns, positions=positions, transactions=transactions,\n                          live_start_date='2009-10-22', hide_positions=True)\n\n\n\n\nEntire data start date: 2004-01-02\nEntire data end date: 2009-12-31\nIn-sample months: 69\nOut-of-sample months: 2\n\n\n\n\n\n\n  \n\n    \n\n      \n\n      \nAll\n\n      \nIn-sample\n\n      \nOut-of-sample\n\n    \n\n  \n\n  \n\n    \n\n      \nAnnual return\n\n      \n8.3%\n\n      \n8.1%\n\n      \n14.9%\n\n    \n\n    \n\n      \nCumulative returns\n\n      \n61.1%\n\n      \n56.8%\n\n      \n2.7%\n\n    \n\n    \n\n      \nAnnual volatility\n\n      \n25.6%\n\n      \n25.7%\n\n      \n22.0%\n\n    \n\n    \n\n      \nSharpe ratio\n\n      \n0.44\n\n      \n0.43\n\n      \n0.74\n\n    \n\n    \n\n      \nCalmar ratio\n\n      \n0.14\n\n      \n0.13\n\n      \n2.03\n\n    \n\n    \n\n      \nStability\n\n      \n0.00\n\n      \n0.01\n\n      \n0.04\n\n    \n\n    \n\n      \nMax drawdown\n\n      \n-60.3%\n\n      \n-60.3%\n\n      \n-7.3%\n\n    \n\n    \n\n      \nOmega ratio\n\n      \n1.08\n\n      \n1.08\n\n      \n1.13\n\n    \n\n    \n\n      \nSortino ratio\n\n      \n0.64\n\n      \n0.63\n\n      \n1.04\n\n    \n\n    \n\n      \nSkew\n\n      \n0.21\n\n      \n0.22\n\n      \n-0.29\n\n    \n\n    \n\n      \nKurtosis\n\n      \n4.19\n\n      \n4.24\n\n      \n0.36\n\n    \n\n    \n\n      \nTail ratio\n\n      \n0.97\n\n      \n0.99\n\n      \n1.23\n\n    \n\n    \n\n      \nDaily value at risk\n\n      \n-3.2%\n\n      \n-3.2%\n\n      \n-2.7%\n\n    \n\n    \n\n      \nGross leverage\n\n      \n1.00\n\n      \n1.00\n\n      \n1.00\n\n    \n\n    \n\n      \nDaily turnover\n\n      \n7.6%\n\n      \n7.5%\n\n      \n9.6%\n\n    \n\n    \n\n      \nAlpha\n\n      \n0.09\n\n      \n0.10\n\n      \n-0.03\n\n    \n\n    \n\n      \nBeta\n\n      \n0.83\n\n      \n0.82\n\n      \n1.19\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n  \n\n    \n\n      \nWorst drawdown periods\n\n      \nNet drawdown in %\n\n      \nPeak date\n\n      \nValley date\n\n      \nRecovery date\n\n      \nDuration\n\n    \n\n  \n\n  \n\n    \n\n      \n0\n\n      \n60.30\n\n      \n2007-11-06\n\n      \n2008-11-20\n\n      \nNaT\n\n      \nNaN\n\n    \n\n    \n\n      \n1\n\n      \n23.25\n\n      \n2006-04-06\n\n      \n2006-09-07\n\n      \n2007-05-22\n\n      \n294\n\n    \n\n    \n\n      \n2\n\n      \n12.52\n\n      \n2004-11-15\n\n      \n2005-10-12\n\n      \n2006-01-11\n\n      \n303\n\n    \n\n    \n\n      \n3\n\n      \n10.90\n\n      \n2004-06-25\n\n      \n2004-08-12\n\n      \n2004-11-04\n\n      \n95\n\n    \n\n    \n\n      \n4\n\n      \n9.47\n\n      \n2007-07-16\n\n      \n2007-08-06\n\n      \n2007-09-04\n\n      \n37\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n\n\n  \n\n    \n\n      \nStress Events\n\n      \nmean\n\n      \nmin\n\n      \nmax\n\n    \n\n  \n\n  \n\n    \n\n      \nLehmann\n\n      \n-0.28%\n\n      \n-7.41%\n\n      \n4.40%\n\n    \n\n    \n\n      \nAug07\n\n      \n0.35%\n\n      \n-2.96%\n\n      \n3.03%\n\n    \n\n    \n\n      \nMar08\n\n      \n-0.43%\n\n      \n-3.10%\n\n      \n3.34%\n\n    \n\n    \n\n      \nSept08\n\n      \n-0.68%\n\n      \n-7.41%\n\n      \n3.99%\n\n    \n\n    \n\n      \n2009Q1\n\n      \n-0.35%\n\n      \n-4.98%\n\n      \n3.36%\n\n    \n\n    \n\n      \n2009Q2\n\n      \n0.71%\n\n      \n-3.78%\n\n      \n6.17%\n\n    \n\n    \n\n      \nLow Volatility Bull Market\n\n      \n0.01%\n\n      \n-6.11%\n\n      \n6.45%\n\n    \n\n    \n\n      \nGFC Crash\n\n      \n-0.08%\n\n      \n-7.58%\n\n      \n9.71%\n\n    \n\n    \n\n      \nRecovery\n\n      \n0.32%\n\n      \n-3.78%\n\n      \n6.17%",
            "title": "Zipline algorithm"
        },
        {
            "location": "/notebooks/zipline_algo_example/#zipline-algorithm-analysis-example-in-pyfolio",
            "text": "Here's an example where we run an algorithm with zipline, then produce tear sheets for that algorithm.",
            "title": "Zipline algorithm analysis example in pyfolio"
        },
        {
            "location": "/notebooks/zipline_algo_example/#imports",
            "text": "Import pyfolio and zipline, and ingest the pricing data for backtesting.  import sys\nsys.path.append('/Users/george/Desktop/pyfolio/')  import pyfolio as pf\n%matplotlib inline\n\n# silence warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport zipline\n%load_ext zipline\n!zipline ingest  \u001b[?25lDownloading Bundle: quantopian-quandl  [------------------------------------]    0%",
            "title": "Imports"
        },
        {
            "location": "/notebooks/zipline_algo_example/#run-our-zipline-algorithm",
            "text": "This algorithm can also be adjusted to execute a modified, or completely different, trading strategy.  %%zipline --start 2004-1-1 --end 2010-1-1 -o results.pickle\n\n# Zipline trading algorithm\n# Taken from zipline.examples.olmar\n\nimport numpy as np\n\nfrom zipline.finance import commission, slippage\n\nSTOCKS = ['AMD', 'CERN', 'COST', 'DELL', 'GPS', 'INTC', 'MMM']\n\n\n# On-Line Portfolio Moving Average Reversion\n\n# More info can be found in the corresponding paper:\n# http://icml.cc/2012/papers/168.pdf\ndef initialize(algo, eps=1, window_length=5):\n    algo.stocks = STOCKS\n    algo.sids = [algo.symbol(symbol) for symbol in algo.stocks]\n    algo.m = len(algo.stocks)\n    algo.price = {}\n    algo.b_t = np.ones(algo.m) / algo.m\n    algo.eps = eps\n    algo.window_length = window_length\n\n    algo.set_commission(commission.PerShare(cost=0))\n    algo.set_slippage(slippage.FixedSlippage(spread=0))\n\n\ndef handle_data(algo, data):\n    m = algo.m\n\n    x_tilde = np.zeros(m)\n    b = np.zeros(m)\n\n    # find relative moving average price for each asset\n    mavgs = data.history(algo.sids, 'price', algo.window_length, '1d').mean()\n    for i, sid in enumerate(algo.sids):\n        price = data.current(sid, \"price\")\n        # Relative mean deviation\n        x_tilde[i] = mavgs[sid] / price\n\n    ###########################\n    # Inside of OLMAR (algo 2)\n    x_bar = x_tilde.mean()\n\n    # market relative deviation\n    mark_rel_dev = x_tilde - x_bar\n\n    # Expected return with current portfolio\n    exp_return = np.dot(algo.b_t, x_tilde)\n    weight = algo.eps - exp_return\n    variability = (np.linalg.norm(mark_rel_dev)) ** 2\n\n    # test for divide-by-zero case\n    if variability == 0.0:\n        step_size = 0\n    else:\n        step_size = max(0, weight / variability)\n\n    b = algo.b_t + step_size * mark_rel_dev\n    b_norm = simplex_projection(b)\n    np.testing.assert_almost_equal(b_norm.sum(), 1)\n\n    rebalance_portfolio(algo, data, b_norm)\n\n    # update portfolio\n    algo.b_t = b_norm\n\n\ndef rebalance_portfolio(algo, data, desired_port):\n    # rebalance portfolio\n    for i, sid in enumerate(algo.sids):\n        algo.order_target_percent(sid, desired_port[i])\n\n\ndef simplex_projection(v, b=1):\n    \"\"\"Projection vectors to the simplex domain\n    Implemented according to the paper: Efficient projections onto the\n    l1-ball for learning in high dimensions, John Duchi, et al. ICML 2008.\n    Implementation Time: 2011 June 17 by Bin@libin AT pmail.ntu.edu.sg\n    Optimization Problem: min_{w}\\| w - v \\|_{2}^{2}\n    s.t. sum_{i=1}^{m}=z, w_{i}\\geq 0\n    Input: A vector v \\in R^{m}, and a scalar z > 0 (default=1)\n    Output: Projection vector w\n    :Example:\n    >>> proj = simplex_projection([.4 ,.3, -.4, .5])\n    >>> print(proj)\n    array([ 0.33333333, 0.23333333, 0. , 0.43333333])\n    >>> print(proj.sum())\n    1.0\n    Original matlab implementation: John Duchi (jduchi@cs.berkeley.edu)\n    Python-port: Copyright 2013 by Thomas Wiecki (thomas.wiecki@gmail.com).\n    \"\"\"\n\n    v = np.asarray(v)\n    p = len(v)\n\n    # Sort v into u in descending order\n    v = (v > 0) * v\n    u = np.sort(v)[::-1]\n    sv = np.cumsum(u)\n\n    rho = np.where(u > (sv - b) / np.arange(1, p + 1))[0][-1]\n    theta = np.max([0, (sv[rho] - b) / (rho + 1)])\n    w = (v - theta)\n    w[w < 0] = 0\n    return w   \n   \n     \n       \n       algo_volatility \n       algorithm_period_return \n       alpha \n       benchmark_period_return \n       benchmark_volatility \n       beta \n       capital_used \n       ending_cash \n       ending_exposure \n       ending_value \n       ... \n       short_exposure \n       short_value \n       shorts_count \n       sortino \n       starting_cash \n       starting_exposure \n       starting_value \n       trading_days \n       transactions \n       treasury_period_return \n     \n   \n   \n     \n       2004-01-02 21:00:00+00:00 \n       NaN \n       0.000000e+00 \n       NaN \n       -0.000449 \n       NaN \n       NaN \n       0.000000e+00 \n       1.000000e+07 \n       0.00 \n       0.00 \n       ... \n       0 \n       0 \n       0 \n       NaN \n       1.000000e+07 \n       0.00 \n       0.00 \n       1 \n       [] \n       0.0438 \n     \n     \n       2004-01-05 21:00:00+00:00 \n       0.000008 \n       -7.000000e-07 \n       -0.000007 \n       0.010424 \n       0.127153 \n       -0.000062 \n       -1.012625e+07 \n       -1.262475e+05 \n       10126240.51 \n       10126240.51 \n       ... \n       0 \n       0 \n       0 \n       -11.224972 \n       1.000000e+07 \n       0.00 \n       0.00 \n       2 \n       [{u'commission': None, u'amount': 39332, u'sid... \n       0.0441 \n     \n     \n       2004-01-06 21:00:00+00:00 \n       0.072177 \n       7.874142e-03 \n       0.941443 \n       0.011413 \n       0.097935 \n       -0.292225 \n       1.098407e+05 \n       -1.640676e+04 \n       10095148.18 \n       10095148.18 \n       ... \n       0 \n       0 \n       0 \n       103096.791454 \n       -1.262475e+05 \n       10126240.51 \n       10126240.51 \n       3 \n       [{u'commission': None, u'amount': 22673, u'sid... \n       0.0429 \n     \n     \n       2004-01-07 21:00:00+00:00 \n       0.064694 \n       1.390826e-02 \n       1.158059 \n       0.014827 \n       0.080035 \n       -0.305795 \n       3.809134e+04 \n       2.168458e+04 \n       10117398.03 \n       10117398.03 \n       ... \n       0 \n       0 \n       0 \n       157170.375195 \n       -1.640676e+04 \n       10095148.18 \n       10095148.18 \n       4 \n       [{u'commission': None, u'amount': 4882, u'sid'... \n       0.0427 \n     \n     \n       2004-01-08 21:00:00+00:00 \n       0.202046 \n       -1.030250e-02 \n       -0.137563 \n       0.018871 \n       0.069343 \n       -0.388318 \n       1.594916e+04 \n       3.763374e+04 \n       9859341.24 \n       9859341.24 \n       ... \n       0 \n       0 \n       0 \n       -2.978283 \n       2.168458e+04 \n       10117398.03 \n       10117398.03 \n       5 \n       [{u'commission': None, u'amount': 7020, u'sid'... \n       0.0427 \n     \n     \n       2004-01-09 21:00:00+00:00 \n       0.181404 \n       -9.874269e-03 \n       -0.290170 \n       0.009975 \n       0.101951 \n       -0.266625 \n       -3.549779e+04 \n       2.135950e+03 \n       9899121.36 \n       9899121.36 \n       ... \n       0 \n       0 \n       0 \n       -2.601355 \n       3.763374e+04 \n       9859341.24 \n       9859341.24 \n       6 \n       [{u'commission': None, u'amount': 12007, u'sid... \n       0.0411 \n     \n     \n       2004-01-12 21:00:00+00:00 \n       0.169355 \n       -5.602480e-03 \n       -0.118894 \n       0.017344 \n       0.098995 \n       -0.113533 \n       -3.387390e+03 \n       -1.251440e+03 \n       9945226.64 \n       9945226.64 \n       ... \n       0 \n       0 \n       0 \n       -1.324308 \n       2.135950e+03 \n       9899121.36 \n       9899121.36 \n       7 \n       [{u'commission': None, u'amount': 879, u'sid':... \n       0.0411 \n     \n     \n       2004-01-13 21:00:00+00:00 \n       0.162138 \n       -1.366743e-02 \n       -0.454475 \n       0.011503 \n       0.102602 \n       0.090323 \n       -5.892000e+02 \n       -1.840640e+03 \n       9865166.35 \n       9865166.35 \n       ... \n       0 \n       0 \n       0 \n       -2.977973 \n       -1.251440e+03 \n       9945226.64 \n       9945226.64 \n       8 \n       [{u'commission': None, u'amount': 478, u'sid':... \n       0.0405 \n     \n     \n       2004-01-14 21:00:00+00:00 \n       0.156543 \n       -8.090471e-03 \n       -0.338686 \n       0.020219 \n       0.103200 \n       0.216209 \n       2.099000e+02 \n       -1.630740e+03 \n       9920726.03 \n       9920726.03 \n       ... \n       0 \n       0 \n       0 \n       -1.621248 \n       -1.840640e+03 \n       9865166.35 \n       9865166.35 \n       9 \n       [{u'commission': None, u'amount': -958, u'sid'... \n       0.0401 \n     \n     \n       2004-01-15 21:00:00+00:00 \n       0.147732 \n       -1.021672e-02 \n       -0.370917 \n       0.022466 \n       0.097298 \n       0.216356 \n       -2.985980e+03 \n       -4.616720e+03 \n       9902449.48 \n       9902449.48 \n       ... \n       0 \n       0 \n       0 \n       -1.957694 \n       -1.630740e+03 \n       9920726.03 \n       9920726.03 \n       10 \n       [{u'commission': None, u'amount': -12547, u'si... \n       0.0399 \n     \n     \n       2004-01-16 21:00:00+00:00 \n       0.150072 \n       -9.720000e-05 \n       -0.152516 \n       0.026510 \n       0.092669 \n       0.265920 \n       4.211040e+03 \n       -4.056800e+02 \n       9999433.68 \n       9999433.68 \n       ... \n       0 \n       0 \n       0 \n       0.066906 \n       -4.616720e+03 \n       9902449.48 \n       9902449.48 \n       11 \n       [{u'commission': None, u'amount': 29, u'sid': ... \n       0.0404 \n     \n     \n       2004-01-20 21:00:00+00:00 \n       0.174603 \n       -2.189795e-02 \n       -0.677508 \n       0.026240 \n       0.089193 \n       0.414247 \n       -6.349190e+03 \n       -6.754870e+03 \n       9787775.37 \n       9787775.37 \n       ... \n       0 \n       0 \n       0 \n       -2.942390 \n       -4.056800e+02 \n       9999433.68 \n       9999433.68 \n       12 \n       [{u'commission': None, u'amount': -8204, u'sid... \n       0.0408 \n     \n     \n       2004-01-21 21:00:00+00:00 \n       0.167345 \n       -2.194580e-02 \n       -0.682346 \n       0.033879 \n       0.088489 \n       0.408461 \n       3.967860e+03 \n       -2.787010e+03 \n       9783328.99 \n       9783328.99 \n       ... \n       0 \n       0 \n       0 \n       -2.833401 \n       -6.754870e+03 \n       9787775.37 \n       9787775.37 \n       13 \n       [{u'commission': None, u'amount': 18, u'sid': ... \n       0.0405 \n     \n     \n       2004-01-22 21:00:00+00:00 \n       0.160815 \n       -2.278829e-02 \n       -0.620203 \n       0.031991 \n       0.087048 \n       0.381335 \n       3.202510e+03 \n       4.155000e+02 \n       9771701.58 \n       9771701.58 \n       ... \n       0 \n       0 \n       0 \n       -2.838791 \n       -2.787010e+03 \n       9783328.99 \n       9783328.99 \n       14 \n       [{u'commission': None, u'amount': 1177, u'sid'... \n       0.0399 \n     \n     \n       2004-01-23 21:00:00+00:00 \n       0.156057 \n       -1.995549e-02 \n       -0.466320 \n       0.028307 \n       0.087226 \n       0.294719 \n       -5.584200e+02 \n       -1.429200e+02 \n       9800588.06 \n       9800588.06 \n       ... \n       0 \n       0 \n       0 \n       -2.386967 \n       4.155000e+02 \n       9771701.58 \n       9771701.58 \n       15 \n       [{u'commission': None, u'amount': -1437, u'sid... \n       0.0409 \n     \n     \n       2004-01-26 21:00:00+00:00 \n       0.151899 \n       -1.665361e-02 \n       -0.460877 \n       0.041247 \n       0.094376 \n       0.323325 \n       -5.684500e+02 \n       -7.113700e+02 \n       9834175.24 \n       9834175.24 \n       ... \n       0 \n       0 \n       0 \n       -1.911049 \n       -1.429200e+02 \n       9800588.06 \n       9800588.06 \n       16 \n       [{u'commission': None, u'amount': 1760, u'sid'... \n       0.0416 \n     \n     \n       2004-01-27 21:00:00+00:00 \n       0.149383 \n       -2.432286e-02 \n       -0.521233 \n       0.030554 \n       0.103850 \n       0.369999 \n       4.884130e+03 \n       4.172760e+03 \n       9752598.61 \n       9752598.61 \n       ... \n       0 \n       0 \n       0 \n       -2.680537 \n       -7.113700e+02 \n       9834175.24 \n       9834175.24 \n       17 \n       [{u'commission': None, u'amount': 27757, u'sid... \n       0.0411 \n     \n     \n       2004-01-28 21:00:00+00:00 \n       0.159088 \n       -4.280630e-02 \n       -0.745407 \n       0.018422 \n       0.112811 \n       0.556821 \n       -3.171400e+03 \n       1.001360e+03 \n       9570935.67 \n       9570935.67 \n       ... \n       0 \n       0 \n       0 \n       -4.088941 \n       4.172760e+03 \n       9752598.61 \n       9752598.61 \n       18 \n       [{u'commission': None, u'amount': 3192, u'sid'... \n       0.0422 \n     \n     \n       2004-01-29 21:00:00+00:00 \n       0.154753 \n       -4.330959e-02 \n       -0.723066 \n       0.019770 \n       0.109637 \n       0.557354 \n       -1.023840e+03 \n       -2.248000e+01 \n       9566926.58 \n       9566926.58 \n       ... \n       0 \n       0 \n       0 \n       -4.028374 \n       1.001360e+03 \n       9570935.67 \n       9570935.67 \n       19 \n       [{u'commission': None, u'amount': 740, u'sid':... \n       0.0422 \n     \n     \n       2004-01-30 21:00:00+00:00 \n       0.151981 \n       -4.003614e-02 \n       -0.641952 \n       0.019770 \n       0.106778 \n       0.550030 \n       -3.302200e+02 \n       -3.527000e+02 \n       9599991.28 \n       9599991.28 \n       ... \n       0 \n       0 \n       0 \n       -3.616538 \n       -2.248000e+01 \n       9566926.58 \n       9566926.58 \n       20 \n       [{u'commission': None, u'amount': 202, u'sid':... \n       0.0416 \n     \n     \n       2004-02-02 21:00:00+00:00 \n       0.148849 \n       -3.791101e-02 \n       -0.611549 \n       0.023544 \n       0.104494 \n       0.558118 \n       7.507400e+02 \n       3.980400e+02 \n       9620491.88 \n       9620491.88 \n       ... \n       0 \n       0 \n       0 \n       -3.333751 \n       -3.527000e+02 \n       9599991.28 \n       9599991.28 \n       21 \n       [{u'commission': None, u'amount': -774, u'sid'... \n       0.0418 \n     \n     \n       2004-02-03 21:00:00+00:00 \n       0.149505 \n       -2.958549e-02 \n       -0.470647 \n       0.022466 \n       0.102243 \n       0.530207 \n       -3.759100e+02 \n       2.213000e+01 \n       9704122.98 \n       9704122.98 \n       ... \n       0 \n       0 \n       0 \n       -2.509972 \n       3.980400e+02 \n       9620491.88 \n       9620491.88 \n       22 \n       [{u'commission': None, u'amount': -1805, u'sid... \n       0.0413 \n     \n     \n       2004-02-04 21:00:00+00:00 \n       0.148908 \n       -3.935433e-02 \n       -0.518102 \n       0.014019 \n       0.104520 \n       0.565794 \n       2.243250e+04 \n       2.245463e+04 \n       9584002.02 \n       9584002.02 \n       ... \n       0 \n       0 \n       0 \n       -3.200968 \n       2.213000e+01 \n       9704122.98 \n       9704122.98 \n       23 \n       [{u'commission': None, u'amount': -115293, u's... \n       0.0415 \n     \n     \n       2004-02-05 21:00:00+00:00 \n       0.157685 \n       -2.306599e-02 \n       -0.343928 \n       0.017074 \n       0.102515 \n       0.607067 \n       -2.537802e+04 \n       -2.923390e+03 \n       9772263.47 \n       9772263.47 \n       ... \n       0 \n       0 \n       0 \n       -1.776034 \n       2.245463e+04 \n       9584002.02 \n       9584002.02 \n       24 \n       [{u'commission': None, u'amount': 28, u'sid': ... \n       0.0420 \n     \n     \n       2004-02-06 21:00:00+00:00 \n       0.169544 \n       -2.392913e-03 \n       -0.228447 \n       0.028487 \n       0.105744 \n       0.755742 \n       -7.073620e+03 \n       -9.997010e+03 \n       9986067.88 \n       9986067.88 \n       ... \n       0 \n       0 \n       0 \n       -0.080130 \n       -2.923390e+03 \n       9772263.47 \n       9772263.47 \n       25 \n       [{u'commission': None, u'amount': -5231, u'sid... \n       0.0412 \n     \n     \n       2004-02-09 21:00:00+00:00 \n       0.166124 \n       -2.006309e-03 \n       -0.220937 \n       0.029206 \n       0.103617 \n       0.755433 \n       4.991920e+03 \n       -5.005090e+03 \n       9984942.00 \n       9984942.00 \n       ... \n       0 \n       0 \n       0 \n       -0.048764 \n       -9.997010e+03 \n       9986067.88 \n       9986067.88 \n       26 \n       [{u'commission': None, u'amount': 3350, u'sid'... \n       0.0409 \n     \n     \n       2004-02-10 21:00:00+00:00 \n       0.179042 \n       2.224008e-02 \n       -0.016088 \n       0.032081 \n       0.101732 \n       0.790076 \n       3.909423e+04 \n       3.408914e+04 \n       10188311.63 \n       10188311.63 \n       ... \n       0 \n       0 \n       0 \n       1.786071 \n       -5.005090e+03 \n       9984942.00 \n       9984942.00 \n       27 \n       [{u'commission': None, u'amount': 20374, u'sid... \n       0.0413 \n     \n     \n       2004-02-11 21:00:00+00:00 \n       0.175854 \n       2.568422e-02 \n       -0.045677 \n       0.043045 \n       0.103763 \n       0.750971 \n       -9.027760e+04 \n       -5.618846e+04 \n       10313030.69 \n       10313030.69 \n       ... \n       0 \n       0 \n       0 \n       2.003630 \n       3.408914e+04 \n       10188311.63 \n       10188311.63 \n       28 \n       [{u'commission': None, u'amount': 86138, u'sid... \n       0.0405 \n     \n     \n       2004-02-12 21:00:00+00:00 \n       0.174331 \n       1.835900e-02 \n       -0.088628 \n       0.039270 \n       0.103016 \n       0.768848 \n       6.841798e+04 \n       1.222952e+04 \n       10171360.46 \n       10171360.46 \n       ... \n       0 \n       0 \n       0 \n       1.426563 \n       -5.618846e+04 \n       10313030.69 \n       10313030.69 \n       29 \n       [{u'commission': None, u'amount': 60959, u'sid... \n       0.0410 \n     \n     \n       2004-02-13 21:00:00+00:00 \n       0.174263 \n       7.811894e-03 \n       -0.152515 \n       0.034597 \n       0.102633 \n       0.799374 \n       -8.834620e+03 \n       3.394900e+03 \n       10074724.04 \n       10074724.04 \n       ... \n       0 \n       0 \n       0 \n       0.651812 \n       1.222952e+04 \n       10171360.46 \n       10171360.46 \n       30 \n       [{u'commission': None, u'amount': -2990, u'sid... \n       0.0405 \n     \n     \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n       ... \n     \n     \n       2009-11-18 21:00:00+00:00 \n       0.257581 \n       6.008698e-01 \n       0.099259 \n       -0.000090 \n       0.683428 \n       0.080995 \n       -2.965000e+02 \n       -1.613460e+02 \n       16008859.05 \n       16008859.05 \n       ... \n       0 \n       0 \n       0 \n       0.642225 \n       1.351540e+02 \n       16099119.48 \n       16099119.48 \n       1482 \n       [{u'commission': None, u'amount': 126, u'sid':... \n       0.0336 \n     \n     \n       2009-11-19 21:00:00+00:00 \n       0.257584 \n       5.751349e-01 \n       0.096627 \n       -0.013120 \n       0.683220 \n       0.081072 \n       6.384500e+02 \n       4.771040e+02 \n       15750871.82 \n       15750871.82 \n       ... \n       0 \n       0 \n       0 \n       0.626050 \n       -1.613460e+02 \n       16008859.05 \n       16008859.05 \n       1483 \n       [{u'commission': None, u'amount': -2169, u'sid... \n       0.0335 \n     \n     \n       2009-11-20 21:00:00+00:00 \n       0.257497 \n       5.760543e-01 \n       0.096710 \n       -0.016625 \n       0.682992 \n       0.081071 \n       -9.618800e+02 \n       -4.847760e+02 \n       15761027.55 \n       15761027.55 \n       ... \n       0 \n       0 \n       0 \n       0.626402 \n       4.771040e+02 \n       15750871.82 \n       15750871.82 \n       1484 \n       [{u'commission': None, u'amount': 1554, u'sid'... \n       0.0336 \n     \n     \n       2009-11-23 21:00:00+00:00 \n       0.257412 \n       5.801855e-01 \n       0.096914 \n       -0.004134 \n       0.682780 \n       0.081077 \n       2.498000e+01 \n       -4.597960e+02 \n       15802314.57 \n       15802314.57 \n       ... \n       0 \n       0 \n       0 \n       0.628718 \n       -4.847760e+02 \n       15761027.55 \n       15761027.55 \n       1485 \n       [{u'commission': None, u'amount': -1472, u'sid... \n       0.0337 \n     \n     \n       2009-11-24 21:00:00+00:00 \n       0.257339 \n       5.910314e-01 \n       0.097991 \n       -0.002606 \n       0.682550 \n       0.081079 \n       -7.668800e+02 \n       -1.226676e+03 \n       15911540.99 \n       15911540.99 \n       ... \n       0 \n       0 \n       0 \n       0.635119 \n       -4.597960e+02 \n       15802314.57 \n       15802314.57 \n       1486 \n       [{u'commission': None, u'amount': 3775, u'sid'... \n       0.0332 \n     \n     \n       2009-11-25 21:00:00+00:00 \n       0.257277 \n       6.056737e-01 \n       0.099435 \n       0.000899 \n       0.682322 \n       0.081087 \n       7.561600e+02 \n       -4.705160e+02 \n       16057207.89 \n       16057207.89 \n       ... \n       0 \n       0 \n       0 \n       0.643769 \n       -1.226676e+03 \n       15911540.99 \n       15911540.99 \n       1487 \n       [{u'commission': None, u'amount': -18139, u'si... \n       0.0328 \n     \n     \n       2009-11-27 18:00:00+00:00 \n       0.257296 \n       5.777323e-01 \n       0.096627 \n       -0.015367 \n       0.682128 \n       0.081189 \n       -9.221030e+03 \n       -9.691546e+03 \n       15787014.39 \n       15787014.39 \n       ... \n       0 \n       0 \n       0 \n       0.626279 \n       -4.705160e+02 \n       16057207.89 \n       16057207.89 \n       1488 \n       [{u'commission': None, u'amount': -108386, u's... \n       0.0321 \n     \n     \n       2009-11-30 21:00:00+00:00 \n       0.257262 \n       5.583863e-01 \n       0.094443 \n       -0.012042 \n       0.681899 \n       0.081176 \n       9.661970e+03 \n       -2.957600e+01 \n       15583892.62 \n       15583892.62 \n       ... \n       0 \n       0 \n       0 \n       0.614025 \n       -9.691546e+03 \n       15787014.39 \n       15787014.39 \n       1489 \n       [{u'commission': None, u'amount': -2, u'sid': ... \n       0.0321 \n     \n     \n       2009-12-01 21:00:00+00:00 \n       0.257202 \n       5.728593e-01 \n       0.095775 \n       0.000180 \n       0.681687 \n       0.081210 \n       -2.880110e+03 \n       -2.909686e+03 \n       15731503.04 \n       15731503.04 \n       ... \n       0 \n       0 \n       0 \n       0.622743 \n       -2.957600e+01 \n       15583892.62 \n       15583892.62 \n       1490 \n       [{u'commission': None, u'amount': 4666, u'sid'... \n       0.0328 \n     \n     \n       2009-12-02 21:00:00+00:00 \n       0.257128 \n       5.637940e-01 \n       0.094742 \n       -0.000270 \n       0.681459 \n       0.081212 \n       3.608900e+03 \n       6.992140e+02 \n       15637240.49 \n       15637240.49 \n       ... \n       0 \n       0 \n       0 \n       0.616942 \n       -2.909686e+03 \n       15731503.04 \n       15731503.04 \n       1491 \n       [{u'commission': None, u'amount': -4907, u'sid... \n       0.0332 \n     \n     \n       2009-12-03 21:00:00+00:00 \n       0.257153 \n       5.356815e-01 \n       0.091740 \n       -0.008088 \n       0.681239 \n       0.081267 \n       -1.671090e+03 \n       -9.718760e+02 \n       15357787.00 \n       15357787.00 \n       ... \n       0 \n       0 \n       0 \n       0.598945 \n       6.992140e+02 \n       15637240.49 \n       15637240.49 \n       1492 \n       [{u'commission': None, u'amount': 1667, u'sid'... \n       0.0339 \n     \n     \n       2009-12-04 21:00:00+00:00 \n       0.257089 \n       5.489262e-01 \n       0.093054 \n       -0.002426 \n       0.681014 \n       0.081282 \n       1.217390e+03 \n       2.455140e+02 \n       15489016.40 \n       15489016.40 \n       ... \n       0 \n       0 \n       0 \n       0.607016 \n       -9.718760e+02 \n       15357787.00 \n       15357787.00 \n       1493 \n       [{u'commission': None, u'amount': -1387, u'sid... \n       0.0348 \n     \n     \n       2009-12-07 21:00:00+00:00 \n       0.257030 \n       5.354856e-01 \n       0.091548 \n       -0.003954 \n       0.680786 \n       0.081289 \n       -2.795400e+02 \n       -3.402600e+01 \n       15354889.76 \n       15354889.76 \n       ... \n       0 \n       0 \n       0 \n       0.598371 \n       2.455140e+02 \n       15489016.40 \n       15489016.40 \n       1494 \n       [{u'commission': None, u'amount': -1961, u'sid... \n       0.0344 \n     \n     \n       2009-12-08 21:00:00+00:00 \n       0.257055 \n       5.078036e-01 \n       0.088587 \n       -0.015007 \n       0.680576 \n       0.081364 \n       1.316500e+02 \n       9.762400e+01 \n       15077938.34 \n       15077938.34 \n       ... \n       0 \n       0 \n       0 \n       0.580382 \n       -3.402600e+01 \n       15354889.76 \n       15354889.76 \n       1495 \n       [{u'commission': None, u'amount': -795, u'sid'... \n       0.0340 \n     \n     \n       2009-12-09 21:00:00+00:00 \n       0.256971 \n       5.048394e-01 \n       0.088146 \n       -0.011323 \n       0.680349 \n       0.081361 \n       -2.696890e+03 \n       -2.599266e+03 \n       15050993.27 \n       15050993.27 \n       ... \n       0 \n       0 \n       0 \n       0.578300 \n       9.762400e+01 \n       15077938.34 \n       15077938.34 \n       1496 \n       [{u'commission': None, u'amount': -1367, u'sid... \n       0.0345 \n     \n     \n       2009-12-10 21:00:00+00:00 \n       0.256909 \n       5.181698e-01 \n       0.089499 \n       -0.005751 \n       0.680125 \n       0.081375 \n       2.364150e+03 \n       -2.351160e+02 \n       15181933.08 \n       15181933.08 \n       ... \n       0 \n       0 \n       0 \n       0.586582 \n       -2.599266e+03 \n       15050993.27 \n       15050993.27 \n       1497 \n       [{u'commission': None, u'amount': 5379, u'sid'... \n       0.0349 \n     \n     \n       2009-12-11 21:00:00+00:00 \n       0.256836 \n       5.283234e-01 \n       0.090504 \n       -0.001528 \n       0.679899 \n       0.081383 \n       2.523800e+02 \n       1.726400e+01 \n       15283216.38 \n       15283216.38 \n       ... \n       0 \n       0 \n       0 \n       0.592783 \n       -2.351160e+02 \n       15181933.08 \n       15181933.08 \n       1498 \n       [{u'commission': None, u'amount': -483, u'sid'... \n       0.0355 \n     \n     \n       2009-12-14 21:00:00+00:00 \n       0.256789 \n       5.454956e-01 \n       0.092235 \n       0.005302 \n       0.679677 \n       0.081406 \n       6.313700e+03 \n       6.330964e+03 \n       15448625.06 \n       15448625.06 \n       ... \n       0 \n       0 \n       0 \n       0.603328 \n       1.726400e+01 \n       15283216.38 \n       15283216.38 \n       1499 \n       [{u'commission': None, u'amount': -21110, u'si... \n       0.0356 \n     \n     \n       2009-12-15 21:00:00+00:00 \n       0.256712 \n       5.540960e-01 \n       0.093174 \n       0.000629 \n       0.679454 \n       0.081395 \n       -2.764129e+04 \n       -2.131033e+04 \n       15562270.30 \n       15562270.30 \n       ... \n       0 \n       0 \n       0 \n       0.608445 \n       6.330964e+03 \n       15448625.06 \n       15448625.06 \n       1500 \n       [{u'commission': None, u'amount': -273861, u's... \n       0.0360 \n     \n     \n       2009-12-16 21:00:00+00:00 \n       0.256629 \n       5.591566e-01 \n       0.093638 \n       0.002157 \n       0.679227 \n       0.081396 \n       1.440453e+05 \n       1.227349e+05 \n       15468831.23 \n       15468831.23 \n       ... \n       0 \n       0 \n       0 \n       0.611354 \n       -2.131033e+04 \n       15562270.30 \n       15562270.30 \n       1501 \n       [{u'commission': None, u'amount': 108105, u'si... \n       0.0361 \n     \n     \n       2009-12-17 21:00:00+00:00 \n       0.256583 \n       5.426112e-01 \n       0.091951 \n       -0.009885 \n       0.679021 \n       0.081442 \n       -1.195010e+05 \n       3.233914e+03 \n       15422877.79 \n       15422877.79 \n       ... \n       0 \n       0 \n       0 \n       0.600831 \n       1.227349e+05 \n       15468831.23 \n       15468831.23 \n       1502 \n       [{u'commission': None, u'amount': 9112, u'sid'... \n       0.0350 \n     \n     \n       2009-12-18 21:00:00+00:00 \n       0.256572 \n       5.665010e-01 \n       0.094483 \n       -0.009615 \n       0.678795 \n       0.081440 \n       -4.617290e+03 \n       -1.383376e+03 \n       15666393.17 \n       15666393.17 \n       ... \n       0 \n       0 \n       0 \n       0.615413 \n       3.233914e+03 \n       15422877.79 \n       15422877.79 \n       1503 \n       [{u'commission': None, u'amount': 2044, u'sid'... \n       0.0355 \n     \n     \n       2009-12-21 21:00:00+00:00 \n       0.256673 \n       6.045817e-01 \n       0.098342 \n       0.000449 \n       0.678580 \n       0.081520 \n       4.766944e+04 \n       4.628606e+04 \n       15999531.04 \n       15999531.04 \n       ... \n       0 \n       0 \n       0 \n       0.638404 \n       -1.383376e+03 \n       15666393.17 \n       15666393.17 \n       1504 \n       [{u'commission': None, u'amount': 64288, u'sid... \n       0.0369 \n     \n     \n       2009-12-22 21:00:00+00:00 \n       0.256588 \n       6.030770e-01 \n       0.098071 \n       0.004044 \n       0.678355 \n       0.081518 \n       -4.947564e+04 \n       -3.189576e+03 \n       16033959.57 \n       16033959.57 \n       ... \n       0 \n       0 \n       0 \n       0.637296 \n       4.628606e+04 \n       15999531.04 \n       15999531.04 \n       1505 \n       [{u'commission': None, u'amount': 162944, u'si... \n       0.0376 \n     \n     \n       2009-12-23 21:00:00+00:00 \n       0.256510 \n       6.113661e-01 \n       0.098843 \n       0.006021 \n       0.678130 \n       0.081521 \n       1.820101e+04 \n       1.501143e+04 \n       16098649.18 \n       16098649.18 \n       ... \n       0 \n       0 \n       0 \n       0.642015 \n       -3.189576e+03 \n       16033959.57 \n       16033959.57 \n       1506 \n       [{u'commission': None, u'amount': 100740, u'si... \n       0.0377 \n     \n     \n       2009-12-24 18:00:00+00:00 \n       0.256425 \n       6.129331e-01 \n       0.098876 \n       0.010784 \n       0.677907 \n       0.081521 \n       1.411030e+04 \n       2.912173e+04 \n       16100208.93 \n       16100208.93 \n       ... \n       0 \n       0 \n       0 \n       0.642729 \n       1.501143e+04 \n       16098649.18 \n       16098649.18 \n       1507 \n       [{u'commission': None, u'amount': 61067, u'sid... \n       0.0382 \n     \n     \n       2009-12-28 21:00:00+00:00 \n       0.256359 \n       6.261147e-01 \n       0.100146 \n       0.012940 \n       0.677682 \n       0.081525 \n       -3.452828e+04 \n       -5.406546e+03 \n       16266553.28 \n       16266553.28 \n       ... \n       0 \n       0 \n       0 \n       0.650304 \n       2.912173e+04 \n       16100208.93 \n       16100208.93 \n       1508 \n       [{u'commission': None, u'amount': 20274, u'sid... \n       0.0385 \n     \n     \n       2009-12-29 21:00:00+00:00 \n       0.256290 \n       6.382284e-01 \n       0.101344 \n       0.011503 \n       0.677458 \n       0.081519 \n       -6.974254e+03 \n       -1.238080e+04 \n       16394664.33 \n       16394664.33 \n       ... \n       0 \n       0 \n       0 \n       0.657185 \n       -5.406546e+03 \n       16266553.28 \n       16266553.28 \n       1509 \n       [{u'commission': None, u'amount': 69484, u'sid... \n       0.0382 \n     \n     \n       2009-12-30 21:00:00+00:00 \n       0.256206 \n       6.422355e-01 \n       0.101690 \n       0.011143 \n       0.677234 \n       0.081519 \n       -1.493927e+05 \n       -1.617735e+05 \n       16584128.61 \n       16584128.61 \n       ... \n       0 \n       0 \n       0 \n       0.659296 \n       -1.238080e+04 \n       16394664.33 \n       16394664.33 \n       1510 \n       [{u'commission': None, u'amount': -244304, u's... \n       0.0380 \n     \n     \n       2009-12-31 21:00:00+00:00 \n       0.256245 \n       6.110285e-01 \n       0.098572 \n       0.001438 \n       0.677023 \n       0.081588 \n       6.987978e+04 \n       -9.189371e+04 \n       16202178.41 \n       16202178.41 \n       ... \n       0 \n       0 \n       0 \n       0.640360 \n       -1.617735e+05 \n       16584128.61 \n       16584128.61 \n       1511 \n       [{u'commission': None, u'amount': -116692, u's... \n       0.0385 \n     \n     1511 rows \u00d7 37 columns",
            "title": "Run our zipline algorithm"
        },
        {
            "location": "/notebooks/zipline_algo_example/#extract-metrics",
            "text": "Get the returns, positions, and transactions from the zipline backtest object.  import pandas as pd\n\nresults = pd.read_pickle('results.pickle')\nreturns, positions, transactions = pf.utils.extract_rets_pos_txn_from_zipline(results)",
            "title": "Extract metrics"
        },
        {
            "location": "/notebooks/zipline_algo_example/#single-plot-example",
            "text": "Make one plot of the top 5 drawdown periods.  pf.plot_drawdown_periods(returns, top=5).set_xlabel('Date')  <matplotlib.text.Text at 0x1207c8050>",
            "title": "Single plot example"
        },
        {
            "location": "/notebooks/zipline_algo_example/#full-tear-sheet-example",
            "text": "Create a full tear sheet for our algorithm. As an example, set the live start date to something arbitrary.  pf.create_full_tear_sheet(returns, positions=positions, transactions=transactions,\n                          live_start_date='2009-10-22', round_trips=True)  /Users/georgeho/pyfolio/pyfolio/utils.py:251: UserWarning: Yahoo Finance read failed: HTTPConnectionPool(host='ichart.finance.yahoo.com', port=80): Max retries exceeded with url: /table.csv?a=0&ignore=.csv&s=SPY&b=1&e=13&d=7&g=d&f=2017&c=1970 (Caused by NewConnectionError('<requests.packages.urllib3.connection.HTTPConnection object at 0x12372a750>: Failed to establish a new connection: [Errno 8] nodename nor servname provided, or not known',)), falling back to Google\n  UserWarning)\n\n\nEntire data start date: 2004-01-02\nEntire data end date: 2009-12-31\nIn-sample months: 69\nOut-of-sample months: 2   \n   \n     \n       \n       All \n       In-sample \n       Out-of-sample \n     \n   \n   \n     \n       Annual return \n       8.3% \n       8.1% \n       14.9% \n     \n     \n       Cumulative returns \n       61.1% \n       56.8% \n       2.7% \n     \n     \n       Annual volatility \n       25.6% \n       25.7% \n       22.0% \n     \n     \n       Sharpe ratio \n       0.44 \n       0.43 \n       0.74 \n     \n     \n       Calmar ratio \n       0.14 \n       0.13 \n       2.03 \n     \n     \n       Stability \n       0.00 \n       0.01 \n       0.04 \n     \n     \n       Max drawdown \n       -60.3% \n       -60.3% \n       -7.3% \n     \n     \n       Omega ratio \n       1.08 \n       1.08 \n       1.13 \n     \n     \n       Sortino ratio \n       0.64 \n       0.63 \n       1.04 \n     \n     \n       Skew \n       0.21 \n       0.22 \n       -0.29 \n     \n     \n       Kurtosis \n       4.19 \n       4.24 \n       0.36 \n     \n     \n       Tail ratio \n       0.97 \n       0.99 \n       1.23 \n     \n     \n       Daily value at risk \n       -3.2% \n       -3.2% \n       -2.7% \n     \n     \n       Gross leverage \n       1.00 \n       1.00 \n       1.00 \n     \n     \n       Daily turnover \n       7.6% \n       7.5% \n       9.6% \n     \n     \n       Alpha \n       0.09 \n       0.10 \n       -0.03 \n     \n     \n       Beta \n       0.83 \n       0.82 \n       1.19 \n     \n       \n   \n     \n       Worst drawdown periods \n       Net drawdown in % \n       Peak date \n       Valley date \n       Recovery date \n       Duration \n     \n   \n   \n     \n       0 \n       60.30 \n       2007-11-06 \n       2008-11-20 \n       NaT \n       NaN \n     \n     \n       1 \n       23.25 \n       2006-04-06 \n       2006-09-07 \n       2007-05-22 \n       294 \n     \n     \n       2 \n       12.52 \n       2004-11-15 \n       2005-10-12 \n       2006-01-11 \n       303 \n     \n     \n       3 \n       10.90 \n       2004-06-25 \n       2004-08-12 \n       2004-11-04 \n       95 \n     \n     \n       4 \n       9.47 \n       2007-07-16 \n       2007-08-06 \n       2007-09-04 \n       37 \n     \n       /Users/georgeho/anaconda/lib/python2.7/site-packages/numpy/lib/function_base.py:4269: RuntimeWarning: Invalid value encountered in percentile\n  interpolation=interpolation)   \n   \n     \n       Stress Events \n       mean \n       min \n       max \n     \n   \n   \n     \n       Lehmann \n       -0.28% \n       -7.41% \n       4.40% \n     \n     \n       Aug07 \n       0.35% \n       -2.96% \n       3.03% \n     \n     \n       Mar08 \n       -0.43% \n       -3.10% \n       3.34% \n     \n     \n       Sept08 \n       -0.68% \n       -7.41% \n       3.99% \n     \n     \n       2009Q1 \n       -0.35% \n       -4.98% \n       3.36% \n     \n     \n       2009Q2 \n       0.71% \n       -3.78% \n       6.17% \n     \n     \n       Low Volatility Bull Market \n       0.01% \n       -6.11% \n       6.45% \n     \n     \n       GFC Crash \n       -0.08% \n       -7.58% \n       9.71% \n     \n     \n       Recovery \n       0.32% \n       -3.78% \n       6.17% \n     \n        \n   \n     \n       Top 10 long positions of all time \n       max \n     \n   \n   \n     \n       COST \n       100.74% \n     \n     \n       MMM \n       92.35% \n     \n     \n       CERN \n       84.47% \n     \n     \n       DELL \n       72.76% \n     \n     \n       AMD \n       71.05% \n     \n     \n       INTC \n       69.19% \n     \n     \n       GPS \n       62.11% \n     \n       \n   \n     \n       Top 10 short positions of all time \n       max \n     \n   \n   \n       \n   \n     \n       Top 10 positions of all time \n       max \n     \n   \n   \n     \n       COST \n       100.74% \n     \n     \n       MMM \n       92.35% \n     \n     \n       CERN \n       84.47% \n     \n     \n       DELL \n       72.76% \n     \n     \n       AMD \n       71.05% \n     \n     \n       INTC \n       69.19% \n     \n     \n       GPS \n       62.11% \n     \n       \n   \n     \n       All positions ever held \n       max \n     \n   \n   \n     \n       COST \n       100.74% \n     \n     \n       MMM \n       92.35% \n     \n     \n       CERN \n       84.47% \n     \n     \n       DELL \n       72.76% \n     \n     \n       AMD \n       71.05% \n     \n     \n       INTC \n       69.19% \n     \n     \n       GPS \n       62.11% \n     \n         \n   \n     \n       Summary stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Total number of round_trips \n       3986.00 \n       3.00 \n       3983.00 \n     \n     \n       Percent profitable \n       0.49 \n       0.33 \n       0.49 \n     \n     \n       Winning round_trips \n       1938.00 \n       1.00 \n       1937.00 \n     \n     \n       Losing round_trips \n       2039.00 \n       0.00 \n       2039.00 \n     \n     \n       Even round_trips \n       9.00 \n       2.00 \n       7.00 \n     \n       \n   \n     \n       PnL stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Total profit \n       $6118150.70 \n       $0.00 \n       $6118150.70 \n     \n     \n       Gross profit \n       $37872903.48 \n       $0.00 \n       $37872903.48 \n     \n     \n       Gross loss \n       $-31754752.78 \n       $0.00 \n       $-31754752.78 \n     \n     \n       Profit factor \n       $1.19 \n       $nan \n       $1.19 \n     \n     \n       Avg. trade net profit \n       $1534.91 \n       $0.00 \n       $1536.07 \n     \n     \n       Avg. winning trade \n       $19542.26 \n       $0.00 \n       $19552.35 \n     \n     \n       Avg. losing trade \n       $-15573.69 \n       $nan \n       $-15573.69 \n     \n     \n       Ratio Avg. Win:Avg. Loss \n       $1.25 \n       $nan \n       $1.26 \n     \n     \n       Largest winning trade \n       $1553000.44 \n       $0.00 \n       $1553000.44 \n     \n     \n       Largest losing trade \n       $-1251993.38 \n       $0.00 \n       $-1251993.38 \n     \n       \n   \n     \n       Duration stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Avg duration \n       21 days 18:52:41.966884 \n       20:59:59 \n       21 days 19:15:22.822746 \n     \n     \n       Median duration \n       17 days 23:00:00 \n       20:59:59 \n       18 days 00:00:00 \n     \n     \n       Longest duration \n       109 days 01:00:00 \n       20:59:59 \n       109 days 01:00:00 \n     \n     \n       Shortest duration \n       0 days 03:00:01 \n       20:59:59 \n       0 days 03:00:01 \n     \n       \n   \n     \n       Return stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Avg returns all round_trips \n       0.01% \n       0.00% \n       0.01% \n     \n     \n       Avg returns winning \n       0.16% \n       0.00% \n       0.16% \n     \n     \n       Avg returns losing \n       -0.13% \n       nan% \n       -0.13% \n     \n     \n       Median returns all round_trips \n       -0.00% \n       0.00% \n       -0.00% \n     \n     \n       Median returns winning \n       0.02% \n       0.00% \n       0.02% \n     \n     \n       Median returns losing \n       -0.01% \n       nan% \n       -0.01% \n     \n     \n       Largest winning trade \n       12.13% \n       0.00% \n       12.13% \n     \n     \n       Largest losing trade \n       -9.14% \n       0.00% \n       -9.14% \n     \n       \n   \n     \n       Symbol stats \n       CERN \n       COST \n       GPS \n       INTC \n       MMM \n       AMD \n       DELL \n     \n   \n   \n     \n       Avg returns all round_trips \n       0.03% \n       0.03% \n       -0.01% \n       0.04% \n       0.01% \n       -0.00% \n       -0.03% \n     \n     \n       Avg returns winning \n       0.19% \n       0.12% \n       0.13% \n       0.15% \n       0.10% \n       0.36% \n       0.13% \n     \n     \n       Avg returns losing \n       -0.16% \n       -0.06% \n       -0.11% \n       -0.06% \n       -0.08% \n       -0.34% \n       -0.19% \n     \n     \n       Median returns all round_trips \n       0.00% \n       0.00% \n       -0.00% \n       -0.00% \n       -0.00% \n       -0.00% \n       -0.00% \n     \n     \n       Median returns winning \n       0.02% \n       0.01% \n       0.02% \n       0.03% \n       0.01% \n       0.07% \n       0.01% \n     \n     \n       Median returns losing \n       -0.01% \n       -0.01% \n       -0.01% \n       -0.00% \n       -0.01% \n       -0.02% \n       -0.01% \n     \n     \n       Largest winning trade \n       5.94% \n       2.95% \n       3.54% \n       2.33% \n       2.22% \n       12.13% \n       3.36% \n     \n     \n       Largest losing trade \n       -4.67% \n       -3.47% \n       -8.30% \n       -4.60% \n       -4.02% \n       -9.14% \n       -6.60% \n     \n       \n   \n     \n       Profitability (PnL / PnL total) per name \n       \n     \n   \n   \n     \n       INTC \n       45.09% \n     \n     \n       COST \n       42.42% \n     \n     \n       CERN \n       35.52% \n     \n     \n       MMM \n       13.51% \n     \n     \n       GPS \n       -2.49% \n     \n     \n       AMD \n       -7.15% \n     \n     \n       DELL \n       -26.91%",
            "title": "Full tear sheet example"
        },
        {
            "location": "/notebooks/zipline_algo_example/#suppressing-symbol-output",
            "text": "When sharing tear sheets it might be undesirable to display which symbols where used by a strategy. To suppress these in the tear sheet you can pass  hide_positions=True .  pf.create_full_tear_sheet(returns, positions=positions, transactions=transactions,\n                          live_start_date='2009-10-22', hide_positions=True)  Entire data start date: 2004-01-02\nEntire data end date: 2009-12-31\nIn-sample months: 69\nOut-of-sample months: 2   \n   \n     \n       \n       All \n       In-sample \n       Out-of-sample \n     \n   \n   \n     \n       Annual return \n       8.3% \n       8.1% \n       14.9% \n     \n     \n       Cumulative returns \n       61.1% \n       56.8% \n       2.7% \n     \n     \n       Annual volatility \n       25.6% \n       25.7% \n       22.0% \n     \n     \n       Sharpe ratio \n       0.44 \n       0.43 \n       0.74 \n     \n     \n       Calmar ratio \n       0.14 \n       0.13 \n       2.03 \n     \n     \n       Stability \n       0.00 \n       0.01 \n       0.04 \n     \n     \n       Max drawdown \n       -60.3% \n       -60.3% \n       -7.3% \n     \n     \n       Omega ratio \n       1.08 \n       1.08 \n       1.13 \n     \n     \n       Sortino ratio \n       0.64 \n       0.63 \n       1.04 \n     \n     \n       Skew \n       0.21 \n       0.22 \n       -0.29 \n     \n     \n       Kurtosis \n       4.19 \n       4.24 \n       0.36 \n     \n     \n       Tail ratio \n       0.97 \n       0.99 \n       1.23 \n     \n     \n       Daily value at risk \n       -3.2% \n       -3.2% \n       -2.7% \n     \n     \n       Gross leverage \n       1.00 \n       1.00 \n       1.00 \n     \n     \n       Daily turnover \n       7.6% \n       7.5% \n       9.6% \n     \n     \n       Alpha \n       0.09 \n       0.10 \n       -0.03 \n     \n     \n       Beta \n       0.83 \n       0.82 \n       1.19 \n     \n       \n   \n     \n       Worst drawdown periods \n       Net drawdown in % \n       Peak date \n       Valley date \n       Recovery date \n       Duration \n     \n   \n   \n     \n       0 \n       60.30 \n       2007-11-06 \n       2008-11-20 \n       NaT \n       NaN \n     \n     \n       1 \n       23.25 \n       2006-04-06 \n       2006-09-07 \n       2007-05-22 \n       294 \n     \n     \n       2 \n       12.52 \n       2004-11-15 \n       2005-10-12 \n       2006-01-11 \n       303 \n     \n     \n       3 \n       10.90 \n       2004-06-25 \n       2004-08-12 \n       2004-11-04 \n       95 \n     \n     \n       4 \n       9.47 \n       2007-07-16 \n       2007-08-06 \n       2007-09-04 \n       37 \n     \n        \n   \n     \n       Stress Events \n       mean \n       min \n       max \n     \n   \n   \n     \n       Lehmann \n       -0.28% \n       -7.41% \n       4.40% \n     \n     \n       Aug07 \n       0.35% \n       -2.96% \n       3.03% \n     \n     \n       Mar08 \n       -0.43% \n       -3.10% \n       3.34% \n     \n     \n       Sept08 \n       -0.68% \n       -7.41% \n       3.99% \n     \n     \n       2009Q1 \n       -0.35% \n       -4.98% \n       3.36% \n     \n     \n       2009Q2 \n       0.71% \n       -3.78% \n       6.17% \n     \n     \n       Low Volatility Bull Market \n       0.01% \n       -6.11% \n       6.45% \n     \n     \n       GFC Crash \n       -0.08% \n       -7.58% \n       9.71% \n     \n     \n       Recovery \n       0.32% \n       -3.78% \n       6.17%",
            "title": "Suppressing symbol output"
        },
        {
            "location": "/notebooks/bayesian/",
            "text": "Bayesian performance analysis example in pyfolio\n\n\nThere are a few advanced analysis methods in pyfolio based on Bayesian statistics. \n\n\nThe main benefit of these methods is \nuncertainty quantification\n. All the traditional measures of performance, like the Sharpe ratio, are just single numbers. These estimates are noisy because they have been computed over a limited number of data points. So how much can you trust these numbers? You don't know because there is no sense of uncertainty. That is where Bayesian statistics helps as instead of single values, we are dealing with probability distributions that assign degrees of belief to all possible parameter values.\n\n\nLets create the Bayesian tear sheet. Under the hood this is running MCMC sampling in \nPyMC3\n to estimate the posteriors which can take quite a while (that's the reason why we don't generate this by default in \ncreate_full_tear_sheet\n).\n\n\nImport pyfolio\n\n\n%matplotlib inline\nimport pyfolio as pf\n\n\n\n\nFetch the daily returns for a stock\n\n\nstock_rets = pf.utils.get_symbol_rets('FB')\n\n\n\n\nCreate Bayesian tear sheet\n\n\nout_of_sample = stock_rets.index[-40]\n\n\n\n\npf.create_bayesian_tear_sheet(stock_rets, live_start_date=out_of_sample)\n\n\n\n\nRunning T model\n\n\nWARNING (theano.gof.compilelock): Overriding existing lock by dead process '23486' (I am process '24728')\n\n\nApplied log-transform to volatility and added transformed volatility_log to model.\nApplied log-transform to nu_minus_two and added transformed nu_minus_two_log to model.\n [-----------------100%-----------------] 2000 of 2000 complete in 14.8 sec\nFinished T model (required 279.00 seconds).\n\nRunning BEST model\nApplied interval-transform to group1_std and added transformed group1_std_interval to model.\nApplied interval-transform to group2_std and added transformed group2_std_interval to model.\nApplied log-transform to nu_minus_two and added transformed nu_minus_two_log to model.\n [-----------------100%-----------------] 2000 of 2000 complete in 12.6 sec\nFinished BEST model (required 132.06 seconds).\n\nFinished plotting Bayesian cone (required 0.21 seconds).\n\n\n/home/wiecki/miniconda3/lib/python3.5/site-packages/matplotlib/axes/_axes.py:519: UserWarning: No labelled objects found. Use label='...' kwarg on individual plots.\n  warnings.warn(\"No labelled objects found. \"\n\n\n\nFinished plotting BEST results (required 1.45 seconds).\n\nFinished computing Bayesian predictions (required 0.26 seconds).\n\nFinished plotting Bayesian VaRs estimate (required 0.12 seconds).\n\nRunning alpha beta model\nApplied log-transform to sigma and added transformed sigma_log to model.\nApplied log-transform to nu_minus_two and added transformed nu_minus_two_log to model.\n [-----------------100%-----------------] 2000 of 2000 complete in 7.2 sec\nFinished running alpha beta model (required 130.28 seconds).\n\nFinished plotting alpha beta model (required 0.24 seconds).\n\nTotal runtime was 543.62 seconds.\n\n\n\n\n\nLets go through these row by row:\n\n\n\n\nThe first one is the Bayesian cone plot that is the result of a summer internship project of Sepideh Sadeghi here at Quantopian. It's similar to the cone plot you already saw in the tear sheet above but has two critical additions: (i) it takes uncertainty into account (i.e. a short backtest length will result in a wider cone), and (ii) it does not assume normality of returns but instead uses a \nStudent-T distribution\n with heavier tails.\n\n\nThe next row compares mean returns of the in-sample (backest) and out-of-sample or OOS (forward) period. As you can see, mean returns are not a single number but a (posterior) distribution that gives us an indication of how certain we can be in our estimates. The green distribution on the left side is much wider, representing our increased uncertainty due to having less OOS data. We can then calculate the difference between these two distributions as shown on the right side. The grey lines denote the 2.5% and 97.5% percentiles. Intuitively, if the right grey line is lower than 0 you can say that with probability > 97.5% the OOS mean returns are below what is suggested by the backtest. The model used here is called \nBEST\n and was developed by John Kruschke.\n\n\nThe next couple of rows follow the same pattern but are an estimate of annual volatility, Sharpe ratio and their respective differences.\n\n\nThe 5th row shows the effect size or the difference of means normalized by the standard deviation and gives you a general sense how far apart the two distributions are. Intuitively, even if the means are significantly different, it may not be very meaningful if the standard deviation is huge amounting to a tiny difference of the two returns distributions.\n\n\nThe 6th row shows predicted returns (based on the backtest) for tomorrow, and 5 days from now. The blue line indicates the probability of losing more than 5% of your portfolio value and can be interpeted as a Bayesian VaR estimate.\n\n\nThe 7th row shows a Bayesian estimate of annual alpha and beta. In addition to uncertainty estimates, this model, like all above ones, assumes returns to be T-distributed which leads to more robust estimates than a standard linear regression would.  The default benchmark is the S&P500.  Alternatively, users may use the Fama-French model as a bunchmark by setting benchmark_rets=\"Fama-French\".  \n\n\nBy default, stoch_vol=False because running the stochastic volatility model is computationally expensive.\n\n\nOnly the most recent 400 days of returns are used when computing the stochastic volatility model.  This is to minimize computational time.\n\n\n\n\nRunning models directly\n\n\nYou can also run individual models. All models can be found in \npyfolio.bayesian\n and run via the \nrun_model\n function.\n\n\nhelp(pf.bayesian.run_model)\n\n\n\n\nHelp on function run_model in module pyfolio.bayesian:\n\nrun_model(model, returns_train, returns_test=None, bmark=None, samples=500, ppc=False)\n    Run one of the Bayesian models.\n\n    Parameters\n    ----------\n    model : {'alpha_beta', 't', 'normal', 'best'}\n        Which model to run\n    returns_train : pd.Series\n        Timeseries of simple returns\n    returns_test : pd.Series (optional)\n        Out-of-sample returns. Datetimes in returns_test will be added to\n        returns_train as missing values and predictions will be generated\n        for them.\n    bmark : pd.Series or pd.DataFrame (optional)\n        Only used for alpha_beta to estimate regression coefficients.\n        If bmark has more recent returns than returns_train, these dates\n        will be treated as missing values and predictions will be\n        generated for them taking market correlations into account.\n    samples : int (optional)\n        Number of posterior samples to draw.\n    ppc : boolean (optional)\n        Whether to run a posterior predictive check. Will generate\n        samples of length returns_test.  Returns a second argument\n        that contains the PPC of shape samples x len(returns_test).\n\n    Returns\n    -------\n    trace : pymc3.sampling.BaseTrace object\n        A PyMC3 trace object that contains samples for each parameter\n        of the posterior.\n\n    ppc : numpy.array (if ppc==True)\n       PPC of shape samples x len(returns_test).\n\n\n\nFor example, to run a model that assumes returns to be normally distributed, you can call:\n\n\n# Run model that assumes returns to be T-distributed\ntrace = pf.bayesian.run_model('t', stock_rets)\n\n\n\n\nApplied log-transform to volatility and added transformed volatility_log to model.\nApplied log-transform to nu_minus_two and added transformed nu_minus_two_log to model.\n [-----------------100%-----------------] 500 of 500 complete in 1.9 sec\n\n\n\nThe returned trace object can be directly inquired. For example might we ask what the probability of the Sharpe ratio being larger than 0 is by checking what percentage of posterior samples of the Sharpe ratio are > 0:\n\n\n# Check what frequency of samples from the sharpe posterior are above 0.\nprint('Probability of Sharpe ratio > 0 = {:3}%'.format((trace['sharpe'] > 0).mean() * 100))\n\n\n\n\nProbability of Sharpe ratio > 0 = 92.0%\n\n\n\nBut we can also interact with it like with any other \npymc3\n trace:\n\n\nimport pymc3 as pm\npm.traceplot(trace);\n\n\n\n\n\n\nFurther reading\n\n\nFor more information on Bayesian statistics, check out these resources:\n\n\n\n\nA blog post about the Bayesian models with Sepideh Sadeghi\n\n\nMy personal blog on Bayesian modeling\n\n\nA talk I gave in Singapore on \nProbabilistic Programming in Quantitative Finance\n\n\nA series of IPython notebooks on \nBayesian Methods for Hackers\n.",
            "title": "Bayesian analysis"
        },
        {
            "location": "/notebooks/bayesian/#bayesian-performance-analysis-example-in-pyfolio",
            "text": "There are a few advanced analysis methods in pyfolio based on Bayesian statistics.   The main benefit of these methods is  uncertainty quantification . All the traditional measures of performance, like the Sharpe ratio, are just single numbers. These estimates are noisy because they have been computed over a limited number of data points. So how much can you trust these numbers? You don't know because there is no sense of uncertainty. That is where Bayesian statistics helps as instead of single values, we are dealing with probability distributions that assign degrees of belief to all possible parameter values.  Lets create the Bayesian tear sheet. Under the hood this is running MCMC sampling in  PyMC3  to estimate the posteriors which can take quite a while (that's the reason why we don't generate this by default in  create_full_tear_sheet ).",
            "title": "Bayesian performance analysis example in pyfolio"
        },
        {
            "location": "/notebooks/bayesian/#import-pyfolio",
            "text": "%matplotlib inline\nimport pyfolio as pf",
            "title": "Import pyfolio"
        },
        {
            "location": "/notebooks/bayesian/#fetch-the-daily-returns-for-a-stock",
            "text": "stock_rets = pf.utils.get_symbol_rets('FB')",
            "title": "Fetch the daily returns for a stock"
        },
        {
            "location": "/notebooks/bayesian/#create-bayesian-tear-sheet",
            "text": "out_of_sample = stock_rets.index[-40]  pf.create_bayesian_tear_sheet(stock_rets, live_start_date=out_of_sample)  Running T model\n\n\nWARNING (theano.gof.compilelock): Overriding existing lock by dead process '23486' (I am process '24728')\n\n\nApplied log-transform to volatility and added transformed volatility_log to model.\nApplied log-transform to nu_minus_two and added transformed nu_minus_two_log to model.\n [-----------------100%-----------------] 2000 of 2000 complete in 14.8 sec\nFinished T model (required 279.00 seconds).\n\nRunning BEST model\nApplied interval-transform to group1_std and added transformed group1_std_interval to model.\nApplied interval-transform to group2_std and added transformed group2_std_interval to model.\nApplied log-transform to nu_minus_two and added transformed nu_minus_two_log to model.\n [-----------------100%-----------------] 2000 of 2000 complete in 12.6 sec\nFinished BEST model (required 132.06 seconds).\n\nFinished plotting Bayesian cone (required 0.21 seconds).\n\n\n/home/wiecki/miniconda3/lib/python3.5/site-packages/matplotlib/axes/_axes.py:519: UserWarning: No labelled objects found. Use label='...' kwarg on individual plots.\n  warnings.warn(\"No labelled objects found. \"\n\n\n\nFinished plotting BEST results (required 1.45 seconds).\n\nFinished computing Bayesian predictions (required 0.26 seconds).\n\nFinished plotting Bayesian VaRs estimate (required 0.12 seconds).\n\nRunning alpha beta model\nApplied log-transform to sigma and added transformed sigma_log to model.\nApplied log-transform to nu_minus_two and added transformed nu_minus_two_log to model.\n [-----------------100%-----------------] 2000 of 2000 complete in 7.2 sec\nFinished running alpha beta model (required 130.28 seconds).\n\nFinished plotting alpha beta model (required 0.24 seconds).\n\nTotal runtime was 543.62 seconds.   Lets go through these row by row:   The first one is the Bayesian cone plot that is the result of a summer internship project of Sepideh Sadeghi here at Quantopian. It's similar to the cone plot you already saw in the tear sheet above but has two critical additions: (i) it takes uncertainty into account (i.e. a short backtest length will result in a wider cone), and (ii) it does not assume normality of returns but instead uses a  Student-T distribution  with heavier tails.  The next row compares mean returns of the in-sample (backest) and out-of-sample or OOS (forward) period. As you can see, mean returns are not a single number but a (posterior) distribution that gives us an indication of how certain we can be in our estimates. The green distribution on the left side is much wider, representing our increased uncertainty due to having less OOS data. We can then calculate the difference between these two distributions as shown on the right side. The grey lines denote the 2.5% and 97.5% percentiles. Intuitively, if the right grey line is lower than 0 you can say that with probability > 97.5% the OOS mean returns are below what is suggested by the backtest. The model used here is called  BEST  and was developed by John Kruschke.  The next couple of rows follow the same pattern but are an estimate of annual volatility, Sharpe ratio and their respective differences.  The 5th row shows the effect size or the difference of means normalized by the standard deviation and gives you a general sense how far apart the two distributions are. Intuitively, even if the means are significantly different, it may not be very meaningful if the standard deviation is huge amounting to a tiny difference of the two returns distributions.  The 6th row shows predicted returns (based on the backtest) for tomorrow, and 5 days from now. The blue line indicates the probability of losing more than 5% of your portfolio value and can be interpeted as a Bayesian VaR estimate.  The 7th row shows a Bayesian estimate of annual alpha and beta. In addition to uncertainty estimates, this model, like all above ones, assumes returns to be T-distributed which leads to more robust estimates than a standard linear regression would.  The default benchmark is the S&P500.  Alternatively, users may use the Fama-French model as a bunchmark by setting benchmark_rets=\"Fama-French\".    By default, stoch_vol=False because running the stochastic volatility model is computationally expensive.  Only the most recent 400 days of returns are used when computing the stochastic volatility model.  This is to minimize computational time.",
            "title": "Create Bayesian tear sheet"
        },
        {
            "location": "/notebooks/bayesian/#running-models-directly",
            "text": "You can also run individual models. All models can be found in  pyfolio.bayesian  and run via the  run_model  function.  help(pf.bayesian.run_model)  Help on function run_model in module pyfolio.bayesian:\n\nrun_model(model, returns_train, returns_test=None, bmark=None, samples=500, ppc=False)\n    Run one of the Bayesian models.\n\n    Parameters\n    ----------\n    model : {'alpha_beta', 't', 'normal', 'best'}\n        Which model to run\n    returns_train : pd.Series\n        Timeseries of simple returns\n    returns_test : pd.Series (optional)\n        Out-of-sample returns. Datetimes in returns_test will be added to\n        returns_train as missing values and predictions will be generated\n        for them.\n    bmark : pd.Series or pd.DataFrame (optional)\n        Only used for alpha_beta to estimate regression coefficients.\n        If bmark has more recent returns than returns_train, these dates\n        will be treated as missing values and predictions will be\n        generated for them taking market correlations into account.\n    samples : int (optional)\n        Number of posterior samples to draw.\n    ppc : boolean (optional)\n        Whether to run a posterior predictive check. Will generate\n        samples of length returns_test.  Returns a second argument\n        that contains the PPC of shape samples x len(returns_test).\n\n    Returns\n    -------\n    trace : pymc3.sampling.BaseTrace object\n        A PyMC3 trace object that contains samples for each parameter\n        of the posterior.\n\n    ppc : numpy.array (if ppc==True)\n       PPC of shape samples x len(returns_test).  For example, to run a model that assumes returns to be normally distributed, you can call:  # Run model that assumes returns to be T-distributed\ntrace = pf.bayesian.run_model('t', stock_rets)  Applied log-transform to volatility and added transformed volatility_log to model.\nApplied log-transform to nu_minus_two and added transformed nu_minus_two_log to model.\n [-----------------100%-----------------] 500 of 500 complete in 1.9 sec  The returned trace object can be directly inquired. For example might we ask what the probability of the Sharpe ratio being larger than 0 is by checking what percentage of posterior samples of the Sharpe ratio are > 0:  # Check what frequency of samples from the sharpe posterior are above 0.\nprint('Probability of Sharpe ratio > 0 = {:3}%'.format((trace['sharpe'] > 0).mean() * 100))  Probability of Sharpe ratio > 0 = 92.0%  But we can also interact with it like with any other  pymc3  trace:  import pymc3 as pm\npm.traceplot(trace);",
            "title": "Running models directly"
        },
        {
            "location": "/notebooks/bayesian/#further-reading",
            "text": "For more information on Bayesian statistics, check out these resources:   A blog post about the Bayesian models with Sepideh Sadeghi  My personal blog on Bayesian modeling  A talk I gave in Singapore on  Probabilistic Programming in Quantitative Finance  A series of IPython notebooks on  Bayesian Methods for Hackers .",
            "title": "Further reading"
        },
        {
            "location": "/notebooks/sector_mappings_example/",
            "text": "Sector Mappings\n\n\nTo generate sector allocation plots in the positions tearsheet and PnL by sector in the round trips tearsheet, you must pass pyfolio a dictionary (or dict-like data structure) of symbol-sector mappings, where symbols are keys and sectors are values. \ncreate_full_tearsheet\n will also take symbol-sector mappings as the keyword argument \nsector_mappings\n.\n\n\nIn this notebook, we generate the positions tear sheet and round-trip tear sheet with sector mappings.\n\n\nimport pyfolio as pf\nimport pandas as pd\n%matplotlib inline\nimport gzip\nimport os\n\n# silence warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\n\n\n\nreturns = pd.read_csv(gzip.open('../tests/test_data/test_returns.csv.gz'),\n                      index_col=0, parse_dates=True, header=None)[1]\npositions = pd.read_csv(gzip.open('../tests/test_data/test_pos.csv.gz'),\n                        index_col=0, parse_dates=True)\ntransactions = pd.read_csv(gzip.open('../tests/test_data/test_txn.csv.gz'),\n                           index_col=0, parse_dates=True)\n\nreturns.index = returns.index.tz_localize('UTC')\npositions.index = positions.index.tz_localize('UTC')\ntransactions.index = transactions.index.tz_localize('UTC')\n\n\n\n\npositions.head()\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \n\n      \nAMD\n\n      \nCERN\n\n      \nCOST\n\n      \nDELL\n\n      \nGPS\n\n      \nINTC\n\n      \nMMM\n\n      \ncash\n\n    \n\n    \n\n      \nindex\n\n      \n\n      \n\n      \n\n      \n\n      \n\n      \n\n      \n\n      \n\n    \n\n  \n\n  \n\n    \n\n      \n2004-01-09 00:00:00+00:00\n\n      \n6961.92\n\n      \n21017.07875\n\n      \n7282.266152\n\n      \n21264.55188\n\n      \n7091.080020\n\n      \n21259.333890\n\n      \n21316.129606\n\n      \n-6192.360298\n\n    \n\n    \n\n      \n2004-01-12 00:00:00+00:00\n\n      \n18198.58\n\n      \n18071.25000\n\n      \n17675.836401\n\n      \n10804.31924\n\n      \n10685.411865\n\n      \n17872.477480\n\n      \n10882.026400\n\n      \n-3329.289887\n\n    \n\n    \n\n      \n2004-01-13 00:00:00+00:00\n\n      \n12060.86\n\n      \n11942.24625\n\n      \n12838.477446\n\n      \n16078.90380\n\n      \n16272.139000\n\n      \n12465.392511\n\n      \n12579.135758\n\n      \n4708.039735\n\n    \n\n    \n\n      \n2004-01-14 00:00:00+00:00\n\n      \n13102.40\n\n      \n15534.28125\n\n      \n14447.422640\n\n      \n15414.45080\n\n      \n15666.440185\n\n      \n14884.069620\n\n      \n13454.542620\n\n      \n-2749.470030\n\n    \n\n    \n\n      \n2004-01-15 00:00:00+00:00\n\n      \n15518.40\n\n      \n14547.05000\n\n      \n14164.039680\n\n      \n14407.48813\n\n      \n14926.122619\n\n      \n14422.385864\n\n      \n13929.159049\n\n      \n-2462.919316\n\n    \n\n  \n\n\n\n\n\n\n\n# define our sector mappings\nsect_map = {'COST': 'Consumer Goods',\n            'INTC': 'Technology', \n            'CERN': 'Healthcare', \n            'GPS': 'Technology',\n            'MMM': 'Construction', \n            'DELL': 'Technology', \n            'AMD': 'Technology'}\n\n\n\n\npf.create_position_tear_sheet(returns, positions, sector_mappings=sect_map)\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nTop 10 long positions of all time\n\n      \nmax\n\n    \n\n  \n\n  \n\n    \n\n      \nCOST\n\n      \n90.01%\n\n    \n\n    \n\n      \nDELL\n\n      \n85.73%\n\n    \n\n    \n\n      \nCERN\n\n      \n83.53%\n\n    \n\n    \n\n      \nMMM\n\n      \n82.09%\n\n    \n\n    \n\n      \nINTC\n\n      \n78.59%\n\n    \n\n    \n\n      \nAMD\n\n      \n75.76%\n\n    \n\n    \n\n      \nGPS\n\n      \n62.24%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nTop 10 short positions of all time\n\n      \nmax\n\n    \n\n  \n\n  \n\n    \n\n      \nAMD\n\n      \n-30.12%\n\n    \n\n    \n\n      \nDELL\n\n      \n-26.58%\n\n    \n\n    \n\n      \nCERN\n\n      \n-25.51%\n\n    \n\n    \n\n      \nMMM\n\n      \n-22.62%\n\n    \n\n    \n\n      \nGPS\n\n      \n-20.09%\n\n    \n\n    \n\n      \nINTC\n\n      \n-18.47%\n\n    \n\n    \n\n      \nCOST\n\n      \n-16.44%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nTop 10 positions of all time\n\n      \nmax\n\n    \n\n  \n\n  \n\n    \n\n      \nCOST\n\n      \n90.01%\n\n    \n\n    \n\n      \nDELL\n\n      \n85.73%\n\n    \n\n    \n\n      \nCERN\n\n      \n83.53%\n\n    \n\n    \n\n      \nMMM\n\n      \n82.09%\n\n    \n\n    \n\n      \nINTC\n\n      \n78.59%\n\n    \n\n    \n\n      \nAMD\n\n      \n75.76%\n\n    \n\n    \n\n      \nGPS\n\n      \n62.24%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nAll positions ever held\n\n      \nmax\n\n    \n\n  \n\n  \n\n    \n\n      \nCOST\n\n      \n90.01%\n\n    \n\n    \n\n      \nDELL\n\n      \n85.73%\n\n    \n\n    \n\n      \nCERN\n\n      \n83.53%\n\n    \n\n    \n\n      \nMMM\n\n      \n82.09%\n\n    \n\n    \n\n      \nINTC\n\n      \n78.59%\n\n    \n\n    \n\n      \nAMD\n\n      \n75.76%\n\n    \n\n    \n\n      \nGPS\n\n      \n62.24%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\npf.create_round_trip_tear_sheet(returns, positions, transactions, sector_mappings=sect_map)\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nSummary stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nTotal number of round_trips\n\n      \n5822.00\n\n      \n1155.00\n\n      \n4667.00\n\n    \n\n    \n\n      \nPercent profitable\n\n      \n0.50\n\n      \n0.52\n\n      \n0.49\n\n    \n\n    \n\n      \nWinning round_trips\n\n      \n2887.00\n\n      \n596.00\n\n      \n2291.00\n\n    \n\n    \n\n      \nLosing round_trips\n\n      \n2917.00\n\n      \n553.00\n\n      \n2364.00\n\n    \n\n    \n\n      \nEven round_trips\n\n      \n18.00\n\n      \n6.00\n\n      \n12.00\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nPnL stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nTotal profit\n\n      \n$65404.25\n\n      \n$3560.10\n\n      \n$61844.15\n\n    \n\n    \n\n      \nGross profit\n\n      \n$448803.34\n\n      \n$20608.45\n\n      \n$428194.89\n\n    \n\n    \n\n      \nGross loss\n\n      \n$-383399.09\n\n      \n$-17048.35\n\n      \n$-366350.75\n\n    \n\n    \n\n      \nProfit factor\n\n      \n$1.17\n\n      \n$1.21\n\n      \n$1.17\n\n    \n\n    \n\n      \nAvg. trade net profit\n\n      \n$11.23\n\n      \n$3.08\n\n      \n$13.25\n\n    \n\n    \n\n      \nAvg. winning trade\n\n      \n$155.46\n\n      \n$34.58\n\n      \n$186.90\n\n    \n\n    \n\n      \nAvg. losing trade\n\n      \n$-131.44\n\n      \n$-30.83\n\n      \n$-154.97\n\n    \n\n    \n\n      \nRatio Avg. Win:Avg. Loss\n\n      \n$1.18\n\n      \n$1.12\n\n      \n$1.21\n\n    \n\n    \n\n      \nLargest winning trade\n\n      \n$9500.14\n\n      \n$1623.24\n\n      \n$9500.14\n\n    \n\n    \n\n      \nLargest losing trade\n\n      \n$-22902.83\n\n      \n$-661.29\n\n      \n$-22902.83\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nDuration stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nAvg duration\n\n      \n13 days 03:21:49.653555\n\n      \n2 days 10:39:35.064935\n\n      \n15 days 18:53:36.628026\n\n    \n\n    \n\n      \nMedian duration\n\n      \n8 days 00:00:00\n\n      \n2 days 00:00:00\n\n      \n12 days 00:00:00\n\n    \n\n    \n\n      \nLongest duration\n\n      \n84 days 00:00:00\n\n      \n13 days 00:00:00\n\n      \n84 days 00:00:00\n\n    \n\n    \n\n      \nShortest duration\n\n      \n0 days 00:00:01\n\n      \n1 days 00:00:00\n\n      \n0 days 00:00:01\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nReturn stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nAvg returns all round_trips\n\n      \n0.01%\n\n      \n0.00%\n\n      \n0.01%\n\n    \n\n    \n\n      \nAvg returns winning\n\n      \n0.13%\n\n      \n0.03%\n\n      \n0.15%\n\n    \n\n    \n\n      \nAvg returns losing\n\n      \n-0.11%\n\n      \n-0.03%\n\n      \n-0.13%\n\n    \n\n    \n\n      \nMedian returns all round_trips\n\n      \n-0.00%\n\n      \n0.00%\n\n      \n-0.00%\n\n    \n\n    \n\n      \nMedian returns winning\n\n      \n0.02%\n\n      \n0.01%\n\n      \n0.03%\n\n    \n\n    \n\n      \nMedian returns losing\n\n      \n-0.01%\n\n      \n-0.00%\n\n      \n-0.02%\n\n    \n\n    \n\n      \nLargest winning trade\n\n      \n6.78%\n\n      \n1.37%\n\n      \n6.78%\n\n    \n\n    \n\n      \nLargest losing trade\n\n      \n-17.23%\n\n      \n-0.72%\n\n      \n-17.23%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nSymbol stats\n\n      \nAMD\n\n      \nCERN\n\n      \nCOST\n\n      \nDELL\n\n      \nGPS\n\n      \nINTC\n\n      \nMMM\n\n    \n\n  \n\n  \n\n    \n\n      \nAvg returns all round_trips\n\n      \n-0.00%\n\n      \n0.02%\n\n      \n0.02%\n\n      \n-0.03%\n\n      \n0.00%\n\n      \n0.02%\n\n      \n0.01%\n\n    \n\n    \n\n      \nAvg returns winning\n\n      \n0.20%\n\n      \n0.15%\n\n      \n0.10%\n\n      \n0.11%\n\n      \n0.10%\n\n      \n0.11%\n\n      \n0.10%\n\n    \n\n    \n\n      \nAvg returns losing\n\n      \n-0.19%\n\n      \n-0.13%\n\n      \n-0.07%\n\n      \n-0.15%\n\n      \n-0.09%\n\n      \n-0.06%\n\n      \n-0.09%\n\n    \n\n    \n\n      \nMedian returns all round_trips\n\n      \n-0.00%\n\n      \n0.00%\n\n      \n0.00%\n\n      \n-0.00%\n\n      \n-0.00%\n\n      \n-0.00%\n\n      \n0.00%\n\n    \n\n    \n\n      \nMedian returns winning\n\n      \n0.03%\n\n      \n0.02%\n\n      \n0.02%\n\n      \n0.02%\n\n      \n0.02%\n\n      \n0.01%\n\n      \n0.02%\n\n    \n\n    \n\n      \nMedian returns losing\n\n      \n-0.02%\n\n      \n-0.01%\n\n      \n-0.01%\n\n      \n-0.02%\n\n      \n-0.01%\n\n      \n-0.01%\n\n      \n-0.01%\n\n    \n\n    \n\n      \nLargest winning trade\n\n      \n6.78%\n\n      \n6.14%\n\n      \n3.96%\n\n      \n2.78%\n\n      \n1.80%\n\n      \n2.40%\n\n      \n2.45%\n\n    \n\n    \n\n      \nLargest losing trade\n\n      \n-17.23%\n\n      \n-3.92%\n\n      \n-2.32%\n\n      \n-6.39%\n\n      \n-6.86%\n\n      \n-4.45%\n\n      \n-1.79%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nProfitability (PnL / PnL total) per name\n\n      \n\n    \n\n    \n\n      \nsymbol\n\n      \n\n    \n\n  \n\n  \n\n    \n\n      \nCOST\n\n      \n39.90%\n\n    \n\n    \n\n      \nINTC\n\n      \n38.27%\n\n    \n\n    \n\n      \nCERN\n\n      \n32.31%\n\n    \n\n    \n\n      \nMMM\n\n      \n22.15%\n\n    \n\n    \n\n      \nGPS\n\n      \n4.94%\n\n    \n\n    \n\n      \nAMD\n\n      \n-6.41%\n\n    \n\n    \n\n      \nDELL\n\n      \n-31.15%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nProfitability (PnL / PnL total) per name\n\n      \n\n    \n\n    \n\n      \nsymbol\n\n      \n\n    \n\n  \n\n  \n\n    \n\n      \nConsumer Goods\n\n      \n39.90%\n\n    \n\n    \n\n      \nHealthcare\n\n      \n32.31%\n\n    \n\n    \n\n      \nConstruction\n\n      \n22.15%\n\n    \n\n    \n\n      \nTechnology\n\n      \n5.65%",
            "title": "Sector analysis"
        },
        {
            "location": "/notebooks/sector_mappings_example/#sector-mappings",
            "text": "To generate sector allocation plots in the positions tearsheet and PnL by sector in the round trips tearsheet, you must pass pyfolio a dictionary (or dict-like data structure) of symbol-sector mappings, where symbols are keys and sectors are values.  create_full_tearsheet  will also take symbol-sector mappings as the keyword argument  sector_mappings .  In this notebook, we generate the positions tear sheet and round-trip tear sheet with sector mappings.  import pyfolio as pf\nimport pandas as pd\n%matplotlib inline\nimport gzip\nimport os\n\n# silence warnings\nimport warnings\nwarnings.filterwarnings('ignore')  returns = pd.read_csv(gzip.open('../tests/test_data/test_returns.csv.gz'),\n                      index_col=0, parse_dates=True, header=None)[1]\npositions = pd.read_csv(gzip.open('../tests/test_data/test_pos.csv.gz'),\n                        index_col=0, parse_dates=True)\ntransactions = pd.read_csv(gzip.open('../tests/test_data/test_txn.csv.gz'),\n                           index_col=0, parse_dates=True)\n\nreturns.index = returns.index.tz_localize('UTC')\npositions.index = positions.index.tz_localize('UTC')\ntransactions.index = transactions.index.tz_localize('UTC')  positions.head()   \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       \n       AMD \n       CERN \n       COST \n       DELL \n       GPS \n       INTC \n       MMM \n       cash \n     \n     \n       index \n       \n       \n       \n       \n       \n       \n       \n       \n     \n   \n   \n     \n       2004-01-09 00:00:00+00:00 \n       6961.92 \n       21017.07875 \n       7282.266152 \n       21264.55188 \n       7091.080020 \n       21259.333890 \n       21316.129606 \n       -6192.360298 \n     \n     \n       2004-01-12 00:00:00+00:00 \n       18198.58 \n       18071.25000 \n       17675.836401 \n       10804.31924 \n       10685.411865 \n       17872.477480 \n       10882.026400 \n       -3329.289887 \n     \n     \n       2004-01-13 00:00:00+00:00 \n       12060.86 \n       11942.24625 \n       12838.477446 \n       16078.90380 \n       16272.139000 \n       12465.392511 \n       12579.135758 \n       4708.039735 \n     \n     \n       2004-01-14 00:00:00+00:00 \n       13102.40 \n       15534.28125 \n       14447.422640 \n       15414.45080 \n       15666.440185 \n       14884.069620 \n       13454.542620 \n       -2749.470030 \n     \n     \n       2004-01-15 00:00:00+00:00 \n       15518.40 \n       14547.05000 \n       14164.039680 \n       14407.48813 \n       14926.122619 \n       14422.385864 \n       13929.159049 \n       -2462.919316 \n     \n      # define our sector mappings\nsect_map = {'COST': 'Consumer Goods',\n            'INTC': 'Technology', \n            'CERN': 'Healthcare', \n            'GPS': 'Technology',\n            'MMM': 'Construction', \n            'DELL': 'Technology', \n            'AMD': 'Technology'}  pf.create_position_tear_sheet(returns, positions, sector_mappings=sect_map)   \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Top 10 long positions of all time \n       max \n     \n   \n   \n     \n       COST \n       90.01% \n     \n     \n       DELL \n       85.73% \n     \n     \n       CERN \n       83.53% \n     \n     \n       MMM \n       82.09% \n     \n     \n       INTC \n       78.59% \n     \n     \n       AMD \n       75.76% \n     \n     \n       GPS \n       62.24% \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Top 10 short positions of all time \n       max \n     \n   \n   \n     \n       AMD \n       -30.12% \n     \n     \n       DELL \n       -26.58% \n     \n     \n       CERN \n       -25.51% \n     \n     \n       MMM \n       -22.62% \n     \n     \n       GPS \n       -20.09% \n     \n     \n       INTC \n       -18.47% \n     \n     \n       COST \n       -16.44% \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Top 10 positions of all time \n       max \n     \n   \n   \n     \n       COST \n       90.01% \n     \n     \n       DELL \n       85.73% \n     \n     \n       CERN \n       83.53% \n     \n     \n       MMM \n       82.09% \n     \n     \n       INTC \n       78.59% \n     \n     \n       AMD \n       75.76% \n     \n     \n       GPS \n       62.24% \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       All positions ever held \n       max \n     \n   \n   \n     \n       COST \n       90.01% \n     \n     \n       DELL \n       85.73% \n     \n     \n       CERN \n       83.53% \n     \n     \n       MMM \n       82.09% \n     \n     \n       INTC \n       78.59% \n     \n     \n       AMD \n       75.76% \n     \n     \n       GPS \n       62.24% \n     \n       pf.create_round_trip_tear_sheet(returns, positions, transactions, sector_mappings=sect_map)   \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Summary stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Total number of round_trips \n       5822.00 \n       1155.00 \n       4667.00 \n     \n     \n       Percent profitable \n       0.50 \n       0.52 \n       0.49 \n     \n     \n       Winning round_trips \n       2887.00 \n       596.00 \n       2291.00 \n     \n     \n       Losing round_trips \n       2917.00 \n       553.00 \n       2364.00 \n     \n     \n       Even round_trips \n       18.00 \n       6.00 \n       12.00 \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       PnL stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Total profit \n       $65404.25 \n       $3560.10 \n       $61844.15 \n     \n     \n       Gross profit \n       $448803.34 \n       $20608.45 \n       $428194.89 \n     \n     \n       Gross loss \n       $-383399.09 \n       $-17048.35 \n       $-366350.75 \n     \n     \n       Profit factor \n       $1.17 \n       $1.21 \n       $1.17 \n     \n     \n       Avg. trade net profit \n       $11.23 \n       $3.08 \n       $13.25 \n     \n     \n       Avg. winning trade \n       $155.46 \n       $34.58 \n       $186.90 \n     \n     \n       Avg. losing trade \n       $-131.44 \n       $-30.83 \n       $-154.97 \n     \n     \n       Ratio Avg. Win:Avg. Loss \n       $1.18 \n       $1.12 \n       $1.21 \n     \n     \n       Largest winning trade \n       $9500.14 \n       $1623.24 \n       $9500.14 \n     \n     \n       Largest losing trade \n       $-22902.83 \n       $-661.29 \n       $-22902.83 \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Duration stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Avg duration \n       13 days 03:21:49.653555 \n       2 days 10:39:35.064935 \n       15 days 18:53:36.628026 \n     \n     \n       Median duration \n       8 days 00:00:00 \n       2 days 00:00:00 \n       12 days 00:00:00 \n     \n     \n       Longest duration \n       84 days 00:00:00 \n       13 days 00:00:00 \n       84 days 00:00:00 \n     \n     \n       Shortest duration \n       0 days 00:00:01 \n       1 days 00:00:00 \n       0 days 00:00:01 \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Return stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Avg returns all round_trips \n       0.01% \n       0.00% \n       0.01% \n     \n     \n       Avg returns winning \n       0.13% \n       0.03% \n       0.15% \n     \n     \n       Avg returns losing \n       -0.11% \n       -0.03% \n       -0.13% \n     \n     \n       Median returns all round_trips \n       -0.00% \n       0.00% \n       -0.00% \n     \n     \n       Median returns winning \n       0.02% \n       0.01% \n       0.03% \n     \n     \n       Median returns losing \n       -0.01% \n       -0.00% \n       -0.02% \n     \n     \n       Largest winning trade \n       6.78% \n       1.37% \n       6.78% \n     \n     \n       Largest losing trade \n       -17.23% \n       -0.72% \n       -17.23% \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Symbol stats \n       AMD \n       CERN \n       COST \n       DELL \n       GPS \n       INTC \n       MMM \n     \n   \n   \n     \n       Avg returns all round_trips \n       -0.00% \n       0.02% \n       0.02% \n       -0.03% \n       0.00% \n       0.02% \n       0.01% \n     \n     \n       Avg returns winning \n       0.20% \n       0.15% \n       0.10% \n       0.11% \n       0.10% \n       0.11% \n       0.10% \n     \n     \n       Avg returns losing \n       -0.19% \n       -0.13% \n       -0.07% \n       -0.15% \n       -0.09% \n       -0.06% \n       -0.09% \n     \n     \n       Median returns all round_trips \n       -0.00% \n       0.00% \n       0.00% \n       -0.00% \n       -0.00% \n       -0.00% \n       0.00% \n     \n     \n       Median returns winning \n       0.03% \n       0.02% \n       0.02% \n       0.02% \n       0.02% \n       0.01% \n       0.02% \n     \n     \n       Median returns losing \n       -0.02% \n       -0.01% \n       -0.01% \n       -0.02% \n       -0.01% \n       -0.01% \n       -0.01% \n     \n     \n       Largest winning trade \n       6.78% \n       6.14% \n       3.96% \n       2.78% \n       1.80% \n       2.40% \n       2.45% \n     \n     \n       Largest losing trade \n       -17.23% \n       -3.92% \n       -2.32% \n       -6.39% \n       -6.86% \n       -4.45% \n       -1.79% \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Profitability (PnL / PnL total) per name \n       \n     \n     \n       symbol \n       \n     \n   \n   \n     \n       COST \n       39.90% \n     \n     \n       INTC \n       38.27% \n     \n     \n       CERN \n       32.31% \n     \n     \n       MMM \n       22.15% \n     \n     \n       GPS \n       4.94% \n     \n     \n       AMD \n       -6.41% \n     \n     \n       DELL \n       -31.15% \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Profitability (PnL / PnL total) per name \n       \n     \n     \n       symbol \n       \n     \n   \n   \n     \n       Consumer Goods \n       39.90% \n     \n     \n       Healthcare \n       32.31% \n     \n     \n       Construction \n       22.15% \n     \n     \n       Technology \n       5.65%",
            "title": "Sector Mappings"
        },
        {
            "location": "/notebooks/round_trip_tear_sheet_example/",
            "text": "Round Trip Tear Sheet Example\n\n\nWhen evaluating the performance of an investing strategy, it is helpful to quantify the frequency, duration, and profitability of its independent bets, or \"round trip\" trades. A round trip trade is started when a new long or short position is opened and then later completely or partially closed out.\n\n\nThe intent of the round trip tearsheet is to help differentiate strategies that profited off a few lucky trades from strategies that profited repeatedly from genuine alpha. Breaking down round trip profitability by traded name and sector can also help inform universe selection and identify exposure risks. For example, even if your equity curve looks robust, if only two securities in your universe of fifteen names contributed to overall profitability, you may have reason to question the logic of your strategy.\n\n\nTo identify round trips, pyfolio reconstructs the complete portfolio based on the transactions that you pass in. When you make a trade, pyfolio checks if shares are already present in your portfolio purchased at a certain price. If there are, we compute the PnL, returns and duration of that round trip trade. In calculating round trips, pyfolio will also append position closing transactions at the last timestamp in the positions data. This closing transaction will cause the PnL from any open positions to realized as completed round trips.\n\n\nimport pyfolio as pf\n%matplotlib inline\nimport gzip\nimport os\nimport pandas as pd\n\n# silence warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\n\n\n\ntransactions = pd.read_csv(gzip.open('../tests/test_data/test_txn.csv.gz'),\n                    index_col=0, parse_dates=True)\npositions = pd.read_csv(gzip.open('../tests/test_data/test_pos.csv.gz'),\n                    index_col=0, parse_dates=True)\nreturns = pd.read_csv(gzip.open('../tests/test_data/test_returns.csv.gz'),\n                      index_col=0, parse_dates=True, header=None)[1]\n\n\n\n\n# Optional: Sector mappings may be passed in as a dict or pd.Series. If a mapping is\n# provided, PnL from symbols with mappings will be summed to display profitability by sector.\nsect_map = {'COST': 'Consumer Goods', 'INTC':'Technology', 'CERN':'Healthcare', 'GPS':'Technology',\n            'MMM': 'Construction', 'DELL': 'Technology', 'AMD':'Technology'}\n\n\n\n\nThe easiest way to run the analysis is to call \npyfolio.create_round_trip_tear_sheet()\n. Passing in a sector map is optional. You can also pass \nround_trips=True\n to \npyfolio.create_full_tear_sheet()\n to have this be created along all the other analyses.\n\n\npf.create_round_trip_tear_sheet(returns, positions, transactions, sector_mappings=sect_map)\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nSummary stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nTotal number of round_trips\n\n      \n5822.00\n\n      \n1155.00\n\n      \n4667.00\n\n    \n\n    \n\n      \nPercent profitable\n\n      \n0.50\n\n      \n0.52\n\n      \n0.49\n\n    \n\n    \n\n      \nWinning round_trips\n\n      \n2887.00\n\n      \n596.00\n\n      \n2291.00\n\n    \n\n    \n\n      \nLosing round_trips\n\n      \n2917.00\n\n      \n553.00\n\n      \n2364.00\n\n    \n\n    \n\n      \nEven round_trips\n\n      \n18.00\n\n      \n6.00\n\n      \n12.00\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nPnL stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nTotal profit\n\n      \n$65404.25\n\n      \n$3560.10\n\n      \n$61844.15\n\n    \n\n    \n\n      \nGross profit\n\n      \n$448803.34\n\n      \n$20608.45\n\n      \n$428194.89\n\n    \n\n    \n\n      \nGross loss\n\n      \n$-383399.09\n\n      \n$-17048.35\n\n      \n$-366350.75\n\n    \n\n    \n\n      \nProfit factor\n\n      \n$1.17\n\n      \n$1.21\n\n      \n$1.17\n\n    \n\n    \n\n      \nAvg. trade net profit\n\n      \n$11.23\n\n      \n$3.08\n\n      \n$13.25\n\n    \n\n    \n\n      \nAvg. winning trade\n\n      \n$155.46\n\n      \n$34.58\n\n      \n$186.90\n\n    \n\n    \n\n      \nAvg. losing trade\n\n      \n$-131.44\n\n      \n$-30.83\n\n      \n$-154.97\n\n    \n\n    \n\n      \nRatio Avg. Win:Avg. Loss\n\n      \n$1.18\n\n      \n$1.12\n\n      \n$1.21\n\n    \n\n    \n\n      \nLargest winning trade\n\n      \n$9500.14\n\n      \n$1623.24\n\n      \n$9500.14\n\n    \n\n    \n\n      \nLargest losing trade\n\n      \n$-22902.83\n\n      \n$-661.29\n\n      \n$-22902.83\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nDuration stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nAvg duration\n\n      \n13 days 03:21:49.653555\n\n      \n2 days 10:39:35.064935\n\n      \n15 days 18:53:36.628026\n\n    \n\n    \n\n      \nMedian duration\n\n      \n8 days 00:00:00\n\n      \n2 days 00:00:00\n\n      \n12 days 00:00:00\n\n    \n\n    \n\n      \nLongest duration\n\n      \n84 days 00:00:00\n\n      \n13 days 00:00:00\n\n      \n84 days 00:00:00\n\n    \n\n    \n\n      \nShortest duration\n\n      \n0 days 00:00:01\n\n      \n1 days 00:00:00\n\n      \n0 days 00:00:01\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nReturn stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nAvg returns all round_trips\n\n      \n0.01%\n\n      \n0.00%\n\n      \n0.01%\n\n    \n\n    \n\n      \nAvg returns winning\n\n      \n0.13%\n\n      \n0.03%\n\n      \n0.15%\n\n    \n\n    \n\n      \nAvg returns losing\n\n      \n-0.11%\n\n      \n-0.03%\n\n      \n-0.13%\n\n    \n\n    \n\n      \nMedian returns all round_trips\n\n      \n-0.00%\n\n      \n0.00%\n\n      \n-0.00%\n\n    \n\n    \n\n      \nMedian returns winning\n\n      \n0.02%\n\n      \n0.01%\n\n      \n0.03%\n\n    \n\n    \n\n      \nMedian returns losing\n\n      \n-0.01%\n\n      \n-0.00%\n\n      \n-0.02%\n\n    \n\n    \n\n      \nLargest winning trade\n\n      \n6.78%\n\n      \n1.37%\n\n      \n6.78%\n\n    \n\n    \n\n      \nLargest losing trade\n\n      \n-17.23%\n\n      \n-0.72%\n\n      \n-17.23%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nSymbol stats\n\n      \nAMD\n\n      \nCERN\n\n      \nCOST\n\n      \nDELL\n\n      \nGPS\n\n      \nINTC\n\n      \nMMM\n\n    \n\n  \n\n  \n\n    \n\n      \nAvg returns all round_trips\n\n      \n-0.00%\n\n      \n0.02%\n\n      \n0.02%\n\n      \n-0.03%\n\n      \n0.00%\n\n      \n0.02%\n\n      \n0.01%\n\n    \n\n    \n\n      \nAvg returns winning\n\n      \n0.20%\n\n      \n0.15%\n\n      \n0.10%\n\n      \n0.11%\n\n      \n0.10%\n\n      \n0.11%\n\n      \n0.10%\n\n    \n\n    \n\n      \nAvg returns losing\n\n      \n-0.19%\n\n      \n-0.13%\n\n      \n-0.07%\n\n      \n-0.15%\n\n      \n-0.09%\n\n      \n-0.06%\n\n      \n-0.09%\n\n    \n\n    \n\n      \nMedian returns all round_trips\n\n      \n-0.00%\n\n      \n0.00%\n\n      \n0.00%\n\n      \n-0.00%\n\n      \n-0.00%\n\n      \n-0.00%\n\n      \n0.00%\n\n    \n\n    \n\n      \nMedian returns winning\n\n      \n0.03%\n\n      \n0.02%\n\n      \n0.02%\n\n      \n0.02%\n\n      \n0.02%\n\n      \n0.01%\n\n      \n0.02%\n\n    \n\n    \n\n      \nMedian returns losing\n\n      \n-0.02%\n\n      \n-0.01%\n\n      \n-0.01%\n\n      \n-0.02%\n\n      \n-0.01%\n\n      \n-0.01%\n\n      \n-0.01%\n\n    \n\n    \n\n      \nLargest winning trade\n\n      \n6.78%\n\n      \n6.14%\n\n      \n3.96%\n\n      \n2.78%\n\n      \n1.80%\n\n      \n2.40%\n\n      \n2.45%\n\n    \n\n    \n\n      \nLargest losing trade\n\n      \n-17.23%\n\n      \n-3.92%\n\n      \n-2.32%\n\n      \n-6.39%\n\n      \n-6.86%\n\n      \n-4.45%\n\n      \n-1.79%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nProfitability (PnL / PnL total) per name\n\n      \n\n    \n\n    \n\n      \nsymbol\n\n      \n\n    \n\n  \n\n  \n\n    \n\n      \nCOST\n\n      \n39.90%\n\n    \n\n    \n\n      \nINTC\n\n      \n38.27%\n\n    \n\n    \n\n      \nCERN\n\n      \n32.31%\n\n    \n\n    \n\n      \nMMM\n\n      \n22.15%\n\n    \n\n    \n\n      \nGPS\n\n      \n4.94%\n\n    \n\n    \n\n      \nAMD\n\n      \n-6.41%\n\n    \n\n    \n\n      \nDELL\n\n      \n-31.15%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nProfitability (PnL / PnL total) per name\n\n      \n\n    \n\n    \n\n      \nsymbol\n\n      \n\n    \n\n  \n\n  \n\n    \n\n      \nConsumer Goods\n\n      \n39.90%\n\n    \n\n    \n\n      \nHealthcare\n\n      \n32.31%\n\n    \n\n    \n\n      \nConstruction\n\n      \n22.15%\n\n    \n\n    \n\n      \nTechnology\n\n      \n5.65%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\nUnder the hood, several functions are being called. \nextract_round_trips()\n does the portfolio reconstruction and creates the round-trip trades.\n\n\nrts = pf.round_trips.extract_round_trips(transactions, \n                                         portfolio_value=positions.sum(axis='columns') / (returns + 1))\n\n\n\n\nrts.head()\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \n\n      \nclose_dt\n\n      \nlong\n\n      \nopen_dt\n\n      \npnl\n\n      \nrt_returns\n\n      \nsymbol\n\n      \nduration\n\n      \nreturns\n\n    \n\n  \n\n  \n\n    \n\n      \n0\n\n      \n2004-01-13\n\n      \nTrue\n\n      \n2004-01-09\n\n      \n-126.000000\n\n      \n-0.022523\n\n      \nAMD\n\n      \n4 days\n\n      \n-0.001249\n\n    \n\n    \n\n      \n1\n\n      \n2004-01-16\n\n      \nTrue\n\n      \n2004-01-09\n\n      \n50.020000\n\n      \n0.078507\n\n      \nAMD\n\n      \n7 days\n\n      \n0.000503\n\n    \n\n    \n\n      \n2\n\n      \n2004-01-20\n\n      \nTrue\n\n      \n2004-01-09\n\n      \n1540.099065\n\n      \n0.104696\n\n      \nAMD\n\n      \n11 days\n\n      \n0.015257\n\n    \n\n    \n\n      \n3\n\n      \n2004-01-21\n\n      \nFalse\n\n      \n2004-01-20\n\n      \n287.119806\n\n      \n0.085155\n\n      \nAMD\n\n      \n1 days\n\n      \n0.002861\n\n    \n\n    \n\n      \n4\n\n      \n2004-01-22\n\n      \nFalse\n\n      \n2004-01-20\n\n      \n103.349947\n\n      \n0.112198\n\n      \nAMD\n\n      \n2 days\n\n      \n0.001032\n\n    \n\n  \n\n\n\n\n\n\n\npf.round_trips.print_round_trip_stats(rts)\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nSummary stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nTotal number of round_trips\n\n      \n5819.00\n\n      \n1155.00\n\n      \n4664.00\n\n    \n\n    \n\n      \nPercent profitable\n\n      \n0.50\n\n      \n0.52\n\n      \n0.49\n\n    \n\n    \n\n      \nWinning round_trips\n\n      \n2888.00\n\n      \n596.00\n\n      \n2292.00\n\n    \n\n    \n\n      \nLosing round_trips\n\n      \n2914.00\n\n      \n553.00\n\n      \n2361.00\n\n    \n\n    \n\n      \nEven round_trips\n\n      \n17.00\n\n      \n6.00\n\n      \n11.00\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nPnL stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nTotal profit\n\n      \n$67003.94\n\n      \n$3531.32\n\n      \n$63472.61\n\n    \n\n    \n\n      \nGross profit\n\n      \n$448674.42\n\n      \n$20579.67\n\n      \n$428094.75\n\n    \n\n    \n\n      \nGross loss\n\n      \n$-381670.48\n\n      \n$-17048.35\n\n      \n$-364622.13\n\n    \n\n    \n\n      \nProfit factor\n\n      \n$1.18\n\n      \n$1.21\n\n      \n$1.17\n\n    \n\n    \n\n      \nAvg. trade net profit\n\n      \n$11.51\n\n      \n$3.06\n\n      \n$13.61\n\n    \n\n    \n\n      \nAvg. winning trade\n\n      \n$155.36\n\n      \n$34.53\n\n      \n$186.78\n\n    \n\n    \n\n      \nAvg. losing trade\n\n      \n$-130.98\n\n      \n$-30.83\n\n      \n$-154.44\n\n    \n\n    \n\n      \nRatio Avg. Win:Avg. Loss\n\n      \n$1.19\n\n      \n$1.12\n\n      \n$1.21\n\n    \n\n    \n\n      \nLargest winning trade\n\n      \n$9500.14\n\n      \n$1623.24\n\n      \n$9500.14\n\n    \n\n    \n\n      \nLargest losing trade\n\n      \n$-22902.83\n\n      \n$-661.29\n\n      \n$-22902.83\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nDuration stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nAvg duration\n\n      \n13 days 03:27:07.702354\n\n      \n2 days 10:39:35.064935\n\n      \n15 days 19:02:40.548885\n\n    \n\n    \n\n      \nMedian duration\n\n      \n8 days 00:00:00\n\n      \n2 days 00:00:00\n\n      \n12 days 00:00:00\n\n    \n\n    \n\n      \nLongest duration\n\n      \n84 days 00:00:00\n\n      \n13 days 00:00:00\n\n      \n84 days 00:00:00\n\n    \n\n    \n\n      \nShortest duration\n\n      \n1 days 00:00:00\n\n      \n1 days 00:00:00\n\n      \n1 days 00:00:00\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nReturn stats\n\n      \nAll trades\n\n      \nShort trades\n\n      \nLong trades\n\n    \n\n  \n\n  \n\n    \n\n      \nAvg returns all round_trips\n\n      \n0.01%\n\n      \n0.00%\n\n      \n0.01%\n\n    \n\n    \n\n      \nAvg returns winning\n\n      \n0.13%\n\n      \n0.03%\n\n      \n0.15%\n\n    \n\n    \n\n      \nAvg returns losing\n\n      \n-0.11%\n\n      \n-0.03%\n\n      \n-0.13%\n\n    \n\n    \n\n      \nMedian returns all round_trips\n\n      \n-0.00%\n\n      \n0.00%\n\n      \n-0.00%\n\n    \n\n    \n\n      \nMedian returns winning\n\n      \n0.02%\n\n      \n0.01%\n\n      \n0.03%\n\n    \n\n    \n\n      \nMedian returns losing\n\n      \n-0.01%\n\n      \n-0.00%\n\n      \n-0.02%\n\n    \n\n    \n\n      \nLargest winning trade\n\n      \n6.78%\n\n      \n1.37%\n\n      \n6.78%\n\n    \n\n    \n\n      \nLargest losing trade\n\n      \n-17.23%\n\n      \n-0.72%\n\n      \n-17.23%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nSymbol stats\n\n      \nAMD\n\n      \nCERN\n\n      \nCOST\n\n      \nDELL\n\n      \nGPS\n\n      \nINTC\n\n      \nMMM\n\n    \n\n  \n\n  \n\n    \n\n      \nAvg returns all round_trips\n\n      \n-0.00%\n\n      \n0.02%\n\n      \n0.02%\n\n      \n-0.03%\n\n      \n0.00%\n\n      \n0.02%\n\n      \n0.01%\n\n    \n\n    \n\n      \nAvg returns winning\n\n      \n0.20%\n\n      \n0.15%\n\n      \n0.10%\n\n      \n0.11%\n\n      \n0.10%\n\n      \n0.11%\n\n      \n0.10%\n\n    \n\n    \n\n      \nAvg returns losing\n\n      \n-0.19%\n\n      \n-0.13%\n\n      \n-0.07%\n\n      \n-0.15%\n\n      \n-0.09%\n\n      \n-0.06%\n\n      \n-0.09%\n\n    \n\n    \n\n      \nMedian returns all round_trips\n\n      \n-0.00%\n\n      \n0.00%\n\n      \n0.00%\n\n      \n-0.00%\n\n      \n-0.00%\n\n      \n-0.00%\n\n      \n0.00%\n\n    \n\n    \n\n      \nMedian returns winning\n\n      \n0.03%\n\n      \n0.02%\n\n      \n0.02%\n\n      \n0.02%\n\n      \n0.02%\n\n      \n0.01%\n\n      \n0.02%\n\n    \n\n    \n\n      \nMedian returns losing\n\n      \n-0.02%\n\n      \n-0.01%\n\n      \n-0.01%\n\n      \n-0.02%\n\n      \n-0.01%\n\n      \n-0.01%\n\n      \n-0.01%\n\n    \n\n    \n\n      \nLargest winning trade\n\n      \n6.78%\n\n      \n6.14%\n\n      \n3.96%\n\n      \n2.78%\n\n      \n1.80%\n\n      \n2.40%\n\n      \n2.45%\n\n    \n\n    \n\n      \nLargest losing trade\n\n      \n-17.23%\n\n      \n-3.92%\n\n      \n-2.32%\n\n      \n-6.39%\n\n      \n-6.86%\n\n      \n-4.45%\n\n      \n-1.79%",
            "title": "Round trip analysis"
        },
        {
            "location": "/notebooks/round_trip_tear_sheet_example/#round-trip-tear-sheet-example",
            "text": "When evaluating the performance of an investing strategy, it is helpful to quantify the frequency, duration, and profitability of its independent bets, or \"round trip\" trades. A round trip trade is started when a new long or short position is opened and then later completely or partially closed out.  The intent of the round trip tearsheet is to help differentiate strategies that profited off a few lucky trades from strategies that profited repeatedly from genuine alpha. Breaking down round trip profitability by traded name and sector can also help inform universe selection and identify exposure risks. For example, even if your equity curve looks robust, if only two securities in your universe of fifteen names contributed to overall profitability, you may have reason to question the logic of your strategy.  To identify round trips, pyfolio reconstructs the complete portfolio based on the transactions that you pass in. When you make a trade, pyfolio checks if shares are already present in your portfolio purchased at a certain price. If there are, we compute the PnL, returns and duration of that round trip trade. In calculating round trips, pyfolio will also append position closing transactions at the last timestamp in the positions data. This closing transaction will cause the PnL from any open positions to realized as completed round trips.  import pyfolio as pf\n%matplotlib inline\nimport gzip\nimport os\nimport pandas as pd\n\n# silence warnings\nimport warnings\nwarnings.filterwarnings('ignore')  transactions = pd.read_csv(gzip.open('../tests/test_data/test_txn.csv.gz'),\n                    index_col=0, parse_dates=True)\npositions = pd.read_csv(gzip.open('../tests/test_data/test_pos.csv.gz'),\n                    index_col=0, parse_dates=True)\nreturns = pd.read_csv(gzip.open('../tests/test_data/test_returns.csv.gz'),\n                      index_col=0, parse_dates=True, header=None)[1]  # Optional: Sector mappings may be passed in as a dict or pd.Series. If a mapping is\n# provided, PnL from symbols with mappings will be summed to display profitability by sector.\nsect_map = {'COST': 'Consumer Goods', 'INTC':'Technology', 'CERN':'Healthcare', 'GPS':'Technology',\n            'MMM': 'Construction', 'DELL': 'Technology', 'AMD':'Technology'}  The easiest way to run the analysis is to call  pyfolio.create_round_trip_tear_sheet() . Passing in a sector map is optional. You can also pass  round_trips=True  to  pyfolio.create_full_tear_sheet()  to have this be created along all the other analyses.  pf.create_round_trip_tear_sheet(returns, positions, transactions, sector_mappings=sect_map)   \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Summary stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Total number of round_trips \n       5822.00 \n       1155.00 \n       4667.00 \n     \n     \n       Percent profitable \n       0.50 \n       0.52 \n       0.49 \n     \n     \n       Winning round_trips \n       2887.00 \n       596.00 \n       2291.00 \n     \n     \n       Losing round_trips \n       2917.00 \n       553.00 \n       2364.00 \n     \n     \n       Even round_trips \n       18.00 \n       6.00 \n       12.00 \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       PnL stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Total profit \n       $65404.25 \n       $3560.10 \n       $61844.15 \n     \n     \n       Gross profit \n       $448803.34 \n       $20608.45 \n       $428194.89 \n     \n     \n       Gross loss \n       $-383399.09 \n       $-17048.35 \n       $-366350.75 \n     \n     \n       Profit factor \n       $1.17 \n       $1.21 \n       $1.17 \n     \n     \n       Avg. trade net profit \n       $11.23 \n       $3.08 \n       $13.25 \n     \n     \n       Avg. winning trade \n       $155.46 \n       $34.58 \n       $186.90 \n     \n     \n       Avg. losing trade \n       $-131.44 \n       $-30.83 \n       $-154.97 \n     \n     \n       Ratio Avg. Win:Avg. Loss \n       $1.18 \n       $1.12 \n       $1.21 \n     \n     \n       Largest winning trade \n       $9500.14 \n       $1623.24 \n       $9500.14 \n     \n     \n       Largest losing trade \n       $-22902.83 \n       $-661.29 \n       $-22902.83 \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Duration stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Avg duration \n       13 days 03:21:49.653555 \n       2 days 10:39:35.064935 \n       15 days 18:53:36.628026 \n     \n     \n       Median duration \n       8 days 00:00:00 \n       2 days 00:00:00 \n       12 days 00:00:00 \n     \n     \n       Longest duration \n       84 days 00:00:00 \n       13 days 00:00:00 \n       84 days 00:00:00 \n     \n     \n       Shortest duration \n       0 days 00:00:01 \n       1 days 00:00:00 \n       0 days 00:00:01 \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Return stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Avg returns all round_trips \n       0.01% \n       0.00% \n       0.01% \n     \n     \n       Avg returns winning \n       0.13% \n       0.03% \n       0.15% \n     \n     \n       Avg returns losing \n       -0.11% \n       -0.03% \n       -0.13% \n     \n     \n       Median returns all round_trips \n       -0.00% \n       0.00% \n       -0.00% \n     \n     \n       Median returns winning \n       0.02% \n       0.01% \n       0.03% \n     \n     \n       Median returns losing \n       -0.01% \n       -0.00% \n       -0.02% \n     \n     \n       Largest winning trade \n       6.78% \n       1.37% \n       6.78% \n     \n     \n       Largest losing trade \n       -17.23% \n       -0.72% \n       -17.23% \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Symbol stats \n       AMD \n       CERN \n       COST \n       DELL \n       GPS \n       INTC \n       MMM \n     \n   \n   \n     \n       Avg returns all round_trips \n       -0.00% \n       0.02% \n       0.02% \n       -0.03% \n       0.00% \n       0.02% \n       0.01% \n     \n     \n       Avg returns winning \n       0.20% \n       0.15% \n       0.10% \n       0.11% \n       0.10% \n       0.11% \n       0.10% \n     \n     \n       Avg returns losing \n       -0.19% \n       -0.13% \n       -0.07% \n       -0.15% \n       -0.09% \n       -0.06% \n       -0.09% \n     \n     \n       Median returns all round_trips \n       -0.00% \n       0.00% \n       0.00% \n       -0.00% \n       -0.00% \n       -0.00% \n       0.00% \n     \n     \n       Median returns winning \n       0.03% \n       0.02% \n       0.02% \n       0.02% \n       0.02% \n       0.01% \n       0.02% \n     \n     \n       Median returns losing \n       -0.02% \n       -0.01% \n       -0.01% \n       -0.02% \n       -0.01% \n       -0.01% \n       -0.01% \n     \n     \n       Largest winning trade \n       6.78% \n       6.14% \n       3.96% \n       2.78% \n       1.80% \n       2.40% \n       2.45% \n     \n     \n       Largest losing trade \n       -17.23% \n       -3.92% \n       -2.32% \n       -6.39% \n       -6.86% \n       -4.45% \n       -1.79% \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Profitability (PnL / PnL total) per name \n       \n     \n     \n       symbol \n       \n     \n   \n   \n     \n       COST \n       39.90% \n     \n     \n       INTC \n       38.27% \n     \n     \n       CERN \n       32.31% \n     \n     \n       MMM \n       22.15% \n     \n     \n       GPS \n       4.94% \n     \n     \n       AMD \n       -6.41% \n     \n     \n       DELL \n       -31.15% \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Profitability (PnL / PnL total) per name \n       \n     \n     \n       symbol \n       \n     \n   \n   \n     \n       Consumer Goods \n       39.90% \n     \n     \n       Healthcare \n       32.31% \n     \n     \n       Construction \n       22.15% \n     \n     \n       Technology \n       5.65% \n     \n       Under the hood, several functions are being called.  extract_round_trips()  does the portfolio reconstruction and creates the round-trip trades.  rts = pf.round_trips.extract_round_trips(transactions, \n                                         portfolio_value=positions.sum(axis='columns') / (returns + 1))  rts.head()   \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       \n       close_dt \n       long \n       open_dt \n       pnl \n       rt_returns \n       symbol \n       duration \n       returns \n     \n   \n   \n     \n       0 \n       2004-01-13 \n       True \n       2004-01-09 \n       -126.000000 \n       -0.022523 \n       AMD \n       4 days \n       -0.001249 \n     \n     \n       1 \n       2004-01-16 \n       True \n       2004-01-09 \n       50.020000 \n       0.078507 \n       AMD \n       7 days \n       0.000503 \n     \n     \n       2 \n       2004-01-20 \n       True \n       2004-01-09 \n       1540.099065 \n       0.104696 \n       AMD \n       11 days \n       0.015257 \n     \n     \n       3 \n       2004-01-21 \n       False \n       2004-01-20 \n       287.119806 \n       0.085155 \n       AMD \n       1 days \n       0.002861 \n     \n     \n       4 \n       2004-01-22 \n       False \n       2004-01-20 \n       103.349947 \n       0.112198 \n       AMD \n       2 days \n       0.001032 \n     \n      pf.round_trips.print_round_trip_stats(rts)   \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Summary stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Total number of round_trips \n       5819.00 \n       1155.00 \n       4664.00 \n     \n     \n       Percent profitable \n       0.50 \n       0.52 \n       0.49 \n     \n     \n       Winning round_trips \n       2888.00 \n       596.00 \n       2292.00 \n     \n     \n       Losing round_trips \n       2914.00 \n       553.00 \n       2361.00 \n     \n     \n       Even round_trips \n       17.00 \n       6.00 \n       11.00 \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       PnL stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Total profit \n       $67003.94 \n       $3531.32 \n       $63472.61 \n     \n     \n       Gross profit \n       $448674.42 \n       $20579.67 \n       $428094.75 \n     \n     \n       Gross loss \n       $-381670.48 \n       $-17048.35 \n       $-364622.13 \n     \n     \n       Profit factor \n       $1.18 \n       $1.21 \n       $1.17 \n     \n     \n       Avg. trade net profit \n       $11.51 \n       $3.06 \n       $13.61 \n     \n     \n       Avg. winning trade \n       $155.36 \n       $34.53 \n       $186.78 \n     \n     \n       Avg. losing trade \n       $-130.98 \n       $-30.83 \n       $-154.44 \n     \n     \n       Ratio Avg. Win:Avg. Loss \n       $1.19 \n       $1.12 \n       $1.21 \n     \n     \n       Largest winning trade \n       $9500.14 \n       $1623.24 \n       $9500.14 \n     \n     \n       Largest losing trade \n       $-22902.83 \n       $-661.29 \n       $-22902.83 \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Duration stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Avg duration \n       13 days 03:27:07.702354 \n       2 days 10:39:35.064935 \n       15 days 19:02:40.548885 \n     \n     \n       Median duration \n       8 days 00:00:00 \n       2 days 00:00:00 \n       12 days 00:00:00 \n     \n     \n       Longest duration \n       84 days 00:00:00 \n       13 days 00:00:00 \n       84 days 00:00:00 \n     \n     \n       Shortest duration \n       1 days 00:00:00 \n       1 days 00:00:00 \n       1 days 00:00:00 \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Return stats \n       All trades \n       Short trades \n       Long trades \n     \n   \n   \n     \n       Avg returns all round_trips \n       0.01% \n       0.00% \n       0.01% \n     \n     \n       Avg returns winning \n       0.13% \n       0.03% \n       0.15% \n     \n     \n       Avg returns losing \n       -0.11% \n       -0.03% \n       -0.13% \n     \n     \n       Median returns all round_trips \n       -0.00% \n       0.00% \n       -0.00% \n     \n     \n       Median returns winning \n       0.02% \n       0.01% \n       0.03% \n     \n     \n       Median returns losing \n       -0.01% \n       -0.00% \n       -0.02% \n     \n     \n       Largest winning trade \n       6.78% \n       1.37% \n       6.78% \n     \n     \n       Largest losing trade \n       -17.23% \n       -0.72% \n       -17.23% \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Symbol stats \n       AMD \n       CERN \n       COST \n       DELL \n       GPS \n       INTC \n       MMM \n     \n   \n   \n     \n       Avg returns all round_trips \n       -0.00% \n       0.02% \n       0.02% \n       -0.03% \n       0.00% \n       0.02% \n       0.01% \n     \n     \n       Avg returns winning \n       0.20% \n       0.15% \n       0.10% \n       0.11% \n       0.10% \n       0.11% \n       0.10% \n     \n     \n       Avg returns losing \n       -0.19% \n       -0.13% \n       -0.07% \n       -0.15% \n       -0.09% \n       -0.06% \n       -0.09% \n     \n     \n       Median returns all round_trips \n       -0.00% \n       0.00% \n       0.00% \n       -0.00% \n       -0.00% \n       -0.00% \n       0.00% \n     \n     \n       Median returns winning \n       0.03% \n       0.02% \n       0.02% \n       0.02% \n       0.02% \n       0.01% \n       0.02% \n     \n     \n       Median returns losing \n       -0.02% \n       -0.01% \n       -0.01% \n       -0.02% \n       -0.01% \n       -0.01% \n       -0.01% \n     \n     \n       Largest winning trade \n       6.78% \n       6.14% \n       3.96% \n       2.78% \n       1.80% \n       2.40% \n       2.45% \n     \n     \n       Largest losing trade \n       -17.23% \n       -3.92% \n       -2.32% \n       -6.39% \n       -6.86% \n       -4.45% \n       -1.79%",
            "title": "Round Trip Tear Sheet Example"
        },
        {
            "location": "/notebooks/slippage_example/",
            "text": "Slippage Analysis\n\n\nWhen evaluating a strategy using backtest results, we often want to know how sensitive it's performance is to implementation shortfall or slippage. pyfolio's transactions tear sheet can create \"slippage sweep\" plots that display strategy performance under various slippage assumptions. \n\n\nAdditional per-dollar slippage can be applied to returns before running a tear sheet by providing \ncreate_full_tear_sheet\n with the a level of slippage in basis points (1% == 100 basis points) as the \nslippage\n keyword argument. The slippage plots in the transactions tear sheet will display returns with slippage added to the \nunadjusted\n returns. \n\n\nFor example, if you run a backtest with no transaction costs and call \ncreate_full_tear_sheet(returns, positions, transactions, slippage=5)\n, 5 bps of slippage will be applied to \nreturns\n before all plots and figures, with the exception of the slippage sweep plots, are generated.\n\n\nIt is important to emphasize that the slippage plots will display performance under \nadditional\n slippage. If the passed performance data already has slippage applied, the 5 bps slippage equity curve will represent performance under 5 bps of slippage in addition to the already simulated slippage penalty. If slippage is already applied to the performance results, pass \nslippage=0\n to the \ncreate_full_tear_sheet\n to trigger the creation of the additional slippage sweep plots without applying any additional slippage to the returns time series used throughout the rest of the tear sheet.\n\n\n%matplotlib inline\nimport pyfolio as pf\nimport gzip\nimport pandas as pd\n\n# silence warnings\nimport warnings\nwarnings.filterwarnings('ignore')\n\n\n\n\ntransactions = pd.read_csv(gzip.open('../tests/test_data/test_txn.csv.gz'),\n                    index_col=0, parse_dates=True)\npositions = pd.read_csv(gzip.open('../tests/test_data/test_pos.csv.gz'),\n                    index_col=0, parse_dates=True)\nreturns = pd.read_csv(gzip.open('../tests/test_data/test_returns.csv.gz'),\n                    index_col=0, parse_dates=True, header=None)[1]\nreturns.index = returns.index.tz_localize(\"UTC\")\npositions.index = positions.index.tz_localize(\"UTC\")\ntransactions.index = transactions.index.tz_localize(\"UTC\")\n\n\n\n\npf.create_full_tear_sheet(returns, positions, transactions, slippage=0)\n\n\n\n\nEntire data start date: 2004-01-09\nEntire data end date: 2009-12-31\nBacktest months: 71\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \n\n      \nBacktest\n\n    \n\n  \n\n  \n\n    \n\n      \nAnnual return\n\n      \n8.8%\n\n    \n\n    \n\n      \nCumulative returns\n\n      \n65.4%\n\n    \n\n    \n\n      \nAnnual volatility\n\n      \n26.3%\n\n    \n\n    \n\n      \nSharpe ratio\n\n      \n0.45\n\n    \n\n    \n\n      \nCalmar ratio\n\n      \n0.15\n\n    \n\n    \n\n      \nStability\n\n      \n0.00\n\n    \n\n    \n\n      \nMax drawdown\n\n      \n-60.4%\n\n    \n\n    \n\n      \nOmega ratio\n\n      \n1.09\n\n    \n\n    \n\n      \nSortino ratio\n\n      \n0.66\n\n    \n\n    \n\n      \nSkew\n\n      \n0.14\n\n    \n\n    \n\n      \nKurtosis\n\n      \n5.88\n\n    \n\n    \n\n      \nTail ratio\n\n      \n0.99\n\n    \n\n    \n\n      \nDaily value at risk\n\n      \n-3.3%\n\n    \n\n    \n\n      \nGross leverage\n\n      \n1.03\n\n    \n\n    \n\n      \nDaily turnover\n\n      \n11.1%\n\n    \n\n    \n\n      \nAlpha\n\n      \n0.08\n\n    \n\n    \n\n      \nBeta\n\n      \n0.83\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nWorst drawdown periods\n\n      \nNet drawdown in %\n\n      \nPeak date\n\n      \nValley date\n\n      \nRecovery date\n\n      \nDuration\n\n    \n\n  \n\n  \n\n    \n\n      \n0\n\n      \n60.39\n\n      \n2007-11-06\n\n      \n2009-03-09\n\n      \nNaT\n\n      \nNaN\n\n    \n\n    \n\n      \n1\n\n      \n24.10\n\n      \n2005-07-28\n\n      \n2006-09-07\n\n      \n2007-05-22\n\n      \n474\n\n    \n\n    \n\n      \n2\n\n      \n11.89\n\n      \n2004-06-25\n\n      \n2004-08-12\n\n      \n2004-11-05\n\n      \n96\n\n    \n\n    \n\n      \n3\n\n      \n10.87\n\n      \n2004-11-15\n\n      \n2005-04-18\n\n      \n2005-07-14\n\n      \n174\n\n    \n\n    \n\n      \n4\n\n      \n9.51\n\n      \n2007-07-16\n\n      \n2007-08-06\n\n      \n2007-09-13\n\n      \n44\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nStress Events\n\n      \nmean\n\n      \nmin\n\n      \nmax\n\n    \n\n  \n\n  \n\n    \n\n      \nLehmann\n\n      \n-0.27%\n\n      \n-4.70%\n\n      \n4.11%\n\n    \n\n    \n\n      \nAug07\n\n      \n0.32%\n\n      \n-2.96%\n\n      \n2.92%\n\n    \n\n    \n\n      \nMar08\n\n      \n-0.43%\n\n      \n-3.26%\n\n      \n3.36%\n\n    \n\n    \n\n      \nSept08\n\n      \n-0.68%\n\n      \n-4.38%\n\n      \n4.08%\n\n    \n\n    \n\n      \n2009Q1\n\n      \n-0.36%\n\n      \n-5.02%\n\n      \n3.39%\n\n    \n\n    \n\n      \n2009Q2\n\n      \n0.74%\n\n      \n-4.03%\n\n      \n6.13%\n\n    \n\n    \n\n      \nLow Volatility Bull Market\n\n      \n0.01%\n\n      \n-6.07%\n\n      \n6.43%\n\n    \n\n    \n\n      \nGFC Crash\n\n      \n-0.09%\n\n      \n-11.76%\n\n      \n10.13%\n\n    \n\n    \n\n      \nRecovery\n\n      \n0.35%\n\n      \n-4.03%\n\n      \n6.01%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nTop 10 long positions of all time\n\n      \nmax\n\n    \n\n  \n\n  \n\n    \n\n      \nCOST\n\n      \n90.01%\n\n    \n\n    \n\n      \nDELL\n\n      \n85.73%\n\n    \n\n    \n\n      \nCERN\n\n      \n83.53%\n\n    \n\n    \n\n      \nMMM\n\n      \n82.09%\n\n    \n\n    \n\n      \nINTC\n\n      \n78.59%\n\n    \n\n    \n\n      \nAMD\n\n      \n75.76%\n\n    \n\n    \n\n      \nGPS\n\n      \n62.24%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nTop 10 short positions of all time\n\n      \nmax\n\n    \n\n  \n\n  \n\n    \n\n      \nAMD\n\n      \n-30.12%\n\n    \n\n    \n\n      \nDELL\n\n      \n-26.58%\n\n    \n\n    \n\n      \nCERN\n\n      \n-25.51%\n\n    \n\n    \n\n      \nMMM\n\n      \n-22.62%\n\n    \n\n    \n\n      \nGPS\n\n      \n-20.09%\n\n    \n\n    \n\n      \nINTC\n\n      \n-18.47%\n\n    \n\n    \n\n      \nCOST\n\n      \n-16.44%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nTop 10 positions of all time\n\n      \nmax\n\n    \n\n  \n\n  \n\n    \n\n      \nCOST\n\n      \n90.01%\n\n    \n\n    \n\n      \nDELL\n\n      \n85.73%\n\n    \n\n    \n\n      \nCERN\n\n      \n83.53%\n\n    \n\n    \n\n      \nMMM\n\n      \n82.09%\n\n    \n\n    \n\n      \nINTC\n\n      \n78.59%\n\n    \n\n    \n\n      \nAMD\n\n      \n75.76%\n\n    \n\n    \n\n      \nGPS\n\n      \n62.24%\n\n    \n\n  \n\n\n\n\n\n\n\n\n\n\n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n\n\n\n  \n\n    \n\n      \nAll positions ever held\n\n      \nmax\n\n    \n\n  \n\n  \n\n    \n\n      \nCOST\n\n      \n90.01%\n\n    \n\n    \n\n      \nDELL\n\n      \n85.73%\n\n    \n\n    \n\n      \nCERN\n\n      \n83.53%\n\n    \n\n    \n\n      \nMMM\n\n      \n82.09%\n\n    \n\n    \n\n      \nINTC\n\n      \n78.59%\n\n    \n\n    \n\n      \nAMD\n\n      \n75.76%\n\n    \n\n    \n\n      \nGPS\n\n      \n62.24%",
            "title": "Slippage analysis"
        },
        {
            "location": "/notebooks/slippage_example/#slippage-analysis",
            "text": "When evaluating a strategy using backtest results, we often want to know how sensitive it's performance is to implementation shortfall or slippage. pyfolio's transactions tear sheet can create \"slippage sweep\" plots that display strategy performance under various slippage assumptions.   Additional per-dollar slippage can be applied to returns before running a tear sheet by providing  create_full_tear_sheet  with the a level of slippage in basis points (1% == 100 basis points) as the  slippage  keyword argument. The slippage plots in the transactions tear sheet will display returns with slippage added to the  unadjusted  returns.   For example, if you run a backtest with no transaction costs and call  create_full_tear_sheet(returns, positions, transactions, slippage=5) , 5 bps of slippage will be applied to  returns  before all plots and figures, with the exception of the slippage sweep plots, are generated.  It is important to emphasize that the slippage plots will display performance under  additional  slippage. If the passed performance data already has slippage applied, the 5 bps slippage equity curve will represent performance under 5 bps of slippage in addition to the already simulated slippage penalty. If slippage is already applied to the performance results, pass  slippage=0  to the  create_full_tear_sheet  to trigger the creation of the additional slippage sweep plots without applying any additional slippage to the returns time series used throughout the rest of the tear sheet.  %matplotlib inline\nimport pyfolio as pf\nimport gzip\nimport pandas as pd\n\n# silence warnings\nimport warnings\nwarnings.filterwarnings('ignore')  transactions = pd.read_csv(gzip.open('../tests/test_data/test_txn.csv.gz'),\n                    index_col=0, parse_dates=True)\npositions = pd.read_csv(gzip.open('../tests/test_data/test_pos.csv.gz'),\n                    index_col=0, parse_dates=True)\nreturns = pd.read_csv(gzip.open('../tests/test_data/test_returns.csv.gz'),\n                    index_col=0, parse_dates=True, header=None)[1]\nreturns.index = returns.index.tz_localize(\"UTC\")\npositions.index = positions.index.tz_localize(\"UTC\")\ntransactions.index = transactions.index.tz_localize(\"UTC\")  pf.create_full_tear_sheet(returns, positions, transactions, slippage=0)  Entire data start date: 2004-01-09\nEntire data end date: 2009-12-31\nBacktest months: 71   \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       \n       Backtest \n     \n   \n   \n     \n       Annual return \n       8.8% \n     \n     \n       Cumulative returns \n       65.4% \n     \n     \n       Annual volatility \n       26.3% \n     \n     \n       Sharpe ratio \n       0.45 \n     \n     \n       Calmar ratio \n       0.15 \n     \n     \n       Stability \n       0.00 \n     \n     \n       Max drawdown \n       -60.4% \n     \n     \n       Omega ratio \n       1.09 \n     \n     \n       Sortino ratio \n       0.66 \n     \n     \n       Skew \n       0.14 \n     \n     \n       Kurtosis \n       5.88 \n     \n     \n       Tail ratio \n       0.99 \n     \n     \n       Daily value at risk \n       -3.3% \n     \n     \n       Gross leverage \n       1.03 \n     \n     \n       Daily turnover \n       11.1% \n     \n     \n       Alpha \n       0.08 \n     \n     \n       Beta \n       0.83 \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Worst drawdown periods \n       Net drawdown in % \n       Peak date \n       Valley date \n       Recovery date \n       Duration \n     \n   \n   \n     \n       0 \n       60.39 \n       2007-11-06 \n       2009-03-09 \n       NaT \n       NaN \n     \n     \n       1 \n       24.10 \n       2005-07-28 \n       2006-09-07 \n       2007-05-22 \n       474 \n     \n     \n       2 \n       11.89 \n       2004-06-25 \n       2004-08-12 \n       2004-11-05 \n       96 \n     \n     \n       3 \n       10.87 \n       2004-11-15 \n       2005-04-18 \n       2005-07-14 \n       174 \n     \n     \n       4 \n       9.51 \n       2007-07-16 \n       2007-08-06 \n       2007-09-13 \n       44 \n     \n        \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Stress Events \n       mean \n       min \n       max \n     \n   \n   \n     \n       Lehmann \n       -0.27% \n       -4.70% \n       4.11% \n     \n     \n       Aug07 \n       0.32% \n       -2.96% \n       2.92% \n     \n     \n       Mar08 \n       -0.43% \n       -3.26% \n       3.36% \n     \n     \n       Sept08 \n       -0.68% \n       -4.38% \n       4.08% \n     \n     \n       2009Q1 \n       -0.36% \n       -5.02% \n       3.39% \n     \n     \n       2009Q2 \n       0.74% \n       -4.03% \n       6.13% \n     \n     \n       Low Volatility Bull Market \n       0.01% \n       -6.07% \n       6.43% \n     \n     \n       GFC Crash \n       -0.09% \n       -11.76% \n       10.13% \n     \n     \n       Recovery \n       0.35% \n       -4.03% \n       6.01% \n     \n        \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Top 10 long positions of all time \n       max \n     \n   \n   \n     \n       COST \n       90.01% \n     \n     \n       DELL \n       85.73% \n     \n     \n       CERN \n       83.53% \n     \n     \n       MMM \n       82.09% \n     \n     \n       INTC \n       78.59% \n     \n     \n       AMD \n       75.76% \n     \n     \n       GPS \n       62.24% \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Top 10 short positions of all time \n       max \n     \n   \n   \n     \n       AMD \n       -30.12% \n     \n     \n       DELL \n       -26.58% \n     \n     \n       CERN \n       -25.51% \n     \n     \n       MMM \n       -22.62% \n     \n     \n       GPS \n       -20.09% \n     \n     \n       INTC \n       -18.47% \n     \n     \n       COST \n       -16.44% \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       Top 10 positions of all time \n       max \n     \n   \n   \n     \n       COST \n       90.01% \n     \n     \n       DELL \n       85.73% \n     \n     \n       CERN \n       83.53% \n     \n     \n       MMM \n       82.09% \n     \n     \n       INTC \n       78.59% \n     \n     \n       AMD \n       75.76% \n     \n     \n       GPS \n       62.24% \n     \n       \n    .dataframe thead tr:only-child th {\n        text-align: right;\n    }\n\n    .dataframe thead th {\n        text-align: left;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }  \n   \n     \n       All positions ever held \n       max \n     \n   \n   \n     \n       COST \n       90.01% \n     \n     \n       DELL \n       85.73% \n     \n     \n       CERN \n       83.53% \n     \n     \n       MMM \n       82.09% \n     \n     \n       INTC \n       78.59% \n     \n     \n       AMD \n       75.76% \n     \n     \n       GPS \n       62.24%",
            "title": "Slippage Analysis"
        }
    ]
}